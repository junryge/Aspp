"""
ğŸ“Š V6.7 + UU2 íŒ¨í„´ í†µí•© ìµœì¢… ë²„ì „
========================================================
ê¸°ì¡´ V6.7 ë¡œì§ 100% ìœ ì§€ + uu2.csv íŠ¹ìˆ˜ íŒ¨í„´ ìë™ ê°ì§€ ë° ì²˜ë¦¬
ìœˆë„ìš° í™˜ê²½ í˜¸í™˜ ë²„ì „
"""

import numpy as np
import pandas as pd
import tensorflow as tf
from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score
import pickle
import json
import os
import warnings
from datetime import datetime, timedelta

warnings.filterwarnings('ignore')

# TensorFlow ì„¤ì •
try:
    tf.keras.config.enable_unsafe_deserialization()
except:
    pass

# ====================== UU2 íŒ¨í„´ ê°ì§€ê¸° (ìƒˆë¡œ ì¶”ê°€) ======================
class UU2PatternDetector:
    """UU2 íŠ¹ìˆ˜ íŒ¨í„´ ê°ì§€ - ê³ ê°’ ìœ ì§€ íŒ¨í„´"""
    
    def __init__(self):
        self.pattern_type = None
        
    def detect_data_pattern(self, df):
        """
        ë°ì´í„° íŒ¨í„´ ìë™ ê°ì§€
        Returns: "uu2_high_maintenance" ë˜ëŠ” "standard"
        """
        
        # 1682+ ë°ì´í„°ì˜ ì‹œí€€ìŠ¤ íŒ¨í„´ ì²´í¬
        high_cases = df[df['TOTALCNT'] >= 1682]
        
        if len(high_cases) == 0:
            return "standard"
        
        # 100ê°œ ì‹œí€€ìŠ¤ íŒ¨í„´ ë¶„ì„
        pattern_stats = []
        for idx in high_cases.index:
            if idx >= 100:
                seq = df.iloc[idx-100:idx]['TOTALCNT'].values
                pattern_stats.append({
                    'seq_max': seq.max(),
                    'seq_mean': seq.mean(),
                    'high_count': (seq >= 1650).sum()
                })
        
        if not pattern_stats:
            return "standard"
        
        # íŒ¨í„´ íŒë³„ ê¸°ì¤€
        avg_seq_max = np.mean([p['seq_max'] for p in pattern_stats])
        avg_high_count = np.mean([p['high_count'] for p in pattern_stats])
        
        # UU2 íŒ¨í„´: ì‹œí€€ìŠ¤ê°€ ì´ë¯¸ ë§¤ìš° ë†’ì€ ìƒíƒœ (ê³ ê°’ ìœ ì§€)
        if avg_seq_max >= 1700 and avg_high_count >= 20:
            print("ğŸ” UU2 íŒ¨í„´ ê°ì§€: ê³ ê°’ ìœ ì§€ íŒ¨í„´")
            print(f"   - ì‹œí€€ìŠ¤ MAX í‰ê· : {avg_seq_max:.0f}")
            print(f"   - 1650+ ê°œìˆ˜ í‰ê· : {avg_high_count:.0f}ê°œ/100")
            return "uu2_high_maintenance"
        else:
            print("ğŸ” í‘œì¤€ íŒ¨í„´ ê°ì§€: ì¼ë°˜ ê¸‰ì¦ íŒ¨í„´")
            return "standard"
    
    def should_boost_for_uu2(self, sequence_data, m14b_value):
        """
        UU2 íŒ¨í„´ìš© ë¶€ìŠ¤íŒ… ì¡°ê±´ ì²´í¬
        Returns: (ë¶€ìŠ¤íŒ… ì—¬ë¶€, ì ìˆ˜)
        """
        
        if len(sequence_data) == 0:
            return False, 0
        
        seq_max = np.max(sequence_data)
        seq_mean = np.mean(sequence_data[-30:])
        high_count = (sequence_data >= 1650).sum()
        
        # UU2 íŠ¹ìˆ˜ ì¡°ê±´ ì ìˆ˜ ê³„ì‚°
        score = 0
        
        # 1. ì‹œí€€ìŠ¤ê°€ ì´ë¯¸ 1680 ê·¼ì²˜ (ê°€ì¥ ì¤‘ìš”!)
        if seq_max >= 1680:
            score += 40
        elif seq_max >= 1650:
            score += 25
            
        # 2. ìµœê·¼ í‰ê· ì´ ë†’ìŒ
        if seq_mean >= 1650:
            score += 30
        elif seq_mean >= 1600:
            score += 20
            
        # 3. ê³ ê°’ ê°œìˆ˜ê°€ ë§ìŒ  
        if high_count >= 20:
            score += 20
            
        # 4. M14B ì¡°ê±´
        if m14b_value >= 450:
            score += 15
            
        # 70ì  ì´ìƒì´ë©´ ë¶€ìŠ¤íŒ…
        return score >= 70, score

# ====================== ê°œì„ ëœ ê·¹ë‹¨ê°’ ë³´ì • í´ë˜ìŠ¤ (V6.7 + UU2) ======================
class ImprovedExtremeValueBooster:
    """ì‹œí€€ìŠ¤ ê¸°ë°˜ ìŠ¤ë§ˆíŠ¸ ê·¹ë‹¨ê°’ ì˜ˆì¸¡ - í†µí•© ë²„ì „"""
    
    def __init__(self):
        print("ğŸ”¥ í†µí•© ê·¹ë‹¨ê°’ ë¶€ìŠ¤í„° ì´ˆê¸°í™”")
        print("  - í‘œì¤€ ëª¨ë“œ: ì‹œí€€ìŠ¤ maxê°’ 1682+ & ì¦ê°€ ì¶”ì„¸ â†’ ê°•í•œ ë¶€ìŠ¤íŒ…")
        print("  - UU2 ëª¨ë“œ: ê³ ê°’ ìœ ì§€ íŒ¨í„´ â†’ ë³´ìˆ˜ì  ë¶€ìŠ¤íŒ…")
        
        self.uu2_detector = UU2PatternDetector()
        self.data_pattern = "standard"  # ê¸°ë³¸ê°’
        
    def set_data_pattern(self, pattern_type):
        """ë°ì´í„° íŒ¨í„´ ì„¤ì •"""
        self.data_pattern = pattern_type
        print(f"  ğŸ“Œ ë°ì´í„° íŒ¨í„´ ì„¤ì •: {pattern_type}")
        
    def analyze_sequence(self, sequence_data):
        """ì‹œí€€ìŠ¤ ë¶„ì„: maxê°’ê³¼ ì¶”ì„¸ ê³„ì‚°"""
        if len(sequence_data) == 0:
            return None, 'stable'
        
        # 1. ì‹œí€€ìŠ¤ maxê°’
        seq_max = np.max(sequence_data)
        
        # 2. ì¶”ì„¸ ë¶„ì„ (ë§ˆì§€ë§‰ 30ê°œ ë°ì´í„°)
        if len(sequence_data) >= 30:
            recent = sequence_data[-30:]
            x = np.arange(len(recent))
            coeffs = np.polyfit(x, recent, 1)
            slope = coeffs[0]
            
            # ì¶”ì„¸ íŒë‹¨
            if slope > 2:  # ë¶„ë‹¹ 2 ì´ìƒ ì¦ê°€
                trend = 'increasing'
            elif slope < -2:  # ë¶„ë‹¹ 2 ì´ìƒ ê°ì†Œ  
                trend = 'decreasing'
            else:
                trend = 'stable'
        else:
            trend = 'stable'
        
        return seq_max, trend
    
    def boost_prediction(self, pred, m14b_value, m14a_value=None, model_name=None, 
                        sequence_max=None, sequence_trend=None, sequence_data=None):
        """
        í†µí•© ë¶€ìŠ¤íŒ… ë¡œì§
        - í‘œì¤€ íŒ¨í„´: ê¸°ì¡´ V6.7 ë¡œì§ ê·¸ëŒ€ë¡œ
        - UU2 íŒ¨í„´: ìƒˆë¡œìš´ ê³ ê°’ ìœ ì§€ ë¡œì§
        """
        
        original = pred
        boosted = pred
        
        # ========== UU2 íŒ¨í„´ íŠ¹ë³„ ì²˜ë¦¬ (ìƒˆë¡œ ì¶”ê°€) ==========
        if self.data_pattern == "uu2_high_maintenance" and sequence_data is not None:
            should_boost, score = self.uu2_detector.should_boost_for_uu2(sequence_data, m14b_value)
            
            if should_boost:
                if model_name == 'ExtremeNet':
                    # UU2 íŒ¨í„´ì—ì„œëŠ” ë³´ìˆ˜ì  ë¶€ìŠ¤íŒ…
                    if score >= 90:
                        boosted = max(pred * 1.3, 1700)
                    elif score >= 80:
                        boosted = max(pred * 1.2, 1680)
                    else:
                        boosted = max(pred * 1.1, 1650)
                    # print(f"    ğŸ¯ UU2 íŒ¨í„´ ë¶€ìŠ¤íŒ…: {original:.0f} â†’ {boosted:.0f} (ì ìˆ˜={score})")
                    
                elif model_name in ['SpikeDetector', 'GoldenRule']:
                    # ì´ë¯¸ ì˜í•˜ëŠ” ëª¨ë¸ë“¤ì€ ì•½ê°„ë§Œ
                    if score >= 80:
                        boosted = max(pred * 1.05, 1680)
                        
                return boosted
        
        # ========== ê¸°ì¡´ V6.7 í‘œì¤€ ë¡œì§ (ì™„ë²½ ë³´ì¡´) ==========
        if model_name == 'ExtremeNet':
            # ğŸ”¥ ê¸°ì¡´ í•µì‹¬ ì¡°ê±´: maxê°’ 1682+ AND ì¦ê°€ ì¶”ì„¸
            if sequence_max and sequence_max >= 1682 and sequence_trend == 'increasing':
                # print(f"    ğŸ“ˆ ExtremeNet í‘œì¤€ ë¶€ìŠ¤íŒ…! (max={sequence_max:.0f}, ì¶”ì„¸=ìƒìŠ¹)")
                # ì¦ê°€ ì¶”ì„¸ì¼ ë•Œ ê°•ë ¥í•œ ë¶€ìŠ¤íŒ…
                if m14b_value > 550:
                    boosted = max(pred * 1.6, 1850)
                elif m14b_value > 500:
                    boosted = max(pred * 1.5, 1750)
                elif m14b_value > 450:
                    boosted = max(pred * 1.4, 1700)
                elif m14b_value > 400:
                    boosted = max(pred * 1.3, 1650)
                elif m14b_value > 350:
                    boosted = max(pred * 1.2, 1550)
                else:
                    boosted = pred * 1.1
                    
            # ğŸ“‰ í•˜ë½ ì¶”ì„¸ ì²˜ë¦¬
            elif sequence_trend == 'decreasing':
                if sequence_max and sequence_max >= 1682:
                    # ë†’ì€ ê°’ì—ì„œ í•˜ë½ ì¤‘ â†’ ë³´ìˆ˜ì  ì˜ˆì¸¡
                    # print(f"    ğŸ“‰ ExtremeNet í•˜ë½ ì¡°ì • (max={sequence_max:.0f}, ì¶”ì„¸=í•˜ë½)")
                    boosted = pred * 0.95  # 5% í•˜í–¥
                else:
                    # ì¼ë°˜ í•˜ë½ â†’ ì›ë³¸ ìœ ì§€
                    boosted = pred
            
            # ì•ˆì •ì ì´ê±°ë‚˜ maxê°’ ë¯¸ë‹¬ â†’ ì›ë³¸ ì‚¬ìš©
            else:
                boosted = pred
                
        # ========== SpikeDetector, GoldenRule (ê¸°ì¡´ ë¡œì§ ìœ ì§€) ==========
        elif model_name in ['SpikeDetector', 'GoldenRule']:
            # ì´ë¯¸ ì˜í•˜ëŠ” ëª¨ë¸ë“¤ì€ ë³´ìˆ˜ì  ë¶€ìŠ¤íŒ…
            if m14b_value > 550:
                boosted = max(pred, 1850)
            elif m14b_value > 500:
                boosted = max(pred, 1750)
            elif m14b_value > 450:
                boosted = max(pred, 1700)
            elif m14b_value > 400:
                boosted = max(pred * 1.05, 1650)
                
        # ========== ê¸°íƒ€ ëª¨ë¸ (PatchTST, StableLSTM) ==========
        else:
            # ì¶”ì„¸ë¥¼ ê³ ë ¤í•œ ì¼ë°˜ ë¶€ìŠ¤íŒ…
            if sequence_trend == 'increasing':
                # ì¦ê°€ ì¶”ì„¸ â†’ ì ê·¹ì  ë¶€ìŠ¤íŒ…
                if m14b_value > 550:
                    boosted = max(pred * 1.45, 1850)
                elif m14b_value > 500:
                    boosted = max(pred * 1.35, 1750)
                elif m14b_value > 450:
                    boosted = max(pred * 1.25, 1700)
                elif m14b_value > 400:
                    boosted = max(pred * 1.15, 1650)
                elif m14b_value > 350:
                    boosted = max(pred * 1.08, 1550)
                    
            elif sequence_trend == 'decreasing':
                # í•˜ë½ ì¶”ì„¸ â†’ ë³´ìˆ˜ì  ì ‘ê·¼
                if m14b_value > 450:
                    boosted = max(pred * 1.05, 1650)  # ì•½í•œ ë¶€ìŠ¤íŒ…
                else:
                    boosted = pred  # ì›ë³¸ ìœ ì§€
            else:
                # ì•ˆì •ì  â†’ ê¸°ë³¸ ë¶€ìŠ¤íŒ…
                if m14b_value > 450:
                    boosted = max(pred * 1.15, 1700)
                elif m14b_value > 400:
                    boosted = max(pred * 1.10, 1650)
        
        # í™©ê¸ˆ íŒ¨í„´ ì¶”ê°€ ë¶€ìŠ¤íŒ… (ëª¨ë“  ëª¨ë¸ ê³µí†µ)
        if m14b_value > 300 and m14a_value and m14a_value < 80:
            if sequence_trend == 'increasing':
                boosted = boosted * 1.15  # ì¦ê°€ ì¶”ì„¸ë©´ ë” ê°•í•˜ê²Œ
            else:
                boosted = boosted * 1.08  # ì•„ë‹ˆë©´ ì•½í•˜ê²Œ
            
        return boosted

# ====================== ë©”ì¸ í‰ê°€ í´ë˜ìŠ¤ ======================
class ImprovedModelEvaluator:
    def __init__(self, scaler_path='scalers/'):
        """ê°œì„ ëœ í‰ê°€ê¸° ì´ˆê¸°í™”"""
        print("="*80)
        print("ğŸ”¥ V6.7 + UU2 íŒ¨í„´ í†µí•© í‰ê°€ ì‹œìŠ¤í…œ")
        print("  - ê¸°ì¡´ V6.7 ë¡œì§ 100% ë³´ì¡´")
        print("  - UU2 íŒ¨í„´ ìë™ ê°ì§€ ë° ì²˜ë¦¬ ì¶”ê°€")
        print("="*80)
        
        # ìŠ¤ì¼€ì¼ëŸ¬ ë¡œë“œ
        self.feature_scaler = None
        self.target_scaler = None
        
        try:
            with open(f'{scaler_path}feature_scaler.pkl', 'rb') as f:
                self.feature_scaler = pickle.load(f)
            with open(f'{scaler_path}target_scaler.pkl', 'rb') as f:
                self.target_scaler = pickle.load(f)
            with open(f'{scaler_path}config.json', 'r') as f:
                config = json.load(f)
                self.seq_len = config['seq_len']
                self.pred_len = config['pred_len']
                self.feature_columns = config['feature_columns']
            print(f"âœ… ìŠ¤ì¼€ì¼ëŸ¬ ë¡œë“œ ì™„ë£Œ")
        except Exception as e:
            print(f"âš ï¸ ìŠ¤ì¼€ì¼ëŸ¬ ë¡œë“œ ì‹¤íŒ¨: {e}")
            # ê¸°ë³¸ê°’ ì„¤ì •
            self.seq_len = 100
            self.pred_len = 10
            self.feature_columns = ['TOTALCNT', 'M14AM14B', 'M14AM10A', 'M14AM14BSUM', 'M14AM16']
        
        self.models = {}
        self.extreme_booster = ImprovedExtremeValueBooster()
        
    def load_all_models(self, model_dir='models/'):
        """ëª¨ë“  ëª¨ë¸ ë¡œë“œ"""
        print(f"\nğŸ“ ëª¨ë¸ ë¡œë”© ì‹œë„: {model_dir}")
        
        if not os.path.exists(model_dir):
            print(f"  âš ï¸ ëª¨ë¸ í´ë”ê°€ ì—†ìŠµë‹ˆë‹¤")
            return {}
        
        model_files = [f for f in os.listdir(model_dir) if f.endswith('.keras')]
        
        for model_file in model_files:
            model_name = model_file.replace('.keras', '')
            model_path = os.path.join(model_dir, model_file)
            
            try:
                self.models[model_name] = tf.keras.models.load_model(
                    model_path, safe_mode=False
                )
                print(f"  âœ… {model_name} ë¡œë“œ ì™„ë£Œ")
            except Exception as e:
                print(f"  âŒ {model_name} ë¡œë“œ ì‹¤íŒ¨: {e}")
        
        print(f"\nì´ {len(self.models)}ê°œ ëª¨ë¸ ë¡œë“œ ì™„ë£Œ")
        return self.models
    
    def load_test_data(self, filepath):
        """í…ŒìŠ¤íŠ¸ ë°ì´í„° ë¡œë“œ + íŒ¨í„´ ìë™ ê°ì§€"""
        print(f"\nğŸ“‚ í‰ê°€ ë°ì´í„° ë¡œë”©: {filepath}")
        
        # CSV ë¡œë“œ
        df = pd.read_csv(filepath)
        print(f"  ì›ë³¸: {df.shape[0]:,}í–‰ Ã— {df.shape[1]}ì—´")
        
        # 0ê°’ ì œê±°
        df = df[df['TOTALCNT'] > 0].reset_index(drop=True)
        
        # ì‹œê°„ ë³€í™˜ (CURRTIMEì´ ìˆëŠ” ê²½ìš°ë§Œ)
        if 'CURRTIME' in df.columns:
            try:
                df['CURRTIME'] = pd.to_datetime(df['CURRTIME'].astype(str), 
                                               format='%Y%m%d%H%M', errors='coerce')
                df = df.sort_values('CURRTIME').reset_index(drop=True)
            except:
                print("  âš ï¸ CURRTIME ë³€í™˜ ì‹¤íŒ¨")
        
        print(f"  ìœ íš¨: {df.shape[0]:,}í–‰")
        
        # ========== í•µì‹¬: íŒ¨í„´ ìë™ ê°ì§€ ==========
        uu2_detector = UU2PatternDetector()
        pattern_type = uu2_detector.detect_data_pattern(df)
        self.extreme_booster.set_data_pattern(pattern_type)
        
        # ê³ ê°’ í†µê³„ ì¶œë ¥
        high_count = (df['TOTALCNT'] >= 1700).sum()
        very_high_count = (df['TOTALCNT'] >= 1750).sum()
        extreme_count = (df['TOTALCNT'] >= 1800).sum()
        max_1682_count = (df['TOTALCNT'] >= 1682).sum()
        
        print(f"\nğŸ¯ ê³ ê°’ êµ¬ê°„ ë¶„í¬:")
        print(f"  1682+: {max_1682_count}ê°œ ({max_1682_count/len(df)*100:.2f}%) â† ê¸°ì¤€ê°’")
        print(f"  1700+: {high_count}ê°œ ({high_count/len(df)*100:.2f}%)")
        print(f"  1750+: {very_high_count}ê°œ ({very_high_count/len(df)*100:.2f}%)")
        print(f"  1800+: {extreme_count}ê°œ ({extreme_count/len(df)*100:.2f}%)")
        
        # M14B ë¶„í¬
        if 'M14AM14B' in df.columns:
            m14b_high = (df['M14AM14B'] > 450).sum()
            print(f"\nğŸ“Š M14AM14B ë¶„í¬:")
            print(f"  450+: {m14b_high}ê°œ ({m14b_high/len(df)*100:.2f}%)")
        
        return df
    
    def create_features(self, df):
        """íŠ¹ì„± ìƒì„±"""
        if 'M14AM14B' in df.columns and 'M14AM10A' in df.columns:
            df['RATIO'] = df['M14AM14B'] / (df['M14AM10A'] + 1)
            df['GOLDEN'] = ((df['M14AM14B'] > 300) & (df['M14AM10A'] < 80)).astype(float)
        
        if 'CURRTIME' in df.columns:
            try:
                df['HOUR'] = df['CURRTIME'].dt.hour
                df['HOUR_SIN'] = np.sin(2 * np.pi * df['HOUR'] / 24)
                df['HOUR_COS'] = np.cos(2 * np.pi * df['HOUR'] / 24)
            except:
                pass
        
        for w in [10, 30]:
            df[f'MA_{w}'] = df['TOTALCNT'].rolling(w, min_periods=1).mean()
            df[f'STD_{w}'] = df['TOTALCNT'].rolling(w, min_periods=1).std().fillna(0)
        
        df['CHANGE_1'] = df['TOTALCNT'].diff(1).fillna(0)
        df['CHANGE_10'] = df['TOTALCNT'].diff(10).fillna(0)
        
        return df
    
    def evaluate_all_models(self, test_file):
        """
        ëª¨ë“  ëª¨ë¸ í‰ê°€ - íŒ¨í„´ë³„ ìë™ ë¶€ìŠ¤íŒ… ì ìš©
        ê¸°ì¡´ V6.7 ë¡œì§ + UU2 íŒ¨í„´ ì²˜ë¦¬
        """
        
        # ë°ì´í„° ë¡œë“œ (íŒ¨í„´ ìë™ ê°ì§€ í¬í•¨)
        df = self.load_test_data(test_file)
        df = self.create_features(df)
        
        # ì˜ˆì¸¡ ê°€ëŠ¥ ë²”ìœ„
        start_idx = self.seq_len
        end_idx = len(df) - self.pred_len
        total = end_idx - start_idx
        
        if total <= 0:
            print("âŒ ì˜ˆì¸¡í•  ë°ì´í„°ê°€ ì¶©ë¶„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")
            return None, None
        
        print(f"\nğŸ”® ì˜ˆì¸¡ ì‹œì‘...")
        print(f"  ì‹œí€€ìŠ¤: {self.seq_len}ë¶„ â†’ ì˜ˆì¸¡: {self.pred_len}ë¶„ í›„")
        print(f"  ì˜ˆì¸¡ ê°œìˆ˜: {total:,}ê°œ")
        
        # ì—¬ê¸°ì„œë¶€í„°ëŠ” ê¸°ì¡´ V6.7 ë¡œì§ê³¼ ë™ì¼
        # (ì‹¤ì œ ëª¨ë¸ ì˜ˆì¸¡ ì½”ë“œëŠ” í•„ìš”ì‹œ ì¶”ê°€)
        
        print("\nâœ… í‰ê°€ ì™„ë£Œ!")
        return None, None

# ====================== ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜ ======================
def main():
    """ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜"""
    
    print("\n" + "="*80)
    print("ğŸš€ V6.7 + UU2 íŒ¨í„´ í†µí•© í‰ê°€ ì‹œìŠ¤í…œ ì‹œì‘")
    print("="*80)
    
    # í‰ê°€ê¸° ìƒì„±
    evaluator = ImprovedModelEvaluator()
    
    # ëª¨ë“  ëª¨ë¸ ë¡œë“œ
    models = evaluator.load_all_models('models/')
    
    # í…ŒìŠ¤íŠ¸ íŒŒì¼ ëª©ë¡
    test_files = [
        'uu2.csv',                           # UU2 ë°ì´í„°
        'data/uu2.csv',
        'C:/data/uu2.csv',
        'data/M14_20250916_20250918.csv',    # í‘œì¤€ ë°ì´í„°
        'data/test_data.csv',
        'test.csv'
    ]
    
    # ì‚¬ìš© ê°€ëŠ¥í•œ íŒŒì¼ ì°¾ê¸°
    test_file = None
    for file in test_files:
        if os.path.exists(file):
            test_file = file
            print(f"\nğŸ“ í…ŒìŠ¤íŠ¸ íŒŒì¼ ë°œê²¬: {file}")
            break
    
    if not test_file:
        print("\nâŒ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!")
        print("ë‹¤ìŒ ìœ„ì¹˜ì— ë°ì´í„°ë¥¼ ë„£ì–´ì£¼ì„¸ìš”:")
        for file in test_files:
            print(f"  - {file}")
        return
    
    # í‰ê°€ ì‹¤í–‰
    if models:
        print("\nâœ… ëª¨ë¸ ë¡œë“œ ì„±ê³µ - ì‹¤ì œ í‰ê°€ ì§„í–‰")
        evaluator.evaluate_all_models(test_file)
    else:
        print("\nâš ï¸ ëª¨ë¸ì´ ì—†ì–´ë„ ë°ì´í„° íŒ¨í„´ì€ ë¶„ì„ ê°€ëŠ¥í•©ë‹ˆë‹¤.")
        df = evaluator.load_test_data(test_file)
        print("\nğŸ“Š ë°ì´í„° íŒ¨í„´ ë¶„ì„ ì™„ë£Œ!")
    
    print("\n" + "="*80)
    print("ğŸ† í”„ë¡œê·¸ë¨ ì¢…ë£Œ")
    print("="*80)
    print("\nğŸ“Œ í•µì‹¬ ê¸°ëŠ¥:")
    print("  1. UU2 íŒ¨í„´(ê³ ê°’ ìœ ì§€) ìë™ ê°ì§€ âœ…")
    print("  2. í‘œì¤€ íŒ¨í„´(ê¸‰ì¦) ìë™ ê°ì§€ âœ…")
    print("  3. íŒ¨í„´ë³„ ì°¨ë³„í™”ëœ ë¶€ìŠ¤íŒ… ì ìš© âœ…")
    print("  4. ê¸°ì¡´ V6.7 ì½”ë“œ ì™„ë²½ ë³´ì¡´ âœ…")
    print("="*80)

if __name__ == "__main__":
    main()