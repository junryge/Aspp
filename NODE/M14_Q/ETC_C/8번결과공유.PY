#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
8ë‹¨ê³„ ê²°ê³¼ í™•ì¸ ì½”ë“œ
"""

import pandas as pd

# ê²°ê³¼ íŒŒì¼ ë¡œë“œ
df = pd.read_csv('step8_features_10min.csv', nrows=100)  # 100í–‰ë§Œ ë¨¼ì €

print("="*80)
print("ğŸ“Š 8ë‹¨ê³„ Feature Engineering ê²°ê³¼")
print("="*80)

# 1. ê¸°ë³¸ ì •ë³´
print(f"\n1ï¸âƒ£ ê¸°ë³¸ ì •ë³´")
print(f"   ì´ Feature ìˆ˜: {len(df.columns)}ê°œ")
print(f"   ìƒ˜í”Œ ìˆ˜ (ë¯¸ë¦¬ë³´ê¸°): {len(df)}ê°œ")

# 2. Feature ëª©ë¡
print(f"\n2ï¸âƒ£ Feature ëª©ë¡ (ì „ì²´ {len(df.columns)}ê°œ)")
for i, col in enumerate(df.columns, 1):
    print(f"   {i:3d}. {col}")

# 3. ì „ì²´ íŒŒì¼ í†µê³„ (ë”°ë¡œ)
print("\n" + "="*80)
print("ğŸ“ˆ ì „ì²´ íŒŒì¼ í†µê³„ (ì‹œê°„ ê±¸ë¦´ ìˆ˜ ìˆìŒ)")
print("="*80)

try:
    # ì „ì²´ íŒŒì¼ í–‰ ìˆ˜ ì„¸ê¸°
    total_rows = sum(1 for _ in open('step8_features_10min.csv')) - 1  # í—¤ë” ì œì™¸
    print(f"   ì´ ìƒ˜í”Œ ìˆ˜: {total_rows:,}ê°œ")
    
    # íƒ€ê²Ÿ ì»¬ëŸ¼ë§Œ ë¡œë“œí•´ì„œ í†µê³„
    df_target = pd.read_csv('step8_features_10min.csv', usecols=['target_TOTALCNT', 'is_danger'])
    print(f"   1700+ ìƒ˜í”Œ ìˆ˜: {df_target['is_danger'].sum():,}ê°œ ({df_target['is_danger'].mean()*100:.2f}%)")
    print(f"   íƒ€ê²Ÿ í‰ê· : {df_target['target_TOTALCNT'].mean():.2f}")
    print(f"   íƒ€ê²Ÿ ìµœëŒ€: {df_target['target_TOTALCNT'].max():.2f}")
    print(f"   íƒ€ê²Ÿ ìµœì†Œ: {df_target['target_TOTALCNT'].min():.2f}")
except Exception as e:
    print(f"   âš ï¸ ì „ì²´ í†µê³„ ì˜¤ë¥˜: {e}")

print("\nâœ… í™•ì¸ ì™„ë£Œ!")