#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
================================================================================
ğŸ“‹ 7ë‹¨ê³„: Feature Engineering ê³„íšì„œ
================================================================================
ëª©ì : 12ê°œ í•µì‹¬ ì»¬ëŸ¼ë³„ ë§ì¶¤ Feature ì„¤ê³„
ê¸°ì¤€: ìƒê´€ê³„ìˆ˜, ë°ì´í„° íŠ¹ì„±, ë„ë©”ì¸ ì§€ì‹
================================================================================
"""

# ==============================================================================
# 1. ì»¬ëŸ¼ ë¶„ë¥˜ ë° íŠ¹ì„± ì •ì˜
# ==============================================================================

COLUMN_SPECS = {
    # =========================================================================
    # ê¸°ì¡´ ì»¬ëŸ¼ (6ê°œ)
    # =========================================================================
    
    "M14AM14B": {
        "ìƒê´€ê³„ìˆ˜": 0.845,
        "ë“±ê¸‰": "S",  # S > A > B > C
        "ì˜ë¯¸": "M14A â†’ M14B ë¬¼ë¥˜ëŸ‰ (í•µì‹¬ ë³‘ëª© ì§€í‘œ)",
        "íŠ¹ì„±": "ì—°ì†í˜•, ë³€ë™ì„± ë†’ìŒ, ê¸‰ë“± íŒ¨í„´ ì¤‘ìš”",
        "ì„ê³„ê°’": [450, 500, 520, 540, 560],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "min", "std", "median", "skew"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30", "last60"],
            "ì¶”ì„¸": ["slope", "trend5", "trend10", "trend20", "accel"],
            "ì„ê³„ê°’": ["over_450", "over_500", "over_520", "over_540", "over_560"],
            "ë¡¤ë§": [5, 10, 20, 30, 60],
            "íŠ¹ìˆ˜": ["ê¸‰ë“±ê°ì§€", "í”¼í¬ì¹´ìš´íŠ¸", "ë³€ë™ì„±"]
        }
    },
    
    "M14AM14BSUM": {
        "ìƒê´€ê³„ìˆ˜": 0.862,
        "ë“±ê¸‰": "S",
        "ì˜ë¯¸": "M14A â†” M14B ì–‘ë°©í–¥ í•©ê³„",
        "íŠ¹ì„±": "M14AM14Bì™€ ì—°ë™, ëˆ„ì  íŒ¨í„´",
        "ì„ê³„ê°’": [550, 600, 620, 650, 700],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "min", "std", "median"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30", "last60"],
            "ì¶”ì„¸": ["slope", "trend5", "trend10", "trend20"],
            "ì„ê³„ê°’": ["over_550", "over_600", "over_620", "over_650", "over_700"],
            "ë¡¤ë§": [5, 10, 20, 30, 60],
            "ìƒí˜¸ì‘ìš©": ["ratio_to_M14B", "diff_with_M14B"]
        }
    },
    
    "M10AM14A": {
        "ìƒê´€ê³„ìˆ˜": 0.530,
        "ë“±ê¸‰": "A",
        "ì˜ë¯¸": "M10A â†’ M14A ë¬¼ë¥˜ëŸ‰ (ì™¸ë¶€ ìœ ì…)",
        "íŠ¹ì„±": "ì„ í–‰ ì§€í‘œ ê°€ëŠ¥ì„±",
        "ì„ê³„ê°’": [45, 50, 55, 60, 70],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "min", "std"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30"],
            "ì¶”ì„¸": ["slope", "trend10", "trend20"],
            "ì„ê³„ê°’": ["over_45", "over_50", "over_55", "over_60"],
            "ë¡¤ë§": [10, 20, 30],
            "ìƒí˜¸ì‘ìš©": ["ratio_to_M14B"]
        }
    },
    
    "M14.QUE.OHT.OHTUTIL": {
        "ìƒê´€ê³„ìˆ˜": 0.477,
        "ë“±ê¸‰": "A",
        "ì˜ë¯¸": "OHT ê°€ë™ë¥  (%)",
        "íŠ¹ì„±": "0~100 ë²”ìœ„, í¬í™” ìƒíƒœ ì¤‘ìš”",
        "ì„ê³„ê°’": [70, 80, 85, 90, 95],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "min", "std"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30"],
            "ì¶”ì„¸": ["slope", "trend10"],
            "ì„ê³„ê°’": ["over_80", "over_85", "over_90", "over_95"],
            "ë¡¤ë§": [10, 20, 30],
            "íŠ¹ìˆ˜": ["í¬í™”ì‹œê°„ë¹„ìœ¨", "ê¸‰ë“±ê°ì§€"]
        }
    },
    
    "M14.QUE.ALL.TRANSPORT4MINOVERCNT": {
        "ìƒê´€ê³„ìˆ˜": 0.336,
        "ë“±ê¸‰": "B",
        "ì˜ë¯¸": "4ë¶„ ì´ˆê³¼ ìš´ì†¡ ê±´ìˆ˜",
        "íŠ¹ì„±": "ì§€ì—° ì§€í‘œ, 0ì´ ë§ìŒ",
        "ì„ê³„ê°’": [100, 120, 140, 151, 180],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "sum", "std"],
            "ì‹œì°¨": ["last5", "last10", "last20"],
            "ì¶”ì„¸": ["slope", "trend10"],
            "ì„ê³„ê°’": ["over_100", "over_120", "over_151", "over_180"],
            "ë¡¤ë§": [10, 20, 30],
            "íŠ¹ìˆ˜": ["ì—°ì†ì´ˆê³¼íšŸìˆ˜"]
        }
    },
    
    "queue_gap": {
        "ìƒê´€ê³„ìˆ˜": 0.359,
        "ë“±ê¸‰": "B",
        "ì˜ë¯¸": "ëŒ€ê¸° í ê°­ (ìƒì„± - ì™„ë£Œ)",
        "íŠ¹ì„±": "íŒŒìƒë³€ìˆ˜, ë°±ë¡œê·¸ ì§€í‘œ, ìŒìˆ˜ ê°€ëŠ¥",
        "ì„ê³„ê°’": [150, 200, 250, 300, 350],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "min", "std", "median"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30"],
            "ì¶”ì„¸": ["slope", "trend5", "trend10", "trend20", "accel"],
            "ì„ê³„ê°’": ["over_150", "over_200", "over_250", "over_300", "over_350"],
            "ë¡¤ë§": [5, 10, 20, 30],
            "íŠ¹ìˆ˜": ["ëˆ„ì ì¦ê°€ëŸ‰", "ê¸‰ë“±ê°ì§€", "ì—°ì†ì¦ê°€íšŸìˆ˜"]
        }
    },
    
    # =========================================================================
    # ì‹ ê·œ ì»¬ëŸ¼ (6ê°œ)
    # =========================================================================
    
    "M14.QUE.SENDFAB.VERTICALQUEUECOUNT": {
        "ìƒê´€ê³„ìˆ˜": 0.845,
        "ë“±ê¸‰": "S",
        "ì˜ë¯¸": "ìˆ˜ì§ í ëŒ€ê¸° ìˆ˜ (FAB ê°„ ì´ë™)",
        "íŠ¹ì„±": "ê³ ìƒê´€ ì‹ ê·œ ë°œêµ´, ì ì²´ ì„ í–‰ì§€í‘œ",
        "ì„ê³„ê°’": [150, 200, 230, 250, 280],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "min", "std", "median"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30", "last60"],
            "ì¶”ì„¸": ["slope", "trend5", "trend10", "trend20"],
            "ì„ê³„ê°’": ["over_150", "over_200", "over_230", "over_250", "over_280"],
            "ë¡¤ë§": [5, 10, 20, 30, 60],
            "íŠ¹ìˆ˜": ["ê¸‰ë“±ê°ì§€", "í”¼í¬ì¹´ìš´íŠ¸"]
        }
    },
    
    "M14AM16SUM": {
        "ìƒê´€ê³„ìˆ˜": 0.693,
        "ë“±ê¸‰": "A",
        "ì˜ë¯¸": "M14A â†” M16 ì–‘ë°©í–¥ í•©ê³„",
        "íŠ¹ì„±": "FAB ê°„ ë¬¼ë¥˜ ì´ëŸ‰",
        "ì„ê³„ê°’": [150, 180, 200, 220, 250],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "min", "std"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30"],
            "ì¶”ì„¸": ["slope", "trend10", "trend20"],
            "ì„ê³„ê°’": ["over_150", "over_180", "over_200", "over_220"],
            "ë¡¤ë§": [10, 20, 30],
            "ìƒí˜¸ì‘ìš©": ["ratio_to_M14BSUM"]
        }
    },
    
    "M16M14A": {
        "ìƒê´€ê³„ìˆ˜": 0.665,
        "ë“±ê¸‰": "A",
        "ì˜ë¯¸": "M16 â†’ M14A ë¬¼ë¥˜ëŸ‰ (ì™¸ë¶€ ìœ ì…)",
        "íŠ¹ì„±": "M10AM14Aì™€ ìœ ì‚¬, ìœ ì… ì„ í–‰ì§€í‘œ",
        "ì„ê³„ê°’": [80, 100, 110, 120, 140],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "min", "std"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30"],
            "ì¶”ì„¸": ["slope", "trend10", "trend20"],
            "ì„ê³„ê°’": ["over_80", "over_100", "over_110", "over_120"],
            "ë¡¤ë§": [10, 20, 30],
            "ìƒí˜¸ì‘ìš©": ["ratio_to_M10A", "sum_with_M10A"]
        }
    },
    
    "M14.QUE.CNV.SOUTHCURRENTQCNT": {
        "ìƒê´€ê³„ìˆ˜": 0.601,
        "ë“±ê¸‰": "A",
        "ì˜ë¯¸": "ë‚¨ìª½ ì»¨ë² ì´ì–´ í˜„ì¬ í",
        "íŠ¹ì„±": "ë°©í–¥ë³„ ì ì²´, NORTHì™€ ìŒ",
        "ì„ê³„ê°’": [30, 40, 50, 55, 60],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "min", "std"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30"],
            "ì¶”ì„¸": ["slope", "trend10"],
            "ì„ê³„ê°’": ["over_40", "over_50", "over_55"],
            "ë¡¤ë§": [10, 20, 30],
            "ìƒí˜¸ì‘ìš©": ["ratio_to_NORTH", "sum_with_NORTH", "diff_with_NORTH"]
        }
    },
    
    "M14.QUE.CNV.NORTHCURRENTQCNT": {
        "ìƒê´€ê³„ìˆ˜": 0.553,
        "ë“±ê¸‰": "A",
        "ì˜ë¯¸": "ë¶ìª½ ì»¨ë² ì´ì–´ í˜„ì¬ í",
        "íŠ¹ì„±": "ë°©í–¥ë³„ ì ì²´, SOUTHì™€ ìŒ",
        "ì„ê³„ê°’": [35, 45, 50, 55, 60],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "min", "std"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30"],
            "ì¶”ì„¸": ["slope", "trend10"],
            "ì„ê³„ê°’": ["over_45", "over_50", "over_55"],
            "ë¡¤ë§": [10, 20, 30],
            "ìƒí˜¸ì‘ìš©": ["ratio_to_SOUTH", "sum_with_SOUTH"]
        }
    },
    
    "M14.QUE.OHT.CURRENTOHTQCNT": {
        "ìƒê´€ê³„ìˆ˜": 0.486,
        "ë“±ê¸‰": "A",
        "ì˜ë¯¸": "í˜„ì¬ OHT í ëŒ€ê¸° ìˆ˜",
        "íŠ¹ì„±": "OHTUTILê³¼ ì—°ë™, ì ˆëŒ€ ëŒ€ê¸°ëŸ‰",
        "ì„ê³„ê°’": [700, 800, 900, 950, 1000],
        "feature_plan": {
            "í†µê³„": ["mean", "max", "min", "std"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30"],
            "ì¶”ì„¸": ["slope", "trend10", "trend20"],
            "ì„ê³„ê°’": ["over_800", "over_900", "over_950"],
            "ë¡¤ë§": [10, 20, 30],
            "ìƒí˜¸ì‘ìš©": ["ratio_to_OHTUTIL", "per_util_efficiency"]
        }
    }
}


# ==============================================================================
# 2. ìƒí˜¸ì‘ìš© Feature ê³„íš
# ==============================================================================

INTERACTION_FEATURES = {
    # =========================================================================
    # í™©ê¸ˆ íŒ¨í„´ (V8.3 ê¸°ì¡´)
    # =========================================================================
    "gold_strict": {
        "ì¡°ê±´": "M14AM14B > 540 AND M14AM14BSUM > 620",
        "ì˜ë¯¸": "ê°•í•œ ë³‘ëª© ì‹ í˜¸"
    },
    "gold_normal": {
        "ì¡°ê±´": "M14AM14B > 520 AND M14AM14BSUM > 600",
        "ì˜ë¯¸": "ì¼ë°˜ ë³‘ëª© ì‹ í˜¸"
    },
    "triple_check": {
        "ì¡°ê±´": "M14AM14B > 520 AND M14AM14BSUM > 600 AND queue_gap > 250",
        "ì˜ë¯¸": "3ì¤‘ ìœ„í—˜ ì‹ í˜¸"
    },
    "quad_check": {
        "ì¡°ê±´": "triple_check AND TRANSPORT > 145",
        "ì˜ë¯¸": "4ì¤‘ ìœ„í—˜ ì‹ í˜¸"
    },
    
    # =========================================================================
    # ì‹ ê·œ ìƒí˜¸ì‘ìš©
    # =========================================================================
    "vertical_gold": {
        "ì¡°ê±´": "VERTICALQUEUECOUNT > 230 AND M14AM14B > 500",
        "ì˜ë¯¸": "ìˆ˜ì§í + ë³‘ëª© ë™ì‹œ ì‹ í˜¸"
    },
    "cnv_imbalance": {
        "ì¡°ê±´": "abs(SOUTH - NORTH) > 20",
        "ì˜ë¯¸": "ë‚¨ë¶ ì»¨ë² ì´ì–´ ë¶ˆê· í˜•"
    },
    "cnv_total_high": {
        "ì¡°ê±´": "SOUTH + NORTH > 100",
        "ì˜ë¯¸": "ì»¨ë² ì´ì–´ ì´ ì ì²´"
    },
    "oht_overload": {
        "ì¡°ê±´": "OHTUTIL > 90 AND CURRENTOHTQCNT > 900",
        "ì˜ë¯¸": "OHT ê³¼ë¶€í•˜ ìƒíƒœ"
    },
    "m16_surge": {
        "ì¡°ê±´": "M16M14A > 110 AND M14AM16SUM > 200",
        "ì˜ë¯¸": "M16 ë¬¼ë¥˜ ê¸‰ì¦"
    },
    "inflow_surge": {
        "ì¡°ê±´": "M10AM14A > 55 AND M16M14A > 100",
        "ì˜ë¯¸": "ë‹¤ì¤‘ ìœ ì… ê¸‰ì¦"
    },
    "queue_accel_danger": {
        "ì¡°ê±´": "queue_gap > 200 AND queue_gap_trend10 > 30",
        "ì˜ë¯¸": "í ê¸‰ì¦ ê°€ì†"
    },
    
    # =========================================================================
    # ê³±ì…ˆ/ë¹„ìœ¨ ìƒí˜¸ì‘ìš©
    # =========================================================================
    "m14b_x_sum": "M14AM14B Ã— M14AM14BSUM / 1000",
    "m14b_x_vertical": "M14AM14B Ã— VERTICALQUEUECOUNT / 1000",
    "gap_x_m14b": "queue_gap Ã— M14AM14B / 1000",
    "gap_x_oht": "queue_gap Ã— CURRENTOHTQCNT / 10000",
    "cnv_ratio": "SOUTH / (NORTH + 1)",
    "cnv_total": "SOUTH + NORTH",
    "inflow_total": "M10AM14A + M16M14A",
    "inflow_ratio": "M16M14A / (M10AM14A + 1)",
    "oht_efficiency": "CURRENTOHTQCNT / (OHTUTIL + 1)",
    "m14_m16_ratio": "M14AM14BSUM / (M14AM16SUM + 1)",
}


# ==============================================================================
# 3. Feature ìˆ˜ ì˜ˆìƒ
# ==============================================================================

FEATURE_COUNT_ESTIMATE = """
================================================================================
ğŸ“Š Feature ìˆ˜ ì˜ˆìƒ
================================================================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì»¬ëŸ¼               â”‚ ë“±ê¸‰ â”‚ ê¸°ë³¸ â”‚ ì‹œì°¨ â”‚ ì¶”ì„¸ â”‚ ì„ê³„ê°’ â”‚ ë¡¤ë§ â”‚ íŠ¹ìˆ˜ â”‚ í•©ê³„ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ M14AM14B           â”‚  S   â”‚  6   â”‚  5   â”‚  5   â”‚   5   â”‚  5   â”‚  3   â”‚  29  â”‚
â”‚ M14AM14BSUM        â”‚  S   â”‚  5   â”‚  5   â”‚  4   â”‚   5   â”‚  5   â”‚  2   â”‚  26  â”‚
â”‚ VERTICALQUEUECOUNT â”‚  S   â”‚  5   â”‚  5   â”‚  4   â”‚   5   â”‚  5   â”‚  2   â”‚  26  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ M10AM14A           â”‚  A   â”‚  4   â”‚  4   â”‚  3   â”‚   4   â”‚  3   â”‚  1   â”‚  19  â”‚
â”‚ M14AM16SUM         â”‚  A   â”‚  4   â”‚  4   â”‚  3   â”‚   4   â”‚  3   â”‚  1   â”‚  19  â”‚
â”‚ M16M14A            â”‚  A   â”‚  4   â”‚  4   â”‚  3   â”‚   4   â”‚  3   â”‚  2   â”‚  20  â”‚
â”‚ CNV.SOUTH          â”‚  A   â”‚  4   â”‚  4   â”‚  2   â”‚   3   â”‚  3   â”‚  3   â”‚  19  â”‚
â”‚ CNV.NORTH          â”‚  A   â”‚  4   â”‚  4   â”‚  2   â”‚   3   â”‚  3   â”‚  2   â”‚  18  â”‚
â”‚ OHTUTIL            â”‚  A   â”‚  4   â”‚  4   â”‚  2   â”‚   4   â”‚  3   â”‚  2   â”‚  19  â”‚
â”‚ CURRENTOHTQCNT     â”‚  A   â”‚  4   â”‚  4   â”‚  3   â”‚   3   â”‚  3   â”‚  2   â”‚  19  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TRANSPORT4MIN      â”‚  B   â”‚  4   â”‚  3   â”‚  2   â”‚   4   â”‚  3   â”‚  1   â”‚  17  â”‚
â”‚ queue_gap          â”‚  B   â”‚  5   â”‚  4   â”‚  5   â”‚   5   â”‚  4   â”‚  3   â”‚  26  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì»¬ëŸ¼ë³„ Feature ì†Œê³„                                                    â”‚ 257 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ìƒí˜¸ì‘ìš© Feature (íŒ¨í„´ + ê³±ì…ˆ/ë¹„ìœ¨)                                    â”‚  25 â”‚
â”‚ TOTALCNT ìì²´ Feature (mean, slope, trend ë“±)                         â”‚  15 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ¯ ì´ ì˜ˆìƒ Feature ìˆ˜                                                 â”‚ 297 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â€» 9~10ë‹¨ê³„ì—ì„œ Selection í†µí•´ 80~120ê°œë¡œ ì¶•ì†Œ ì˜ˆì •
"""


# ==============================================================================
# 4. ì‹œí€€ìŠ¤ ì„¤ì •
# ==============================================================================

SEQUENCE_CONFIG = {
    "ì‹œí€€ìŠ¤_ê¸¸ì´": 280,  # ë¶„ (V8.3 ìœ ì§€)
    "ì˜ˆì¸¡_ì˜¤í”„ì…‹": [10, 15, 25],  # ë¶„ í›„ ì˜ˆì¸¡
    "ë¡¤ë§_ìœˆë„ìš°": [5, 10, 20, 30, 60],
    "ë¼ê·¸_ìœˆë„ìš°": [5, 10, 20, 30, 60],
}


# ==============================================================================
# 5. ë“±ê¸‰ë³„ Feature í…œí”Œë¦¿
# ==============================================================================

def get_feature_template(grade):
    """ë“±ê¸‰ë³„ Feature ìƒì„± í…œí”Œë¦¿"""
    
    if grade == "S":
        return {
            "í†µê³„": ["mean", "max", "min", "std", "median", "skew"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30", "last60"],
            "ì¶”ì„¸": ["slope", "trend5", "trend10", "trend20", "accel"],
            "ë¡¤ë§": [5, 10, 20, 30, 60],
            "ì„ê³„ê°’": 5,  # 5ë‹¨ê³„
            "íŠ¹ìˆ˜": ["ê¸‰ë“±ê°ì§€", "í”¼í¬ì¹´ìš´íŠ¸", "ë³€ë™ì„±"]
        }
    
    elif grade == "A":
        return {
            "í†µê³„": ["mean", "max", "min", "std"],
            "ì‹œì°¨": ["last5", "last10", "last20", "last30"],
            "ì¶”ì„¸": ["slope", "trend10", "trend20"],
            "ë¡¤ë§": [10, 20, 30],
            "ì„ê³„ê°’": 4,  # 4ë‹¨ê³„
            "íŠ¹ìˆ˜": ["ê¸‰ë“±ê°ì§€"]
        }
    
    elif grade == "B":
        return {
            "í†µê³„": ["mean", "max", "min", "std"],
            "ì‹œì°¨": ["last5", "last10", "last20"],
            "ì¶”ì„¸": ["slope", "trend10"],
            "ë¡¤ë§": [10, 20, 30],
            "ì„ê³„ê°’": 4,  # 4ë‹¨ê³„
            "íŠ¹ìˆ˜": []
        }
    
    else:  # C
        return {
            "í†µê³„": ["mean", "max"],
            "ì‹œì°¨": ["last10", "last20"],
            "ì¶”ì„¸": ["slope"],
            "ë¡¤ë§": [10, 20],
            "ì„ê³„ê°’": 2,
            "íŠ¹ìˆ˜": []
        }


# ==============================================================================
# 6. ì¶œë ¥
# ==============================================================================

if __name__ == "__main__":
    print("="*80)
    print("ğŸ“‹ 7ë‹¨ê³„: Feature Engineering ê³„íšì„œ")
    print("="*80)
    
    print("\n" + "="*80)
    print("1ï¸âƒ£ ì»¬ëŸ¼ë³„ Feature ê³„íš")
    print("="*80)
    
    for col, spec in COLUMN_SPECS.items():
        print(f"\n{'â”€'*60}")
        print(f"ğŸ“Œ {col}")
        print(f"   ìƒê´€ê³„ìˆ˜: {spec['ìƒê´€ê³„ìˆ˜']} | ë“±ê¸‰: {spec['ë“±ê¸‰']}")
        print(f"   ì˜ë¯¸: {spec['ì˜ë¯¸']}")
        print(f"   íŠ¹ì„±: {spec['íŠ¹ì„±']}")
        print(f"   ì„ê³„ê°’: {spec['ì„ê³„ê°’']}")
        plan = spec['feature_plan']
        print(f"   Feature ê³„íš:")
        for k, v in plan.items():
            print(f"      - {k}: {v}")
    
    print("\n" + "="*80)
    print("2ï¸âƒ£ ìƒí˜¸ì‘ìš© Feature")
    print("="*80)
    for name, detail in INTERACTION_FEATURES.items():
        if isinstance(detail, dict):
            print(f"   {name}: {detail['ì¡°ê±´']} â†’ {detail['ì˜ë¯¸']}")
        else:
            print(f"   {name}: {detail}")
    
    print(FEATURE_COUNT_ESTIMATE)
    
    print("\n" + "="*80)
    print("3ï¸âƒ£ ì‹œí€€ìŠ¤ ì„¤ì •")
    print("="*80)
    for k, v in SEQUENCE_CONFIG.items():
        print(f"   {k}: {v}")
    
    print("\nâœ… 7ë‹¨ê³„ ê³„íšì„œ ì™„ë£Œ!")
    print("   â†’ 8ë‹¨ê³„ì—ì„œ ì´ ê³„íšëŒ€ë¡œ Feature ìƒì„± ì½”ë“œ ì‘ì„±")