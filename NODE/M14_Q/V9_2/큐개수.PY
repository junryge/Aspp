#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ğŸ“Š í˜„ì¬ íê°œìˆ˜ë³„ 10ë¶„ í›„ ì¦ê°ëŸ‰ ë¶„ì„ (ì‹¤ì œê°’, í•œ ì‹œíŠ¸)
"""

import pandas as pd
import numpy as np

# ë°ì´í„° ë¡œë“œ
DATA_PATH = 'your_data.csv'  # â† ì‹¤ì œ íŒŒì¼ ê²½ë¡œ!
df = pd.read_csv(DATA_PATH)

print("="*70)
print("ğŸ“Š í˜„ì¬ íê°œìˆ˜ë³„ 10ë¶„ í›„ ì¦ê°ëŸ‰ ë¶„ì„")
print("="*70)

# 10ë¶„ í›„ ê°’ê³¼ ë³€í™”ëŸ‰ ê³„ì‚°
df['10ë¶„í›„_TOTALCNT'] = df['TOTALCNT'].shift(-10)
df['10ë¶„í›„_ì¦ê°'] = df['10ë¶„í›„_TOTALCNT'] - df['TOTALCNT']

# í˜„ì¬í êµ¬ê°„
df['êµ¬ê°„'] = pd.cut(df['TOTALCNT'], 
                    bins=[0, 1200, 1300, 1400, 1500, 1600, 1700, 1800, np.inf],
                    labels=['<1200', '1200~1299', '1300~1399', '1400~1499', 
                            '1500~1599', '1600~1699', '1700~1799', '>=1800'])

# ê²°ê³¼ ì •ë¦¬ (ì‹¤ì œê°’)
result = df[['CURRTIME', 'TOTALCNT', '10ë¶„í›„_TOTALCNT', '10ë¶„í›„_ì¦ê°', 'êµ¬ê°„']].copy()
result.columns = ['ì‹œê°„', 'í˜„ì¬í', '10ë¶„í›„í', '10ë¶„í›„ì¦ê°', 'êµ¬ê°„']
result = result.dropna()

# ì €ì¥
result.to_csv('queue_10min_change.csv', index=False, encoding='utf-8-sig')
print(f"âœ… ì´ {len(result):,}ê±´")
print(f"ğŸ’¾ queue_10min_change.csv ì €ì¥ ì™„ë£Œ!")

print("\nìƒ˜í”Œ ë°ì´í„°:")
print(result.head(20).to_string(index=False))