<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Smart ATLAS OHT - RailEdge In/Out íŠ¸ë˜í”½ ë¶„ì„</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; background: #f5f5f5; line-height: 1.8; }
        h1 { background: linear-gradient(135deg, #1e3a5f, #2d5a87); color: white; padding: 25px; border-radius: 10px; margin-bottom: 30px; }
        h2 { color: #1e3a5f; border-bottom: 3px solid #667eea; padding-bottom: 10px; margin-top: 50px; font-size: 24px; }
        h3 { color: #2d5a87; margin-top: 30px; font-size: 18px; background: #e3f2fd; padding: 10px 15px; border-radius: 5px; }
        h4 { color: #333; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; margin: 15px 0; background: white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; }
        th { background: #1e3a5f; color: white; }
        tr:nth-child(even) { background: #f9f9f9; }
        tr:hover { background: #e8f4fc; }
        .section { background: white; padding: 25px; border-radius: 10px; margin: 20px 0; box-shadow: 0 3px 10px rgba(0,0,0,0.1); }
        .flow-diagram { background: #1a1a2e; color: #00ff00; padding: 20px; font-family: 'Consolas', monospace; font-size: 13px; white-space: pre; overflow-x: auto; border-radius: 8px; line-height: 1.5; }
        .code-block { background: #2d2d2d; color: #f8f8f2; padding: 20px; font-family: 'Consolas', monospace; font-size: 13px; white-space: pre; overflow-x: auto; border-radius: 8px; line-height: 1.5; }
        .highlight { background: #fff3cd; padding: 15px; border-left: 5px solid #ffc107; margin: 15px 0; border-radius: 0 8px 8px 0; }
        .important { background: #e8f5e9; padding: 15px; border-left: 5px solid #4caf50; margin: 15px 0; border-radius: 0 8px 8px 0; }
        .warning { background: #ffebee; padding: 15px; border-left: 5px solid #f44336; margin: 15px 0; border-radius: 0 8px 8px 0; }
        .info { background: #e3f2fd; padding: 15px; border-left: 5px solid #2196f3; margin: 15px 0; border-radius: 0 8px 8px 0; }
        code { background: #e0e0e0; padding: 2px 8px; border-radius: 4px; font-family: 'Consolas', monospace; }
        .formula { background: #f5f5f5; padding: 20px; border: 2px solid #667eea; border-radius: 8px; text-align: center; font-size: 18px; margin: 20px 0; }
        ul, ol { margin: 10px 0; padding-left: 25px; }
        li { margin: 8px 0; }
        .tag { display: inline-block; padding: 3px 10px; border-radius: 15px; font-size: 12px; margin-right: 5px; }
        .tag-in { background: #e8f5e9; color: #2e7d32; }
        .tag-out { background: #ffebee; color: #c62828; }
        .tag-count { background: #e3f2fd; color: #1565c0; }
        .tag-java { background: #fff3e0; color: #e65100; }
        .toc { background: #fafafa; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
        .toc ul { list-style: none; padding-left: 0; }
        .toc li { padding: 5px 0; }
        .toc a { color: #1e3a5f; text-decoration: none; }
        .toc a:hover { text-decoration: underline; }
        .keyword { color: #ff79c6; }
        .string { color: #f1fa8c; }
        .comment { color: #6272a4; }
        .method { color: #50fa7b; }
        .number { color: #bd93f9; }
        .summary-box { display: flex; gap: 20px; flex-wrap: wrap; margin: 20px 0; }
        .summary-item { flex: 1; min-width: 200px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 10px; text-align: center; }
        .summary-item h4 { margin: 0 0 10px 0; font-size: 14px; opacity: 0.9; }
        .summary-item .value { font-size: 24px; font-weight: bold; }
    </style>
</head>
<body>

<h1>ğŸš— Smart ATLAS OHT - RailEdge In/Out íŠ¸ë˜í”½ ë¶„ì„</h1>

<div class="section">
    <p><strong>ğŸ“„ ë¶„ì„ ëª©ì :</strong> RailEdge ë‹¨ìœ„ë¡œ Vehicleì˜ ì§„ì…(In) ë° ì´íƒˆ(Out) ìˆ˜ëŸ‰ì„ 1ë¶„ ì£¼ê¸°ë¡œ ì§‘ê³„í•˜ì—¬ íŠ¸ë˜í”½ í˜„í™© íŒŒì•…</p>
    <p><strong>ğŸ“… ë¶„ì„ ì¼ì:</strong> 2025.01</p>
    <p><strong>ğŸ¯ í™œìš© ëª©í‘œ:</strong></p>
    <ul>
        <li>RailEdgeë³„ íŠ¸ë˜í”½ ë°€ë„ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§</li>
        <li>ë³‘ëª© êµ¬ê°„ ì‚¬ì „ ê°ì§€ ë° ê²½ë¡œ ìµœì í™”</li>
        <li>ì‹œê°„ëŒ€ë³„ íŠ¸ë˜í”½ íŒ¨í„´ ë¶„ì„</li>
    </ul>
</div>

<div class="toc">
    <h3>ğŸ“‘ ëª©ì°¨</h3>
    <ul>
        <li><a href="#section1">1. ìš”êµ¬ì‚¬í•­ ì •ì˜</a></li>
        <li><a href="#section2">2. í˜„ì¬ ì‹œìŠ¤í…œ ë¶„ì„</a></li>
        <li><a href="#section3">3. In/Out ì¹´ìš´íŠ¸ ì²˜ë¦¬ ë¡œì§ (Java ì†ŒìŠ¤ ë¶„ì„)</a></li>
        <li><a href="#section4">4. ê¸°ì¡´ í…Œì´ë¸” í™œìš© ê°€ëŠ¥ ë°ì´í„°</a></li>
        <li><a href="#section5">5. êµ¬í˜„ ë°©ì•ˆ ì œì•ˆ</a></li>
        <li><a href="#section6">6. ë°ì´í„° íë¦„ë„</a></li>
        <li><a href="#section7">7. ì˜ˆìƒ ì‚°ì¶œë¬¼</a></li>
    </ul>
</div>

<!-- Section 1 -->
<h2 id="section1">1. ìš”êµ¬ì‚¬í•­ ì •ì˜</h2>
<div class="section">
    <h3>1.1 í•µì‹¬ ìš”êµ¬ì‚¬í•­</h3>
    <div class="summary-box">
        <div class="summary-item">
            <h4>ì§‘ê³„ ë‹¨ìœ„</h4>
            <div class="value">RailEdge</div>
        </div>
        <div class="summary-item">
            <h4>ì§‘ê³„ ì£¼ê¸°</h4>
            <div class="value">1ë¶„</div>
        </div>
        <div class="summary-item">
            <h4>ì¸¡ì • í•­ëª©</h4>
            <div class="value">In / Out ìˆ˜ëŸ‰</div>
        </div>
        <div class="summary-item">
            <h4>ë°ì´í„° ì†ŒìŠ¤</h4>
            <div class="value">UDP ë©”ì‹œì§€</div>
        </div>
    </div>

    <h3>1.2 ìƒì„¸ ìš”êµ¬ì‚¬í•­</h3>
    <table>
        <tr>
            <th style="width:15%">í•­ëª©</th>
            <th style="width:25%">ì •ì˜</th>
            <th>ì„¤ëª…</th>
        </tr>
        <tr>
            <td><span class="tag tag-in">IN</span></td>
            <td>RailEdge ì§„ì… ìˆ˜ëŸ‰</td>
            <td>í•´ë‹¹ RailEdgeë¡œ ìƒˆë¡œ ì§„ì…í•œ Vehicle ìˆ˜</td>
        </tr>
        <tr>
            <td><span class="tag tag-out">OUT</span></td>
            <td>RailEdge ì´íƒˆ ìˆ˜ëŸ‰</td>
            <td>í•´ë‹¹ RailEdgeì—ì„œ ë¹ ì ¸ë‚˜ê°„ Vehicle ìˆ˜</td>
        </tr>
        <tr>
            <td><span class="tag tag-count">PASS</span></td>
            <td>í†µê³¼ ìˆ˜ëŸ‰</td>
            <td>í•´ë‹¹ RailEdgeë¥¼ ì™„ì „íˆ í†µê³¼í•œ Vehicle ìˆ˜ (= OUTê³¼ ë™ì¼ ê°œë…)</td>
        </tr>
        <tr>
            <td>ì§‘ê³„ ì£¼ê¸°</td>
            <td>1ë¶„ (60ì´ˆ)</td>
            <td>TrafficBatchì™€ ë™ì¼í•œ ì£¼ê¸°ë¡œ ì§‘ê³„</td>
        </tr>
        <tr>
            <td>ì§‘ê³„ ë²”ìœ„</td>
            <td>ì „ì²´ RailEdge</td>
            <td>FAB/MCPë³„ ëª¨ë“  RailEdge ëŒ€ìƒ</td>
        </tr>
    </table>
</div>

<!-- Section 2 -->
<h2 id="section2">2. í˜„ì¬ ì‹œìŠ¤í…œ ë¶„ì„</h2>
<div class="section">
    <h3>2.1 í˜„ì¬ ì‹œìŠ¤í…œì—ì„œ In/Out ì²˜ë¦¬ í˜„í™©</h3>
    
    <div class="important">
        <strong>âœ… ì¢‹ì€ ì†Œì‹:</strong> í˜„ì¬ ì‹œìŠ¤í…œì— ì´ë¯¸ In/Out ì¹´ìš´íŠ¸ ë¡œì§ì´ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤!
    </div>

    <table>
        <tr>
            <th>êµ¬ë¶„</th>
            <th>í´ë˜ìŠ¤/ë©”ì„œë“œ</th>
            <th>í˜„ì¬ ìƒíƒœ</th>
            <th>ë¹„ê³ </th>
        </tr>
        <tr>
            <td><span class="tag tag-in">IN ì²˜ë¦¬</span></td>
            <td><code>RailEdge.addVhlId()</code></td>
            <td>âœ… êµ¬í˜„ë¨</td>
            <td>Vehicle ì§„ì… ì‹œ vhlIdMapì— ì¶”ê°€</td>
        </tr>
        <tr>
            <td><span class="tag tag-out">OUT ì²˜ë¦¬</span></td>
            <td><code>RailEdge.removeVhlId()</code></td>
            <td>âœ… êµ¬í˜„ë¨</td>
            <td>Vehicle ì´íƒˆ ì‹œ vhlIdMapì—ì„œ ì œê±°</td>
        </tr>
        <tr>
            <td><span class="tag tag-count">í†µê³¼ ì¹´ìš´íŠ¸</span></td>
            <td><code>RailEdge.addHistory()</code></td>
            <td>âœ… êµ¬í˜„ë¨</td>
            <td>hisCnt ì¦ê°€ (ëˆ„ì  í†µê³¼ ìˆ˜)</td>
        </tr>
        <tr>
            <td>1ë¶„ ì§‘ê³„</td>
            <td><code>TrafficBatch._buildBase()</code></td>
            <td>âœ… êµ¬í˜„ë¨</td>
            <td>passCnt í•„ë“œë¡œ 1ë¶„ê°„ í†µê³¼ ìˆ˜ ê³„ì‚°</td>
        </tr>
        <tr>
            <td>í˜„ì¬ Vehicle ìˆ˜</td>
            <td><code>RailEdge.getVhlIdMap().size()</code></td>
            <td>âœ… êµ¬í˜„ë¨</td>
            <td>í˜„ì¬ RailEdgeì— ìœ„ì¹˜í•œ Vehicle ìˆ˜</td>
        </tr>
    </table>

    <h3>2.2 ê´€ë ¨ Java í´ë˜ìŠ¤ êµ¬ì¡°</h3>
    <div class="flow-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        In/Out ì¹´ìš´íŠ¸ ê´€ë ¨ í´ë˜ìŠ¤ êµ¬ì¡°                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   OhtUdpListener.java                                                       â”‚
â”‚        â”‚                                                                    â”‚
â”‚        â”‚ UDP ë©”ì‹œì§€ ìˆ˜ì‹                                                     â”‚
â”‚        â–¼                                                                    â”‚
â”‚   OhtMsgWorkerRunnable.java â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚        â”‚                                                                 â”‚  â”‚
â”‚        â”‚ _updateVehicle()                                               â”‚  â”‚
â”‚        â”‚ _setRailEdgeVelocity()  â—„â”€â”€â”€ í•µì‹¬ In/Out ì²˜ë¦¬ ìœ„ì¹˜             â”‚  â”‚
â”‚        â”‚                                                                 â”‚  â”‚
â”‚        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚  â”‚
â”‚        â–¼                  â–¼                  â–¼                          â”‚  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â”‚
â”‚   â”‚ IN ì²˜ë¦¬ â”‚       â”‚OUT ì²˜ë¦¬ â”‚       â”‚ PASS ì¹´ìš´íŠ¸ â”‚                   â”‚  â”‚
â”‚   â”‚ addVhlIdâ”‚       â”‚removeVhlâ”‚       â”‚ addHistory  â”‚                   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚
â”‚        â”‚                 â”‚                   â”‚                          â”‚  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚  â”‚
â”‚                          â–¼                                              â”‚  â”‚
â”‚                    RailEdge.java                                        â”‚  â”‚
â”‚                    â”œâ”€ vhlIdMap (í˜„ì¬ Vehicle ëª©ë¡)                       â”‚  â”‚
â”‚                    â””â”€ hisCnt (ëˆ„ì  í†µê³¼ ìˆ˜)                              â”‚  â”‚
â”‚                          â”‚                                              â”‚  â”‚
â”‚                          â–¼                                              â”‚  â”‚
â”‚                    TrafficBatch.java (1ë¶„ ì£¼ê¸°)                         â”‚  â”‚
â”‚                    â””â”€ passCnt = hisCnt - lastHisCnt                     â”‚  â”‚
â”‚                          â”‚                                              â”‚  â”‚
â”‚                          â–¼                                              â”‚  â”‚
â”‚                    ATLAS_RAIL_TRAFFIC (Logpresso)                       â”‚  â”‚
â”‚                                                                         â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    </div>
</div>

<!-- Section 3 -->
<h2 id="section3">3. In/Out ì¹´ìš´íŠ¸ ì²˜ë¦¬ ë¡œì§ (Java ì†ŒìŠ¤ ë¶„ì„)</h2>
<div class="section">
    <h3>3.1 í•µì‹¬ ì½”ë“œ: OhtMsgWorkerRunnable.java</h3>
    
    <div class="info">
        <strong>ğŸ“ ìœ„ì¹˜:</strong> <code>OhtMsgWorkerRunnable._setRailEdgeVelocity()</code> ë©”ì„œë“œ (ë¼ì¸ 708-776)
    </div>

    <h4>Case 1: ì—°ì† RailEdge ì´ë™ (ì§ì„  ì£¼í–‰)</h4>
    <div class="code-block"><span class="comment">// OhtMsgWorkerRunnable.java - ë¼ì¸ 715-730</span>
<span class="comment">// ì¡°ê±´: lastRailEdgeì˜ ëì  = í˜„ì¬ railEdgeì˜ ì‹œì‘ì </span>
<span class="keyword">if</span> (lastRailEdge.getToNodeId().<span class="method">equals</span>(railEdge.getFromNodeId())) {
    
    <span class="comment">// âœ… OUT ì²˜ë¦¬: ì´ì „ RailEdgeì—ì„œ ì œê±°</span>
    lastRailEdge.<span class="method">getVhlIdMap</span>().<span class="method">remove</span>(vehicleId);  <span class="comment">// â† OUT</span>
    lastRailEdge.<span class="method">addHistory</span>();                      <span class="comment">// â† í†µê³¼ ì¹´ìš´íŠ¸ ì¦ê°€</span>
    
    <span class="comment">// âœ… IN ì²˜ë¦¬: í˜„ì¬ RailEdgeì— ì¶”ê°€</span>
    railEdge.<span class="method">addVhlId</span>(vehicleId);                    <span class="comment">// â† IN</span>
}</div>

    <h4>Case 2: ë¹„ì—°ì† RailEdge ì´ë™ (ë¶„ê¸°/ìš°íšŒ)</h4>
    <div class="code-block"><span class="comment">// OhtMsgWorkerRunnable.java - ë¼ì¸ 731-765</span>
<span class="comment">// ì¡°ê±´: ì´ì „ RailEdgeì™€ í˜„ì¬ RailEdgeê°€ ì§ì ‘ ì—°ê²°ë˜ì§€ ì•ŠìŒ</span>
<span class="keyword">else if</span> (lastRailEdge != <span class="keyword">null</span> && !railEdge.getId().<span class="method">equals</span>(lastRailEdge.getId())) {
    
    <span class="comment">// âœ… OUT ì²˜ë¦¬: ì´ì „ RailEdgeì—ì„œ ì œê±°</span>
    lastRailEdge.<span class="method">addHistory</span>();
    lastRailEdge.<span class="method">getVhlIdMap</span>().<span class="method">remove</span>(vehicleId);  <span class="comment">// â† OUT</span>
    
    <span class="comment">// âœ… IN ì²˜ë¦¬: í˜„ì¬ RailEdgeì— ì¶”ê°€</span>
    railEdge.<span class="method">addVhlId</span>(vehicleId);                    <span class="comment">// â† IN</span>
    
    <span class="comment">// ê²½ë¡œ ì¶”ì •í•˜ì—¬ ì¤‘ê°„ RailEdgeë“¤ë„ í†µê³¼ ì²˜ë¦¬</span>
    ConcurrentLinkedQueue&lt;RailEdge&gt; predictedEdges;
    predictedEdges = <span class="keyword">new</span> DijkstraVhlRouteFind(vehicle, sourceNode, destinationNode)
                        .<span class="method">getRailEdgeList</span>();
    
    <span class="keyword">for</span> (RailEdge predictedEdge : predictedEdges) {
        predictedEdge.<span class="method">addHistory</span>();               <span class="comment">// â† ì¤‘ê°„ ê²½ë¡œë„ í†µê³¼ ì²˜ë¦¬</span>
    }
}</div>

    <h3>3.2 RailEdge í´ë˜ìŠ¤ì˜ In/Out ê´€ë ¨ ë©”ì„œë“œ</h3>
    <div class="code-block"><span class="comment">// RailEdge.java</span>

<span class="comment">// Vehicle ëª©ë¡ ê´€ë¦¬ (í˜„ì¬ RailEdgeì— ìœ„ì¹˜í•œ Vehicleë“¤)</span>
<span class="keyword">private</span> ConcurrentHashMap&lt;String, Integer&gt; vhlIdMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();

<span class="comment">// ëˆ„ì  í†µê³¼ ìˆ˜</span>
<span class="keyword">transient private long</span> hisCnt = <span class="number">0</span>;

<span class="comment">// âœ… IN ì²˜ë¦¬: Vehicle ì§„ì…</span>
<span class="keyword">public void</span> <span class="method">addVhlId</span>(String vhlId) {
    <span class="keyword">if</span> (vhlIdMap == <span class="keyword">null</span>) {
        <span class="keyword">this</span>.vhlIdMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();
    }
    vhlIdMap.<span class="method">put</span>(vhlId, <span class="number">0</span>);  <span class="comment">// Vehicle ì¶”ê°€</span>
}

<span class="comment">// âœ… OUT ì²˜ë¦¬: Vehicle ì´íƒˆ</span>
<span class="keyword">public void</span> <span class="method">removeVhlId</span>(String vhlId) {
    <span class="keyword">if</span> (<span class="keyword">this</span>.vhlIdMap == <span class="keyword">null</span>) {
        <span class="keyword">this</span>.vhlIdMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();
    }
    <span class="keyword">this</span>.vhlIdMap.<span class="method">remove</span>(vhlId);  <span class="comment">// Vehicle ì œê±°</span>
}

<span class="comment">// âœ… í†µê³¼ ì¹´ìš´íŠ¸ ì¦ê°€</span>
<span class="keyword">public void</span> <span class="method">addHistory</span>() {
    <span class="keyword">this</span>.hisCnt++;  <span class="comment">// ëˆ„ì  í†µê³¼ ìˆ˜ ì¦ê°€</span>
}

<span class="comment">// í˜„ì¬ Vehicle ìˆ˜ ì¡°íšŒ</span>
<span class="keyword">public</span> ConcurrentHashMap&lt;String, Integer&gt; <span class="method">getVhlIdMap</span>() {
    <span class="keyword">return</span> vhlIdMap;  <span class="comment">// .size()ë¡œ í˜„ì¬ ìˆ˜ëŸ‰ í™•ì¸ ê°€ëŠ¥</span>
}

<span class="comment">// ëˆ„ì  í†µê³¼ ìˆ˜ ì¡°íšŒ</span>
<span class="keyword">public long</span> <span class="method">getHisCnt</span>() {
    <span class="keyword">return this</span>.hisCnt;
}</div>

    <h3>3.3 TrafficBatchì—ì„œ 1ë¶„ê°„ í†µê³¼ ìˆ˜ ê³„ì‚°</h3>
    <div class="code-block"><span class="comment">// TrafficBatch.java - _buildBase() ë©”ì„œë“œ</span>

<span class="comment">// ì´ì „ ì§‘ê³„ ì‹œì ì˜ í†µê³¼ ìˆ˜ ì €ì¥</span>
<span class="keyword">private static</span> ConcurrentMap&lt;String, Long&gt; lastHisCntMap = <span class="keyword">new</span> ConcurrentHashMap&lt;&gt;();

<span class="comment">// 1ë¶„ê°„ í†µê³¼ ìˆ˜ ê³„ì‚°</span>
<span class="keyword">if</span> (functionItem.<span class="method">isUseRailTrafficPassCnt</span>()) {
    <span class="keyword">long</span> passedCount = railEdge.<span class="method">getHisCnt</span>();           <span class="comment">// í˜„ì¬ ëˆ„ì  í†µê³¼ ìˆ˜</span>
    <span class="keyword">long</span> lastPassedCount = lastHisCntMap.<span class="method">get</span>(railEdgeId); <span class="comment">// ì´ì „ ëˆ„ì  í†µê³¼ ìˆ˜</span>
    <span class="keyword">long</span> passingCount = passedCount - lastPassedCount;   <span class="comment">// â† 1ë¶„ê°„ í†µê³¼ ìˆ˜!</span>
    
    <span class="keyword">if</span> (passingCount &lt; <span class="number">0</span>) {
        passingCount = <span class="number">0</span>;
        lastHisCntMap.<span class="method">put</span>(railEdgeId, <span class="number">0L</span>);
    }
    
    result.<span class="method">put</span>(<span class="string">"passCnt"</span>, passingCount);  <span class="comment">// Logpressoì— ì €ì¥</span>
}

<span class="comment">// í˜„ì¬ Vehicle ìˆ˜</span>
<span class="keyword">if</span> (functionItem.<span class="method">isUseRailTrafficVhlCnt</span>()) {
    result.<span class="method">put</span>(<span class="string">"vhlCnt"</span>, railEdge.<span class="method">getVhlIdMap</span>().<span class="method">size</span>());  <span class="comment">// í˜„ì¬ ìˆ˜ëŸ‰</span>
}</div>
</div>

<!-- Section 4 -->
<h2 id="section4">4. ê¸°ì¡´ í…Œì´ë¸” í™œìš© ê°€ëŠ¥ ë°ì´í„°</h2>
<div class="section">
    <h3>4.1 ATLAS_RAIL_TRAFFIC í…Œì´ë¸”</h3>
    
    <div class="highlight">
        <strong>ğŸ’¡ í•µì‹¬:</strong> ì´ í…Œì´ë¸”ì— ì´ë¯¸ <code>passCnt</code>, <code>vhlCnt</code> í•„ë“œê°€ ìˆì–´ í™œìš© ê°€ëŠ¥!
    </div>

    <table>
        <tr>
            <th>ì»¬ëŸ¼ëª…</th>
            <th>íƒ€ì…</th>
            <th>ì„¤ëª…</th>
            <th>In/Out í™œìš©</th>
        </tr>
        <tr>
            <td><code>railEdgeId</code></td>
            <td>String</td>
            <td>RailEdge ID</td>
            <td>ì§‘ê³„ ê¸°ì¤€</td>
        </tr>
        <tr>
            <td><code>createTime</code></td>
            <td>Long</td>
            <td>ë°ì´í„° ìƒì„± ì‹œê°„</td>
            <td>ì‹œê°„ëŒ€ë³„ ë¶„ì„</td>
        </tr>
        <tr>
            <td><strong><code>passCnt</code></strong></td>
            <td>Long</td>
            <td><strong>1ë¶„ê°„ í†µê³¼í•œ Vehicle ìˆ˜</strong></td>
            <td><span class="tag tag-out">OUT ìˆ˜ëŸ‰</span> í™œìš© ê°€ëŠ¥</td>
        </tr>
        <tr>
            <td><strong><code>vhlCnt</code></strong></td>
            <td>Integer</td>
            <td><strong>í˜„ì¬ RailEdgeì˜ Vehicle ìˆ˜</strong></td>
            <td>í˜„ì¬ ìƒíƒœ íŒŒì•…</td>
        </tr>
        <tr>
            <td><code>velocity</code></td>
            <td>Double</td>
            <td>í˜„ì¬ ì†ë„ (m/min)</td>
            <td>íŠ¸ë˜í”½ ë°€ë„ ì—°ê³„</td>
        </tr>
        <tr>
            <td><code>fabId</code></td>
            <td>String</td>
            <td>Factory ID</td>
            <td>FABë³„ í•„í„°ë§</td>
        </tr>
        <tr>
            <td><code>mcpName</code></td>
            <td>String</td>
            <td>MCP ì´ë¦„</td>
            <td>MCPë³„ í•„í„°ë§</td>
        </tr>
    </table>

    <h3>4.2 ATLAS_AREA_TRAFFIC í…Œì´ë¸”</h3>
    <table>
        <tr>
            <th>ì»¬ëŸ¼ëª…</th>
            <th>ì„¤ëª…</th>
            <th>In/Out í™œìš©</th>
        </tr>
        <tr>
            <td><code>railTrafficInputCnt</code></td>
            <td>Area ë‚´ DEPOSIT ë˜ëŠ” Assign Command ìˆ˜</td>
            <td><span class="tag tag-in">IN ê´€ë ¨</span></td>
        </tr>
        <tr>
            <td><code>railTrafficOutputCnt</code></td>
            <td>Area ë‚´ ACQUIRE ë˜ëŠ” Assign Command ìˆ˜</td>
            <td><span class="tag tag-out">OUT ê´€ë ¨</span></td>
        </tr>
        <tr>
            <td><code>vhlCnt</code></td>
            <td>í˜„ì¬ Areaì˜ Vehicle ìˆ˜</td>
            <td>Areaë³„ í˜„í™©</td>
        </tr>
    </table>

    <h3>4.3 ATLAS_BRANCH_TRAFFIC í…Œì´ë¸”</h3>
    <table>
        <tr>
            <th>ì»¬ëŸ¼ëª…</th>
            <th>ì„¤ëª…</th>
            <th>In/Out í™œìš©</th>
        </tr>
        <tr>
            <td><code>passCnt</code></td>
            <td>ìµœê·¼ 10ì´ˆê°„ BranchJoinEdge í†µê³¼ ìˆ˜ëŸ‰</td>
            <td><span class="tag tag-count">í†µê³¼ ìˆ˜</span></td>
        </tr>
        <tr>
            <td><code>railTrafficInOutCnt</code></td>
            <td>Input + Output í•©ê³„</td>
            <td><span class="tag tag-in">IN</span> + <span class="tag tag-out">OUT</span></td>
        </tr>
    </table>
</div>

<!-- Section 5 -->
<h2 id="section5">5. êµ¬í˜„ ë°©ì•ˆ ì œì•ˆ</h2>
<div class="section">
    <h3>5.1 ë°©ì•ˆ ë¹„êµ</h3>
    <table>
        <tr>
            <th>ë°©ì•ˆ</th>
            <th>ì„¤ëª…</th>
            <th>ì¥ì </th>
            <th>ë‹¨ì </th>
            <th>ì¶”ì²œë„</th>
        </tr>
        <tr>
            <td><strong>ë°©ì•ˆ A</strong><br>ê¸°ì¡´ í…Œì´ë¸” í™œìš©</td>
            <td>ATLAS_RAIL_TRAFFICì˜ passCnt, vhlCnt í™œìš©</td>
            <td>â€¢ ì¶”ê°€ ê°œë°œ ë¶ˆí•„ìš”<br>â€¢ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥<br>â€¢ ê²€ì¦ëœ ë°ì´í„°</td>
            <td>â€¢ IN ì¹´ìš´íŠ¸ ë³„ë„ ì—†ìŒ<br>â€¢ 1ë¶„ ë‹¨ìœ„ ê³ ì •</td>
            <td>â­â­â­â­â­</td>
        </tr>
        <tr>
            <td><strong>ë°©ì•ˆ B</strong><br>ì‹ ê·œ í•„ë“œ ì¶”ê°€</td>
            <td>RailEdgeì— inCnt, outCnt í•„ë“œ ì¶”ê°€</td>
            <td>â€¢ ì •í™•í•œ In/Out êµ¬ë¶„<br>â€¢ ìœ ì—°í•œ ì§‘ê³„</td>
            <td>â€¢ Java ì½”ë“œ ìˆ˜ì • í•„ìš”<br>â€¢ í…ŒìŠ¤íŠ¸ í•„ìš”</td>
            <td>â­â­â­â­</td>
        </tr>
        <tr>
            <td><strong>ë°©ì•ˆ C</strong><br>ë³„ë„ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ</td>
            <td>Pythonìœ¼ë¡œ ë³„ë„ ì§‘ê³„ ì‹œìŠ¤í…œ êµ¬ì¶•</td>
            <td>â€¢ ê¸°ì¡´ ì‹œìŠ¤í…œ ì˜í–¥ ì—†ìŒ<br>â€¢ ì»¤ìŠ¤í…€ ê°€ëŠ¥</td>
            <td>â€¢ ì‹ ê·œ ê°œë°œ í•„ìš”<br>â€¢ UDP ì§ì ‘ ìˆ˜ì‹  í•„ìš”</td>
            <td>â­â­â­</td>
        </tr>
    </table>

    <h3>5.2 ê¶Œì¥ ë°©ì•ˆ: ë°©ì•ˆ A (ê¸°ì¡´ í…Œì´ë¸” í™œìš©)</h3>
    
    <div class="important">
        <strong>âœ… ê¶Œì¥ ì´ìœ :</strong>
        <ul>
            <li>ì´ë¯¸ <code>passCnt</code>ë¡œ 1ë¶„ê°„ í†µê³¼(OUT) ìˆ˜ëŸ‰ ì§‘ê³„ ì¤‘</li>
            <li><code>vhlCnt</code>ë¡œ í˜„ì¬ ìƒíƒœ íŒŒì•… ê°€ëŠ¥</li>
            <li>IN ìˆ˜ëŸ‰ = í˜„ì¬ vhlCnt - ì´ì „ vhlCnt + passCnt ë¡œ ê³„ì‚° ê°€ëŠ¥</li>
            <li>ì¶”ê°€ ê°œë°œ ì—†ì´ Logpresso ì¿¼ë¦¬ë¡œ ì¦‰ì‹œ í™œìš© ê°€ëŠ¥</li>
        </ul>
    </div>

    <h4>In ìˆ˜ëŸ‰ ê³„ì‚° ê³µì‹</h4>
    <div class="formula">
        <strong>IN = (í˜„ì¬ vhlCnt) - (ì´ì „ vhlCnt) + (passCnt)</strong>
        <br><br>
        <small>
            â€¢ í˜„ì¬ vhlCnt: í˜„ì¬ RailEdgeì— ìˆëŠ” Vehicle ìˆ˜<br>
            â€¢ ì´ì „ vhlCnt: 1ë¶„ ì „ RailEdgeì— ìˆë˜ Vehicle ìˆ˜<br>
            â€¢ passCnt: 1ë¶„ê°„ í†µê³¼(ë‚˜ê°„) Vehicle ìˆ˜
        </small>
    </div>

    <h4>Logpresso ì¿¼ë¦¬ ì˜ˆì‹œ</h4>
    <div class="code-block"><span class="comment">-- 1ë¶„ ë‹¨ìœ„ In/Out ì§‘ê³„ ì¿¼ë¦¬</span>
<span class="keyword">SELECT</span>
    railEdgeId,
    createTime,
    passCnt <span class="keyword">AS</span> outCount,                    <span class="comment">-- OUT ìˆ˜ëŸ‰</span>
    vhlCnt <span class="keyword">AS</span> currentVhlCount,               <span class="comment">-- í˜„ì¬ Vehicle ìˆ˜</span>
    (vhlCnt - LAG(vhlCnt) + passCnt) <span class="keyword">AS</span> inCount  <span class="comment">-- IN ìˆ˜ëŸ‰ (ê³„ì‚°)</span>
<span class="keyword">FROM</span>
    ATLAS_RAIL_TRAFFIC
<span class="keyword">WHERE</span>
    fabId = <span class="string">'M14A'</span>
    <span class="keyword">AND</span> createTime >= <span class="number">1723082383000</span>
<span class="keyword">ORDER BY</span>
    railEdgeId, createTime</div>
</div>

<!-- Section 6 -->
<h2 id="section6">6. ë°ì´í„° íë¦„ë„</h2>
<div class="section">
    <h3>6.1 In/Out ì¹´ìš´íŠ¸ ì „ì²´ íë¦„</h3>
    <div class="flow-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       RailEdge In/Out ì¹´ìš´íŠ¸ ë°ì´í„° íë¦„                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                             â”‚
â”‚   â”‚     MCP      â”‚                                                             â”‚
â”‚   â”‚ (UDP ì†¡ì‹ )   â”‚                                                             â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                             â”‚
â”‚          â”‚ UDP ë©”ì‹œì§€                                                          â”‚
â”‚          â”‚ "2,OHT,V00399,1,1,0000,1,4176,20,4177,4,4,..."                      â”‚
â”‚          â–¼                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚              OhtUdpListener.java                      â”‚                     â”‚
â”‚   â”‚              (í¬íŠ¸ ìˆ˜ì‹ , Queue ì ì¬)                   â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                          â”‚                                                     â”‚
â”‚                          â–¼                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚           OhtMsgWorkerRunnable.java                   â”‚                     â”‚
â”‚   â”‚           _setRailEdgeVelocity() ë©”ì„œë“œ               â”‚                     â”‚
â”‚   â”‚                                                       â”‚                     â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                     â”‚
â”‚   â”‚   â”‚  Vehicle ì´ë™ ê°ì§€                           â”‚    â”‚                     â”‚
â”‚   â”‚   â”‚                                             â”‚    â”‚                     â”‚
â”‚   â”‚   â”‚  ì´ì „ ìœ„ì¹˜: lastRailEdge (ì˜ˆ: RE:01945)     â”‚    â”‚                     â”‚
â”‚   â”‚   â”‚  í˜„ì¬ ìœ„ì¹˜: railEdge (ì˜ˆ: RE:01946)         â”‚    â”‚                     â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                     â”‚
â”‚   â”‚                    â”‚                                  â”‚                     â”‚
â”‚   â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚                     â”‚
â”‚   â”‚          â–¼                   â–¼                       â”‚                     â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚                     â”‚
â”‚   â”‚   â”‚ OUT ì²˜ë¦¬    â”‚     â”‚ IN ì²˜ë¦¬     â”‚               â”‚                     â”‚
â”‚   â”‚   â”‚             â”‚     â”‚             â”‚               â”‚                     â”‚
â”‚   â”‚   â”‚ lastRailEdgeâ”‚     â”‚ railEdge    â”‚               â”‚                     â”‚
â”‚   â”‚   â”‚ .removeVhlIdâ”‚     â”‚ .addVhlId() â”‚               â”‚                     â”‚
â”‚   â”‚   â”‚ .addHistory â”‚     â”‚             â”‚               â”‚                     â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜               â”‚                     â”‚
â”‚   â”‚          â”‚                   â”‚                       â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚              â”‚                   â”‚                                             â”‚
â”‚              â–¼                   â–¼                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚                  RailEdge.java                        â”‚                     â”‚
â”‚   â”‚                                                       â”‚                     â”‚
â”‚   â”‚   vhlIdMap: { "V00399": 0, "V00401": 0, ... }        â”‚ â† í˜„ì¬ Vehicle ëª©ë¡ â”‚
â”‚   â”‚   hisCnt: 1523                                        â”‚ â† ëˆ„ì  í†µê³¼ ìˆ˜      â”‚
â”‚   â”‚                                                       â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                          â”‚                                                     â”‚
â”‚                          â”‚ (1ë¶„ ì£¼ê¸°)                                          â”‚
â”‚                          â–¼                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚               TrafficBatch.java                       â”‚                     â”‚
â”‚   â”‚                                                       â”‚                     â”‚
â”‚   â”‚   passCnt = hisCnt(í˜„ì¬) - hisCnt(1ë¶„ì „)             â”‚ â† 1ë¶„ê°„ í†µê³¼ ìˆ˜     â”‚
â”‚   â”‚   vhlCnt = vhlIdMap.size()                           â”‚ â† í˜„ì¬ Vehicle ìˆ˜   â”‚
â”‚   â”‚                                                       â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                          â”‚                                                     â”‚
â”‚                          â–¼                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   â”‚              ATLAS_RAIL_TRAFFIC                       â”‚                     â”‚
â”‚   â”‚              (Logpresso í…Œì´ë¸”)                       â”‚                     â”‚
â”‚   â”‚                                                       â”‚                     â”‚
â”‚   â”‚   railEdgeId | createTime    | passCnt | vhlCnt      â”‚                     â”‚
â”‚   â”‚   -----------|---------------|---------|--------      â”‚                     â”‚
â”‚   â”‚   RE:01945   | 1723082383001 |    5    |   2         â”‚                     â”‚
â”‚   â”‚   RE:01946   | 1723082383001 |    3    |   1         â”‚                     â”‚
â”‚   â”‚   ...        | ...           |   ...   |  ...        â”‚                     â”‚
â”‚   â”‚                                                       â”‚                     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    </div>

    <h3>6.2 ì‹œê°„ì¶• ê¸°ë°˜ In/Out íë¦„ ì˜ˆì‹œ</h3>
    <div class="flow-diagram">
ì‹œê°„ì¶• ì˜ˆì‹œ: RailEdge "M14A:RE:A:01945-01946"

T=0ë¶„ (ì´ˆê¸°)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RailEdge: 01945-01946                 â”‚
â”‚  â”œâ”€ vhlIdMap: {V001, V002}  (2ëŒ€)     â”‚
â”‚  â””â”€ hisCnt: 100                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T=0~1ë¶„ ì‚¬ì´ ì´ë²¤íŠ¸:
  â€¢ V001 â†’ OUT (ë‹¤ìŒ RailEdgeë¡œ ì´ë™)    â†’ hisCnt: 101, vhlIdMap: {V002}
  â€¢ V003 â†’ IN  (ì´ RailEdgeë¡œ ì§„ì…)      â†’ vhlIdMap: {V002, V003}
  â€¢ V002 â†’ OUT (ë‹¤ìŒ RailEdgeë¡œ ì´ë™)    â†’ hisCnt: 102, vhlIdMap: {V003}
  â€¢ V004 â†’ IN  (ì´ RailEdgeë¡œ ì§„ì…)      â†’ vhlIdMap: {V003, V004}
  â€¢ V005 â†’ IN  (ì´ RailEdgeë¡œ ì§„ì…)      â†’ vhlIdMap: {V003, V004, V005}

T=1ë¶„ (TrafficBatch ì‹¤í–‰)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RailEdge: 01945-01946                 â”‚
â”‚  â”œâ”€ vhlIdMap: {V003, V004, V005} (3ëŒ€)â”‚
â”‚  â”œâ”€ hisCnt: 102                        â”‚
â”‚  â”‚                                     â”‚
â”‚  â”‚  â–¶ ê³„ì‚° ê²°ê³¼:                       â”‚
â”‚  â”‚    passCnt = 102 - 100 = 2 (OUT)   â”‚
â”‚  â”‚    vhlCnt = 3 (í˜„ì¬)               â”‚
â”‚  â”‚    inCount = 3 - 2 + 2 = 3 (IN)    â”‚
â”‚  â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â€» IN ê³„ì‚°: í˜„ì¬vhlCnt(3) - ì´ì „vhlCnt(2) + passCnt(2) = 3
    </div>
</div>

<!-- Section 7 -->
<h2 id="section7">7. ì˜ˆìƒ ì‚°ì¶œë¬¼</h2>
<div class="section">
    <h3>7.1 1ë¶„ ì£¼ê¸° ì§‘ê³„ ë°ì´í„° ì˜ˆì‹œ</h3>
    <table>
        <tr>
            <th>ì‹œê°„</th>
            <th>RailEdge ID</th>
            <th>FAB</th>
            <th style="background:#2e7d32;"><span class="tag tag-in">IN</span></th>
            <th style="background:#c62828;"><span class="tag tag-out">OUT</span></th>
            <th>í˜„ì¬ ìˆ˜ëŸ‰</th>
            <th>ì†ë„(m/min)</th>
        </tr>
        <tr>
            <td>10:00:00</td>
            <td>M14A:RE:A:01945-01946</td>
            <td>M14A</td>
            <td>5</td>
            <td>3</td>
            <td>2</td>
            <td>280.5</td>
        </tr>
        <tr>
            <td>10:00:00</td>
            <td>M14A:RE:A:01946-01947</td>
            <td>M14A</td>
            <td>3</td>
            <td>4</td>
            <td>1</td>
            <td>295.2</td>
        </tr>
        <tr>
            <td>10:00:00</td>
            <td>M14A:RE:A:01947-01948</td>
            <td>M14A</td>
            <td>4</td>
            <td>2</td>
            <td>3</td>
            <td>245.8</td>
        </tr>
        <tr>
            <td>10:01:00</td>
            <td>M14A:RE:A:01945-01946</td>
            <td>M14A</td>
            <td>2</td>
            <td>4</td>
            <td>0</td>
            <td>310.1</td>
        </tr>
        <tr>
            <td>10:01:00</td>
            <td>M14A:RE:A:01946-01947</td>
            <td>M14A</td>
            <td>4</td>
            <td>3</td>
            <td>2</td>
            <td>288.7</td>
        </tr>
    </table>

    <h3>7.2 í™œìš© ì‹œë‚˜ë¦¬ì˜¤</h3>
    <table>
        <tr>
            <th>ì‹œë‚˜ë¦¬ì˜¤</th>
            <th>í™œìš© ë°ì´í„°</th>
            <th>ê¸°ëŒ€ íš¨ê³¼</th>
        </tr>
        <tr>
            <td><strong>ë³‘ëª© êµ¬ê°„ ê°ì§€</strong></td>
            <td>IN > OUT ì§€ì†ë˜ëŠ” RailEdge</td>
            <td>ì •ì²´ ë°œìƒ ì „ ì‚¬ì „ ê²½ê³ </td>
        </tr>
        <tr>
            <td><strong>íŠ¸ë˜í”½ ë°¸ëŸ°ì‹±</strong></td>
            <td>RailEdgeë³„ In/Out ë¹„ìœ¨</td>
            <td>ê²½ë¡œ ë¶„ì‚° ìµœì í™”</td>
        </tr>
        <tr>
            <td><strong>ì‹œê°„ëŒ€ë³„ íŒ¨í„´ ë¶„ì„</strong></td>
            <td>ì‹œê°„ëŒ€ë³„ In/Out ì¶”ì´</td>
            <td>í”¼í¬ ì‹œê°„ ì˜ˆì¸¡ ë° ëŒ€ì‘</td>
        </tr>
        <tr>
            <td><strong>ì´ìƒ ê°ì§€</strong></td>
            <td>í‰ê·  ëŒ€ë¹„ ê¸‰ê²©í•œ ë³€í™”</td>
            <td>ì¥ì•  ì¡°ê¸° ë°œê²¬</td>
        </tr>
    </table>

    <h3>7.3 ë‹¤ìŒ ë‹¨ê³„</h3>
    <div class="info">
        <strong>ğŸ“‹ í–¥í›„ ì§„í–‰ ì‚¬í•­:</strong>
        <ol>
            <li><strong>ë°©ì•ˆ A ì ìš© ì‹œ:</strong> Logpresso ì¿¼ë¦¬ ì‘ì„± ë° ëŒ€ì‹œë³´ë“œ êµ¬ì„±</li>
            <li><strong>ë°©ì•ˆ B ì ìš© ì‹œ:</strong> Java ì½”ë“œ ìˆ˜ì • (inCnt, outCnt í•„ë“œ ì¶”ê°€)</li>
            <li><strong>ë°©ì•ˆ C ì ìš© ì‹œ:</strong> Python ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ê°œë°œ</li>
        </ol>
    </div>
</div>

<div class="section" style="background: linear-gradient(135deg, #1e3a5f, #2d5a87); color: white;">
    <h3 style="color: white; background: transparent;">ğŸ“Œ ê²°ë¡ </h3>
    <p>í˜„ì¬ Smart ATLAS ì‹œìŠ¤í…œì—ëŠ” ì´ë¯¸ <strong>RailEdgeë³„ In/Out ì¹´ìš´íŠ¸ ë¡œì§ì´ êµ¬í˜„</strong>ë˜ì–´ ìˆìœ¼ë©°,
    <code>ATLAS_RAIL_TRAFFIC</code> í…Œì´ë¸”ì˜ <code>passCnt</code>, <code>vhlCnt</code> í•„ë“œë¥¼ í™œìš©í•˜ì—¬
    <strong>ì¶”ê°€ ê°œë°œ ì—†ì´ 1ë¶„ ë‹¨ìœ„ In/Out ì§‘ê³„ê°€ ê°€ëŠ¥</strong>í•©ë‹ˆë‹¤.</p>
    
    <p style="margin-top: 20px;">
        <strong>í•µì‹¬ Java ì½”ë“œ ìœ„ì¹˜:</strong><br>
        â€¢ In/Out ì²˜ë¦¬: <code>OhtMsgWorkerRunnable._setRailEdgeVelocity()</code><br>
        â€¢ 1ë¶„ ì§‘ê³„: <code>TrafficBatch._buildBase()</code><br>
        â€¢ ë°ì´í„° ì €ì¥: <code>RailEdge.java</code> (vhlIdMap, hisCnt)
    </p>
</div>

<footer style="text-align: center; margin-top: 50px; padding: 20px; color: #666;">
    <p>ë¬¸ì„œ ë²„ì „: 1.0 | ì‘ì„±ì¼: 2025.01 | Smart ATLAS OHT ì‹œìŠ¤í…œ</p>
</footer>

</body>
</html>