<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HID IN/OUT ì¹´ìš´íŠ¸ ë° FABID ë¶„ë¦¬ ì €ì¥ ìˆ˜ì • ì•ˆë‚´ì„œ</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --accent-blue: #58a6ff;
            --accent-green: #3fb950;
            --accent-orange: #d29922;
            --accent-purple: #a371f7;
            --accent-red: #f85149;
            --accent-cyan: #39c5cf;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --border-color: #30363d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        header {
            text-align: center;
            margin-bottom: 4rem;
            padding: 3rem;
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border-radius: 16px;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple), var(--accent-cyan));
        }

        header h1 {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        header p {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
            margin: 0.25rem;
        }

        .badge-blue { background: rgba(88, 166, 255, 0.15); color: var(--accent-blue); }
        .badge-green { background: rgba(63, 185, 80, 0.15); color: var(--accent-green); }
        .badge-orange { background: rgba(210, 153, 34, 0.15); color: var(--accent-orange); }

        section {
            margin-bottom: 3rem;
        }

        h2 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--border-color);
            color: var(--accent-blue);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        h2::before {
            content: '';
            width: 4px;
            height: 24px;
            background: var(--accent-blue);
            border-radius: 2px;
        }

        h3 {
            font-size: 1.15rem;
            font-weight: 600;
            margin: 1.5rem 0 1rem;
            color: var(--accent-cyan);
        }

        /* ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ 1 */
        .arch-diagram {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid var(--border-color);
            margin: 2rem 0;
        }

        .arch-title {
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 2rem;
            color: var(--text-primary);
        }

        .table-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
        }

        .table-box {
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .table-box:hover {
            border-color: var(--accent-blue);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(88, 166, 255, 0.1);
        }

        .table-box.master {
            border-left: 4px solid var(--accent-green);
        }

        .table-box.realtime {
            border-left: 4px solid var(--accent-orange);
        }

        .table-name {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--accent-blue);
            margin-bottom: 0.75rem;
        }

        .table-desc {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .table-tag {
            display: inline-block;
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            background: rgba(88, 166, 255, 0.1);
            color: var(--accent-cyan);
            border-radius: 4px;
            margin-top: 0.5rem;
        }

        /* ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ 2 - ë°ì´í„° íë¦„ */
        .flow-diagram {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid var(--border-color);
            margin: 2rem 0;
        }

        .flow-section {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .flow-row {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .flow-box {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 0.75rem 1.25rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            border: 1px solid var(--border-color);
            white-space: nowrap;
        }

        .flow-box.source { border-color: var(--accent-green); color: var(--accent-green); }
        .flow-box.process { border-color: var(--accent-blue); color: var(--accent-blue); }
        .flow-box.buffer { border-color: var(--accent-orange); color: var(--accent-orange); }
        .flow-box.target { border-color: var(--accent-purple); color: var(--accent-purple); }

        .flow-arrow {
            color: var(--text-secondary);
            font-size: 1.5rem;
        }

        .flow-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            background: var(--bg-primary);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .flow-group {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 1rem;
            margin: 1rem 0;
            border: 1px dashed var(--border-color);
        }

        .flow-group-title {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
        }

        .target-tables {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .target-table {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 0.5rem 1rem;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            border: 1px solid var(--accent-purple);
            color: var(--accent-purple);
        }

        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .schema-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
        }

        .schema-table th {
            background: var(--bg-tertiary);
            padding: 0.75rem 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--accent-blue);
            border-bottom: 2px solid var(--border-color);
        }

        .schema-table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .schema-table tr:hover td {
            background: var(--bg-secondary);
        }

        .schema-table code {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-tertiary);
            padding: 0.15rem 0.4rem;
            border-radius: 4px;
            font-size: 0.85rem;
            color: var(--accent-cyan);
        }

        /* ì½”ë“œ ë¸”ë¡ */
        pre {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.5rem;
            overflow-x: auto;
            border: 1px solid var(--border-color);
            margin: 1rem 0;
        }

        pre code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
            color: var(--text-primary);
        }

        .code-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .code-lang {
            background: var(--bg-tertiary);
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
        }

        /* ìš”ì•½ ì¹´ë“œ */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .summary-card {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 1.25rem;
            border: 1px solid var(--border-color);
        }

        .summary-card h4 {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            color: var(--accent-blue);
            margin-bottom: 0.75rem;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            padding: 0.35rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .summary-label {
            color: var(--text-secondary);
        }

        .summary-value {
            color: var(--text-primary);
            font-weight: 500;
        }

        /* ìˆ˜ì • ì‚¬í•­ í•˜ì´ë¼ì´íŠ¸ */
        .highlight-box {
            background: linear-gradient(135deg, rgba(88, 166, 255, 0.1) 0%, rgba(163, 113, 247, 0.1) 100%);
            border-radius: 12px;
            padding: 1.5rem;
            border-left: 4px solid var(--accent-blue);
            margin: 1.5rem 0;
        }

        .highlight-box h4 {
            color: var(--accent-blue);
            margin-bottom: 0.75rem;
        }

        .highlight-list {
            list-style: none;
        }

        .highlight-list li {
            padding: 0.35rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
        }

        .highlight-list li::before {
            content: 'â†’';
            position: absolute;
            left: 0;
            color: var(--accent-cyan);
        }

        /* Syntax Highlighting */
        .keyword { color: #ff7b72; }
        .string { color: #a5d6ff; }
        .comment { color: #8b949e; }
        .function { color: #d2a8ff; }
        .type { color: #79c0ff; }
        .number { color: #ffa657; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>HID IN/OUT ì¹´ìš´íŠ¸ ë° FABID ë¶„ë¦¬ ì €ì¥</h1>
            <p>OhtMsgWorkerRunnable ìˆ˜ì • ì•ˆë‚´ì„œ</p>
            <div style="margin-top: 1rem;">
                <span class="badge badge-blue">Logpresso</span>
                <span class="badge badge-green">ATLAS AMHS</span>
                <span class="badge badge-orange">1ë¶„ ë°°ì¹˜</span>
            </div>
        </header>

        <!-- ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ 1: í…Œì´ë¸” êµ¬ì¡° -->
        <section id="architecture">
            <h2>í…Œì´ë¸” ì•„í‚¤í…ì²˜</h2>
            
            <div class="arch-diagram">
                <div class="arch-title">Logpresso í…Œì´ë¸” êµ¬ì¡°</div>
                <div class="table-grid">
                    <div class="table-box master">
                        <div class="table-name">ATLAS_INFO_HID_INOUT</div>
                        <div class="table-desc">â€¢ HID Zone ë§ˆìŠ¤í„° ì •ë³´</div>
                        <div class="table-desc">â€¢ CSV ê¸°ë°˜</div>
                        <div class="table-desc">â€¢ í•˜ë£¨ 1íšŒ ì—…ë°ì´íŠ¸</div>
                        <div class="table-tag">ê¸°ì´ˆì •ë³´ / ë§ˆìŠ¤í„°</div>
                    </div>
                    <div class="table-box realtime">
                        <div class="table-name">ATLAS_M14_HID_INOUT</div>
                        <div class="table-desc">â€¢ HID IN/OUT ì´ë²¤íŠ¸ ë¡œê·¸</div>
                        <div class="table-desc">â€¢ 1ë¶„ ë‹¨ìœ„ ë°°ì¹˜ ì €ì¥</div>
                        <div class="table-desc">â€¢ ë‚ ì§œë³„ ë°ì´í„° ëˆ„ì </div>
                        <div class="table-tag">M14 ì‹¤ì‹œê°„ ë°ì´í„°</div>
                    </div>
                    <div class="table-box realtime">
                        <div class="table-name">ATLAS_M16_HID_INOUT</div>
                        <div class="table-desc">â€¢ HID IN/OUT ì´ë²¤íŠ¸ ë¡œê·¸</div>
                        <div class="table-desc">â€¢ 1ë¶„ ë‹¨ìœ„ ë°°ì¹˜ ì €ì¥</div>
                        <div class="table-desc">â€¢ ë‚ ì§œë³„ ë°ì´í„° ëˆ„ì </div>
                        <div class="table-tag">M16 ì‹¤ì‹œê°„ ë°ì´í„°</div>
                    </div>
                    <div class="table-box realtime">
                        <div class="table-name">ATLAS_M17_HID_INOUT</div>
                        <div class="table-desc">â€¢ HID IN/OUT ì´ë²¤íŠ¸ ë¡œê·¸</div>
                        <div class="table-desc">â€¢ 1ë¶„ ë‹¨ìœ„ ë°°ì¹˜ ì €ì¥</div>
                        <div class="table-desc">â€¢ ë‚ ì§œë³„ ë°ì´í„° ëˆ„ì </div>
                        <div class="table-tag">M17 ì‹¤ì‹œê°„ ë°ì´í„°</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨ 2: ë°ì´í„° íë¦„ -->
        <section id="dataflow">
            <h2>ë°ì´í„° íë¦„ë„</h2>
            
            <div class="flow-diagram">
                <div class="arch-title">ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸</div>
                
                <div class="flow-section">
                    <!-- ë§ˆìŠ¤í„° ë°ì´í„° íë¦„ -->
                    <div class="flow-group">
                        <div class="flow-group-title">ğŸ“ ë§ˆìŠ¤í„° ë°ì´í„° (í•˜ë£¨ 1íšŒ)</div>
                        <div class="flow-row">
                            <div class="flow-box source">HID_Zone_Master.csv</div>
                            <span class="flow-arrow">â†’</span>
                            <span class="flow-label">í•˜ë£¨ 1íšŒ</span>
                            <span class="flow-arrow">â†’</span>
                            <div class="flow-box target">ATLAS_INFO_HID_INOUT</div>
                        </div>
                    </div>

                    <!-- ì‹¤ì‹œê°„ ë°ì´í„° íë¦„ -->
                    <div class="flow-group">
                        <div class="flow-group-title">âš¡ ì‹¤ì‹œê°„ ë°ì´í„° (1ë¶„ ë°°ì¹˜)</div>
                        <div class="flow-row">
                            <div class="flow-box source">OHT ì°¨ëŸ‰ ì´ë™</div>
                            <span class="flow-arrow">â†’</span>
                            <div class="flow-box process">_calculatedVhlCnt()</div>
                        </div>
                        <div class="flow-row" style="margin-left: 2rem; margin-top: 0.5rem;">
                            <span class="flow-arrow">â†“</span>
                        </div>
                        <div class="flow-row" style="margin-left: 2rem;">
                            <div class="flow-box buffer">IN ì´ë²¤íŠ¸ ê°ì§€</div>
                            <span class="flow-arrow">â†’</span>
                            <div class="flow-box buffer">hidEventBuffer.add()</div>
                        </div>
                        <div class="flow-row" style="margin-left: 2rem;">
                            <div class="flow-box buffer">OUT ì´ë²¤íŠ¸ ê°ì§€</div>
                            <span class="flow-arrow">â†’</span>
                            <div class="flow-box buffer">hidEventBuffer.add()</div>
                        </div>
                        <div class="flow-row" style="margin-left: 2rem; margin-top: 0.5rem;">
                            <span class="flow-arrow">â†“</span>
                            <span class="flow-label">1ë¶„ ê²½ê³¼ ì‹œ</span>
                        </div>
                        <div class="flow-row" style="margin-left: 2rem;">
                            <div class="flow-box process">flushHidEventBuffer()</div>
                        </div>
                        <div class="flow-row" style="margin-left: 2rem; margin-top: 0.5rem;">
                            <span class="flow-arrow">â†“</span>
                        </div>
                        <div class="target-tables" style="margin-left: 2rem;">
                            <div class="target-table">ATLAS_M14_HID_INOUT<br><small style="color: var(--text-secondary);">ë‚ ì§œë³„ ëˆ„ì </small></div>
                            <div class="target-table">ATLAS_M16_HID_INOUT<br><small style="color: var(--text-secondary);">ë‚ ì§œë³„ ëˆ„ì </small></div>
                            <div class="target-table">ATLAS_M17_HID_INOUT<br><small style="color: var(--text-secondary);">ë‚ ì§œë³„ ëˆ„ì </small></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- í…Œì´ë¸” 1: ê¸°ì´ˆì •ë³´ -->
        <section id="master-table">
            <h2>í…Œì´ë¸” 1: ATLAS_INFO_HID_INOUT</h2>
            
            <h3>ìš©ë„</h3>
            <p>HID Zone ë§ˆìŠ¤í„° ë°ì´í„° (ê¸°ì¤€ ì •ë³´) â€” <code>HID_Zone_Master.csv</code> ê¸°ë°˜, í•˜ë£¨ 1íšŒ ì—…ë°ì´íŠ¸ (ìƒˆë²½ ë°°ì¹˜)</p>

            <h3>í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ</h3>
            <table class="schema-table">
                <thead>
                    <tr>
                        <th>ì»¬ëŸ¼ëª…</th>
                        <th>íƒ€ì…</th>
                        <th>ì„¤ëª…</th>
                        <th>ì˜ˆì‹œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td><code>HID_ID</code></td><td>INT</td><td>HID Zone ID</td><td>99, 100, 187</td></tr>
                    <tr><td><code>HID_NM</code></td><td>STRING</td><td>HID Zone ì´ë¦„</td><td>HID_099, HID_100</td></tr>
                    <tr><td><code>IN_CNT</code></td><td>INT</td><td>IN Lane ê°œìˆ˜</td><td>2, 3</td></tr>
                    <tr><td><code>OUT_CNT</code></td><td>INT</td><td>OUT Lane ê°œìˆ˜</td><td>2, 3</td></tr>
                    <tr><td><code>VHL_MAX</code></td><td>INT</td><td>ìµœëŒ€ í—ˆìš© ì°¨ëŸ‰ ìˆ˜</td><td>10, 15</td></tr>
                    <tr><td><code>ZCU_ID</code></td><td>STRING</td><td>ZCU ID</td><td>ZCU01</td></tr>
                    <tr><td><code>UPDATE_DT</code></td><td>STRING</td><td>ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì¼ì‹œ</td><td>2026-01-29 00:00:00</td></tr>
                </tbody>
            </table>

            <h3>ë°°ì¹˜ ì €ì¥ ë¡œì§ (Java)</h3>
            <div class="code-header">
                <span class="code-lang">Java</span>
                <span>HidMasterBatchJob.java</span>
            </div>
            <pre><code><span class="comment">// ìŠ¤ì¼€ì¤„: ë§¤ì¼ 00:00 (cron: 0 0 0 * * ?)</span>
<span class="keyword">@Scheduled</span>(cron = <span class="string">"0 0 0 * * ?"</span>)
<span class="keyword">public void</span> <span class="function">updateHidMasterInfo</span>() {
    String csvPath = <span class="string">"/path/to/HID_Zone_Master.csv"</span>;
    List&lt;Tuple&gt; tuples = <span class="keyword">new</span> ArrayList&lt;&gt;();
    
    <span class="keyword">try</span> (BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(csvPath))) {
        String line;
        br.readLine(); <span class="comment">// skip header</span>
        
        <span class="keyword">while</span> ((line = br.readLine()) != <span class="keyword">null</span>) {
            String[] cols = line.split(<span class="string">","</span>);
            Tuple tuple = <span class="keyword">new</span> Tuple();
            
            tuple.put(<span class="string">"HID_ID"</span>, Integer.parseInt(cols[<span class="number">0</span>]));
            tuple.put(<span class="string">"HID_NM"</span>, cols[<span class="number">1</span>]);
            tuple.put(<span class="string">"IN_CNT"</span>, Integer.parseInt(cols[<span class="number">2</span>]));
            tuple.put(<span class="string">"OUT_CNT"</span>, Integer.parseInt(cols[<span class="number">3</span>]));
            tuple.put(<span class="string">"VHL_MAX"</span>, Integer.parseInt(cols[<span class="number">4</span>]));
            tuple.put(<span class="string">"ZCU_ID"</span>, cols[<span class="number">5</span>]);
            tuple.put(<span class="string">"UPDATE_DT"</span>, updateDt);
            
            tuples.add(tuple);
        }
    }
    
    <span class="comment">// Full Refresh</span>
    LogpressoAPI.truncateTable(<span class="string">"ATLAS_INFO_HID_INOUT"</span>);
    LogpressoAPI.setInsertTuples(<span class="string">"ATLAS_INFO_HID_INOUT"</span>, tuples, <span class="number">100</span>);
}</code></pre>
        </section>

        <!-- í…Œì´ë¸” 2: ì‹¤ì‹œê°„ ë°ì´í„° -->
        <section id="realtime-table">
            <h2>í…Œì´ë¸” 2: ATLAS_{FABID}_HID_INOUT</h2>
            
            <h3>ìš©ë„</h3>
            <p>HID IN/OUT ì´ë²¤íŠ¸ ì‹¤ì‹œê°„ ë¡œê·¸ â€” FABIDë³„ í…Œì´ë¸” ë¶„ë¦¬ (M14, M16, M17...), 1ë¶„ ë‹¨ìœ„ ë°°ì¹˜ ì €ì¥, ë‚ ì§œë³„ ë°ì´í„° ëˆ„ì </p>

            <h3>í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ</h3>
            <table class="schema-table">
                <thead>
                    <tr>
                        <th>ì»¬ëŸ¼ëª…</th>
                        <th>íƒ€ì…</th>
                        <th>ì„¤ëª…</th>
                        <th>ì˜ˆì‹œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td><code>EVENT_DATE</code></td><td>STRING</td><td>ì´ë²¤íŠ¸ ë‚ ì§œ (íŒŒí‹°ì…˜ í‚¤)</td><td>2026-01-29</td></tr>
                    <tr><td><code>EVENT_DT</code></td><td>STRING</td><td>ì´ë²¤íŠ¸ ë°œìƒ ì‹œê°„</td><td>2026-01-29 15:30:45</td></tr>
                    <tr><td><code>HID_ID</code></td><td>INT</td><td>HID Zone ID</td><td>99</td></tr>
                    <tr><td><code>VHL_NM</code></td><td>STRING</td><td>ì°¨ëŸ‰ ì´ë¦„</td><td>V00001</td></tr>
                    <tr><td><code>EVENT_TYPE</code></td><td>STRING</td><td>IN/OUT êµ¬ë¶„</td><td>IN, OUT</td></tr>
                    <tr><td><code>MCP_NM</code></td><td>STRING</td><td>MCP ì´ë¦„</td><td>MCP01</td></tr>
                    <tr><td><code>ENV</code></td><td>STRING</td><td>í™˜ê²½ êµ¬ë¶„</td><td>PROD</td></tr>
                </tbody>
            </table>
        </section>

        <!-- ìˆ˜ì • ë°©ì•ˆ -->
        <section id="modification">
            <h2>ìˆ˜ì • ë°©ì•ˆ: 1ë¶„ ë°°ì¹˜ ì €ì¥</h2>

            <h3>Step 1: ì´ë²¤íŠ¸ ë²„í¼ ì¶”ê°€ (í´ë˜ìŠ¤ í•„ë“œ)</h3>
            <div class="code-header">
                <span class="code-lang">Java</span>
                <span>í´ë˜ìŠ¤ ìƒë‹¨ì— ì¶”ê°€</span>
            </div>
            <pre><code><span class="comment">// HID IN/OUT ì´ë²¤íŠ¸ ë²„í¼ (1ë¶„ê°„ ëª¨ì•„ì„œ ë°°ì¹˜ ì €ì¥)</span>
<span class="keyword">private</span> List&lt;HidInOutEvent&gt; hidEventBuffer = 
    Collections.synchronizedList(<span class="keyword">new</span> ArrayList&lt;&gt;());
<span class="keyword">private long</span> lastFlushTime = System.currentTimeMillis();
<span class="keyword">private static final long</span> FLUSH_INTERVAL = <span class="number">60000</span>; <span class="comment">// 1ë¶„</span>

<span class="comment">// ì´ë²¤íŠ¸ ë°ì´í„° í´ë˜ìŠ¤</span>
<span class="keyword">private static class</span> <span class="type">HidInOutEvent</span> {
    String eventDate;      <span class="comment">// yyyy-MM-dd</span>
    String eventDt;        <span class="comment">// yyyy-MM-dd HH:mm:ss</span>
    <span class="keyword">int</span> hidId;
    String vhlNm;
    String eventType;      <span class="comment">// "IN" or "OUT"</span>
    String mcpNm;
}</code></pre>

            <h3>Step 2: _calculatedVhlCnt() ìˆ˜ì •</h3>
            <div class="code-header">
                <span class="code-lang">Java</span>
                <span>ìˆ˜ì • í›„ ì½”ë“œ</span>
            </div>
            <pre><code><span class="keyword">private void</span> <span class="function">_calculatedVhlCnt</span>(<span class="keyword">int</span> currentHidId, String key, Vhl vehicle) {
    <span class="keyword">long</span> timer = System.currentTimeMillis();
    <span class="keyword">int</span> previousHidId = vehicle.getHidId();
    String vehicleName = vehicle.getName();

    <span class="keyword">if</span> (previousHidId != currentHidId) {
        SimpleDateFormat dateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);
        SimpleDateFormat dateOnlyFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);
        String eventDt = dateFormat.format(<span class="keyword">new</span> Date(timer));
        String eventDate = dateOnlyFormat.format(<span class="keyword">new</span> Date(timer));

        <span class="comment">// HID êµ¬ê°„ IN (ìƒˆë¡œìš´ HID êµ¬ê°„ ì§„ì…)</span>
        <span class="keyword">if</span> (currentHidId > <span class="number">0</span>) {
            String v = String.format(<span class="string">"%03d"</span>, currentHidId);
            DataService.getDataSet().increaseHidVehicleCnt(key + <span class="string">":"</span> + v);

            <span class="comment">// ===== ì¶”ê°€: IN ì´ë²¤íŠ¸ ë²„í¼ì— ì €ì¥ =====</span>
            hidEventBuffer.add(<span class="keyword">new</span> HidInOutEvent(
                eventDate, eventDt, currentHidId, vehicleName, <span class="string">"IN"</span>, <span class="keyword">this</span>.mcpName
            ));
        }

        <span class="comment">// HID êµ¬ê°„ OUT (ì´ì „ HID êµ¬ê°„ ì´íƒˆ)</span>
        <span class="keyword">if</span> (previousHidId > <span class="number">0</span>) {
            String v = String.format(<span class="string">"%03d"</span>, previousHidId);
            DataService.getDataSet().decreaseHidVehicleCnt(key + <span class="string">":"</span> + v);

            <span class="comment">// ===== ì¶”ê°€: OUT ì´ë²¤íŠ¸ ë²„í¼ì— ì €ì¥ =====</span>
            hidEventBuffer.add(<span class="keyword">new</span> HidInOutEvent(
                eventDate, eventDt, previousHidId, vehicleName, <span class="string">"OUT"</span>, <span class="keyword">this</span>.mcpName
            ));
        }

        vehicle.setHidId(currentHidId);
    }

    <span class="comment">// ===== ì¶”ê°€: 1ë¶„ë§ˆë‹¤ ë²„í¼ í”ŒëŸ¬ì‹œ =====</span>
    <span class="keyword">if</span> (timer - lastFlushTime >= FLUSH_INTERVAL) {
        flushHidEventBuffer();
        lastFlushTime = timer;
    }
}</code></pre>

            <h3>Step 3: ë°°ì¹˜ ì €ì¥ ë©”ì†Œë“œ ì¶”ê°€</h3>
            <div class="code-header">
                <span class="code-lang">Java</span>
                <span>flushHidEventBuffer()</span>
            </div>
            <pre><code><span class="comment">/**
 * HID IN/OUT ì´ë²¤íŠ¸ ë²„í¼ë¥¼ Logpressoì— ë°°ì¹˜ ì €ì¥
 * FABIDë³„ í…Œì´ë¸” ë¶„ë¦¬: ATLAS_M14_HID_INOUT, ATLAS_M16_HID_INOUT ë“±
 */</span>
<span class="keyword">private void</span> <span class="function">flushHidEventBuffer</span>() {
    <span class="keyword">if</span> (hidEventBuffer.isEmpty()) {
        <span class="keyword">return</span>;
    }

    List&lt;HidInOutEvent&gt; eventsToFlush;
    <span class="keyword">synchronized</span> (hidEventBuffer) {
        eventsToFlush = <span class="keyword">new</span> ArrayList&lt;&gt;(hidEventBuffer);
        hidEventBuffer.clear();
    }

    List&lt;Tuple&gt; tuples = <span class="keyword">new</span> ArrayList&lt;&gt;();
    <span class="keyword">for</span> (HidInOutEvent event : eventsToFlush) {
        Tuple tuple = <span class="keyword">new</span> Tuple();
        tuple.put(<span class="string">"EVENT_DATE"</span>, event.eventDate);
        tuple.put(<span class="string">"EVENT_DT"</span>, event.eventDt);
        tuple.put(<span class="string">"HID_ID"</span>, event.hidId);
        tuple.put(<span class="string">"VHL_NM"</span>, event.vhlNm);
        tuple.put(<span class="string">"EVENT_TYPE"</span>, event.eventType);
        tuple.put(<span class="string">"MCP_NM"</span>, event.mcpNm);
        tuple.put(<span class="string">"ENV"</span>, Env.getEnv());
        tuples.add(tuple);
    }

    <span class="comment">// FABIDë³„ í…Œì´ë¸”ì— ì €ì¥</span>
    String tableName = <span class="string">"ATLAS_"</span> + <span class="keyword">this</span>.fabId + <span class="string">"_HID_INOUT"</span>;
    
    <span class="keyword">boolean</span> success = LogpressoAPI.setInsertTuples(tableName, tuples, <span class="number">100</span>);
    
    <span class="keyword">if</span> (success) {
        logger.info(<span class="string">"HID IN/OUT events flushed to {}: {} records"</span>, 
                    tableName, tuples.size());
    }
}</code></pre>
        </section>

        <!-- Logpresso ì¿¼ë¦¬ -->
        <section id="queries">
            <h2>Logpresso ì¿¼ë¦¬ ì˜ˆì‹œ</h2>

            <h3>ê¸°ì´ˆì •ë³´ ì¡°íšŒ</h3>
            <pre><code><span class="comment">-- HID Zone ë§ˆìŠ¤í„° ì •ë³´ ì „ì²´ ì¡°íšŒ</span>
<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> ATLAS_INFO_HID_INOUT <span class="keyword">ORDER BY</span> HID_ID</code></pre>

            <h3>M14 ì¼ë³„ IN/OUT í†µê³„</h3>
            <pre><code><span class="comment">-- M14 íŠ¹ì • ë‚ ì§œ HIDë³„ IN/OUT ì¹´ìš´íŠ¸</span>
<span class="keyword">SELECT</span> EVENT_DATE, HID_ID, EVENT_TYPE, <span class="function">COUNT</span>(*) <span class="keyword">as</span> CNT
<span class="keyword">FROM</span> ATLAS_M14_HID_INOUT
<span class="keyword">WHERE</span> EVENT_DATE = <span class="string">'2026-01-29'</span>
<span class="keyword">GROUP BY</span> EVENT_DATE, HID_ID, EVENT_TYPE
<span class="keyword">ORDER BY</span> HID_ID, EVENT_TYPE</code></pre>

            <h3>íŠ¹ì • HID êµ¬ê°„ ì°¨ëŸ‰ íë¦„</h3>
            <pre><code><span class="comment">-- M14 HID_ID=99 êµ¬ê°„ ì°¨ëŸ‰ íë¦„ ì¶”ì </span>
<span class="keyword">SELECT</span> EVENT_DT, VHL_NM, EVENT_TYPE
<span class="keyword">FROM</span> ATLAS_M14_HID_INOUT
<span class="keyword">WHERE</span> HID_ID = <span class="number">99</span>
  <span class="keyword">AND</span> EVENT_DATE = <span class="string">'2026-01-29'</span>
<span class="keyword">ORDER BY</span> EVENT_DT <span class="keyword">DESC</span>
<span class="keyword">LIMIT</span> <span class="number">100</span></code></pre>

            <h3>ë§ˆìŠ¤í„° ì •ë³´ì™€ ì‹¤ì‹œê°„ ë°ì´í„° ì¡°ì¸</h3>
            <pre><code><span class="comment">-- IN/OUT ì´ë²¤íŠ¸ ìˆ˜ vs ìµœëŒ€ í—ˆìš© ì°¨ëŸ‰ ë¹„êµ</span>
<span class="keyword">SELECT</span>
    m.HID_ID,
    m.HID_NM,
    m.VHL_MAX,
    <span class="function">COUNT</span>(<span class="keyword">CASE WHEN</span> e.EVENT_TYPE = <span class="string">'IN'</span> <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">END</span>) <span class="keyword">as</span> IN_TOTAL,
    <span class="function">COUNT</span>(<span class="keyword">CASE WHEN</span> e.EVENT_TYPE = <span class="string">'OUT'</span> <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">END</span>) <span class="keyword">as</span> OUT_TOTAL
<span class="keyword">FROM</span> ATLAS_INFO_HID_INOUT m
<span class="keyword">LEFT JOIN</span> ATLAS_M14_HID_INOUT e <span class="keyword">ON</span> m.HID_ID = e.HID_ID
<span class="keyword">WHERE</span> e.EVENT_DATE = <span class="string">'2026-01-29'</span>
<span class="keyword">GROUP BY</span> m.HID_ID, m.HID_NM, m.VHL_MAX
<span class="keyword">ORDER BY</span> m.HID_ID</code></pre>
        </section>

        <!-- ìš”ì•½ -->
        <section id="summary">
            <h2>ìš”ì•½</h2>
            
            <div class="summary-grid">
                <div class="summary-card">
                    <h4>ATLAS_INFO_HID_INOUT</h4>
                    <div class="summary-item">
                        <span class="summary-label">ìš©ë„</span>
                        <span class="summary-value">ê¸°ì´ˆì •ë³´ (ë§ˆìŠ¤í„°)</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">ì—…ë°ì´íŠ¸</span>
                        <span class="summary-value">í•˜ë£¨ 1íšŒ</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">ì†ŒìŠ¤</span>
                        <span class="summary-value">HID_Zone_Master.csv</span>
                    </div>
                </div>
                <div class="summary-card">
                    <h4>ATLAS_M14_HID_INOUT</h4>
                    <div class="summary-item">
                        <span class="summary-label">ìš©ë„</span>
                        <span class="summary-value">M14 IN/OUT ì´ë²¤íŠ¸</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">ì—…ë°ì´íŠ¸</span>
                        <span class="summary-value">1ë¶„ ë°°ì¹˜</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">ì†ŒìŠ¤</span>
                        <span class="summary-value">ì‹¤ì‹œê°„ OHT ì´ë™</span>
                    </div>
                </div>
                <div class="summary-card">
                    <h4>ATLAS_M16_HID_INOUT</h4>
                    <div class="summary-item">
                        <span class="summary-label">ìš©ë„</span>
                        <span class="summary-value">M16 IN/OUT ì´ë²¤íŠ¸</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">ì—…ë°ì´íŠ¸</span>
                        <span class="summary-value">1ë¶„ ë°°ì¹˜</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">ì†ŒìŠ¤</span>
                        <span class="summary-value">ì‹¤ì‹œê°„ OHT ì´ë™</span>
                    </div>
                </div>
                <div class="summary-card">
                    <h4>ATLAS_M17_HID_INOUT</h4>
                    <div class="summary-item">
                        <span class="summary-label">ìš©ë„</span>
                        <span class="summary-value">M17 IN/OUT ì´ë²¤íŠ¸</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">ì—…ë°ì´íŠ¸</span>
                        <span class="summary-value">1ë¶„ ë°°ì¹˜</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">ì†ŒìŠ¤</span>
                        <span class="summary-value">ì‹¤ì‹œê°„ OHT ì´ë™</span>
                    </div>
                </div>
            </div>

            <div class="highlight-box">
                <h4>ğŸ“ ìˆ˜ì • íŒŒì¼: OhtMsgWorkerRunnable.java</h4>
                <ul class="highlight-list">
                    <li><strong>ì¶”ê°€</strong>: <code>HidInOutEvent</code> ë‚´ë¶€ í´ë˜ìŠ¤</li>
                    <li><strong>ì¶”ê°€</strong>: <code>hidEventBuffer</code> í•„ë“œ (ì´ë²¤íŠ¸ ë²„í¼)</li>
                    <li><strong>ì¶”ê°€</strong>: <code>flushHidEventBuffer()</code> ë©”ì†Œë“œ (1ë¶„ ë°°ì¹˜ ì €ì¥)</li>
                    <li><strong>ìˆ˜ì •</strong>: <code>_calculatedVhlCnt()</code> ë©”ì†Œë“œ (IN/OUT ì´ë²¤íŠ¸ ë²„í¼ë§ ì¶”ê°€)</li>
                </ul>
            </div>
        </section>
    </div>
</body>
</html>