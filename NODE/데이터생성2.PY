import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import random
import json
import os

def generate_integrated_mcs_data(num_records=100):
    """
    í†µí•© MCS ë°ì´í„° ìƒì„± - ì´ë²¤íŠ¸ ë¡œê·¸ + ì¥ë¹„ ì„¼ì„œ ë°ì´í„°
    """
    
    # ê¸°ì¤€ ì‹œì‘ ì‹œê°„
    base_time = datetime(2025, 7, 1, 0, 0, 0)
    
    # FAB ë¼ì¸ ë° ë² ì´ ì •ë³´
    fab_lines = ['FAB1', 'FAB2', 'FAB3']
    bays = {
        'PHOTO': 'í¬í† ê³µì •',
        'ETCH': 'ì‹ê°ê³µì •',
        'DIFF': 'í™•ì‚°ê³µì •',
        'IMPLANT': 'ì´ì˜¨ì£¼ì…',
        'CVD': 'CVDê³µì •',
        'PVD': 'PVDê³µì •',
        'CMP': 'CMPê³µì •',
        'CLEAN': 'ì„¸ì •ê³µì •',
        'METROLOGY': 'ê³„ì¸¡ê³µì •',
        'TEST': 'í…ŒìŠ¤íŠ¸ê³µì •'
    }
    
    # ì¥ë¹„ ì •ë³´
    equipment_info = {
        'PHOTO': ['ASML_NXT_1980', 'ASML_NXT_2050', 'ASML_XT_1460'],
        'ETCH': ['LAM_KIYO_01', 'LAM_VERSYS_01', 'TEL_ETCH_01'],
        'CVD': ['AMAT_CENTURA_01', 'AMAT_PRODUCER_01'],
        'PVD': ['AMAT_ENDURA_01', 'AMAT_ENDURA_02'],
        'CMP': ['AMAT_REFLEXION_01', 'EBARA_F_REX_01'],
        'CLEAN': ['TEL_CLEAN_01', 'DNS_CLEAN_01'],
        'DIFF': ['TEL_UNITY_01', 'HITACHI_DD_01'],
        'IMPLANT': ['AMAT_VARIAN_01', 'AXCELIS_PURION_01'],
        'METROLOGY': ['KLA_2935', 'KLA_SP5', 'ASML_YS350'],
        'TEST': ['TEL_PRECIO_01', 'ACCRETECH_UF3000']
    }
    
    # ìºë¦¬ì–´ íƒ€ì…
    carrier_types = ['FOUP', 'FOSB', 'OPEN_CASSETTE']
    
    # ì›¨ì´í¼ ì‚¬ì´ì¦ˆ
    wafer_sizes = ['200mm', '300mm']
    
    # ì œí’ˆ ì½”ë“œ
    product_codes = ['DRAM_16G', 'DRAM_32G', 'NAND_512G', 'NAND_1T', 
                     'LOGIC_7NM', 'LOGIC_5NM', 'ANALOG_28NM']
    
    # ìš°ì„ ìˆœìœ„
    priorities = ['NORMAL', 'HOT_LOT', 'SUPER_HOT', 'ENGINEERING', 'PILOT']
    
    # MCS ì´ë²¤íŠ¸ íƒ€ì…
    event_types = [
        'LOAD_REQUEST',      # ì ì¬ ìš”ì²­
        'UNLOAD_REQUEST',    # í•˜ì—­ ìš”ì²­
        'TRANSFER_START',    # ì´ì†¡ ì‹œì‘
        'TRANSFER_COMPLETE', # ì´ì†¡ ì™„ë£Œ
        'PROCESS_START',     # ê³µì • ì‹œì‘
        'PROCESS_END',       # ê³µì • ì¢…ë£Œ
        'STOCKER_IN',       # ìŠ¤í† ì»¤ ì…ê³ 
        'STOCKER_OUT',      # ìŠ¤í† ì»¤ ì¶œê³ 
        'SENSOR_UPDATE',    # ì„¼ì„œ ë°ì´í„° ì—…ë°ì´íŠ¸
        'ALARM_OCCURRED',   # ì•ŒëŒ ë°œìƒ
        'ALARM_CLEARED'     # ì•ŒëŒ í•´ì œ
    ]
    
    # ìš´ë°˜ ì¥ë¹„
    transport_vehicles = ['OHT', 'OHS', 'AGV', 'RGV', 'MANUAL']
    
    # ì•ŒëŒ ì½”ë“œ
    alarm_codes = ['E84_TIMEOUT', 'CARRIER_ID_MISMATCH', 'VEHICLE_COLLISION_RISK', 
                   'LOADPORT_ERROR', 'STOCKER_FULL', 'PATH_BLOCKED', 'SENSOR_OUT_OF_RANGE',
                   'VIBRATION_HIGH', 'TEMPERATURE_HIGH', 'PRESSURE_LOW', 'PARTICLE_HIGH']
    
    # ì„¼ì„œ íƒ€ì…
    sensor_types = ['VIBRATION', 'TEMPERATURE', 'PRESSURE', 'PARTICLE', 'HUMIDITY', 'FLOW_RATE']
    
    records = []
    current_time = base_time
    
    # ì¥ë¹„ë³„ ì„¼ì„œ ê¸°ì¤€ê°’ ì„¤ì •
    equipment_sensor_baseline = {}
    for bay, equipments in equipment_info.items():
        for eq in equipments:
            equipment_sensor_baseline[eq] = {
                'vibration': random.uniform(0.5, 1.5),  # mm/s
                'temperature': random.uniform(20, 25),   # Â°C
                'pressure': random.uniform(750, 760),    # Torr
                'particle': random.randint(10, 50),      # count
                'humidity': random.uniform(40, 50),      # %
                'flow_rate': random.uniform(90, 100)     # %
            }
    
    # ë ˆì½”ë“œ ìƒì„±
    lot_id = f"LOT{2025070000}"
    
    for i in range(num_records):
        # ì‹œê°„ ì¦ê°€ (30ì´ˆ ~ 5ë¶„ ê°„ê²©)
        current_time += timedelta(seconds=random.randint(30, 300))
        
        # ì´ë²¤íŠ¸ íƒ€ì… ì„ íƒ (ì„¼ì„œ ì—…ë°ì´íŠ¸ ì´ë²¤íŠ¸ ë¹„ì¤‘ ë†’ì„)
        if random.random() < 0.3:  # 30% í™•ë¥ ë¡œ ì„¼ì„œ ë°ì´í„°
            event_type = 'SENSOR_UPDATE'
        else:
            event_type = random.choice([et for et in event_types if et != 'SENSOR_UPDATE'])
        
        # ê¸°ë³¸ MCS ë°ì´í„°
        base_data = {
            'timestamp': current_time.strftime('%Y-%m-%d %H:%M:%S'),
            'event_type': event_type,
            'lot_id': f"LOT{2025070000 + i // 10:010d}",
            'carrier_id': f"CAR{random.randint(10000, 99999)}",
            'carrier_type': random.choice(carrier_types),
            'product_code': random.choice(product_codes),
            'wafer_size': random.choice(wafer_sizes),
            'wafer_count': 25 if random.choice(wafer_sizes) == '300mm' else 50,
            'priority': random.choice(priorities),
            'fab_line': random.choice(fab_lines),
            'status': 'NORMAL',
            'alarm_code': None,
        }
        
        # ì´ë²¤íŠ¸ë³„ ì¶”ê°€ ë°ì´í„°
        if event_type in ['LOAD_REQUEST', 'UNLOAD_REQUEST', 'PROCESS_START', 'PROCESS_END']:
            # ì¥ë¹„ ê´€ë ¨ ì´ë²¤íŠ¸
            bay = random.choice(list(bays.keys()))
            equipment = random.choice(equipment_info[bay])
            
            base_data.update({
                'location': bay,
                'equipment_id': equipment,
                'recipe': f"{bay}_RECIPE_{random.randint(1, 5)}",
                'step_number': f"{random.randint(1, 10) * 100}",
            })
            
            # ê³µì • ì‹œì‘/ì¢…ë£Œ ì‹œ ì„¼ì„œ ë°ì´í„° í¬í•¨
            if event_type in ['PROCESS_START', 'PROCESS_END']:
                baseline = equipment_sensor_baseline[equipment]
                base_data.update({
                    'sensor_vibration_mm_s': round(baseline['vibration'] + random.gauss(0, 0.1), 3),
                    'sensor_temperature_c': round(baseline['temperature'] + random.gauss(0, 1), 1),
                    'sensor_pressure_torr': round(baseline['pressure'] + random.gauss(0, 2), 1),
                    'sensor_particle_count': baseline['particle'] + random.randint(-5, 10),
                    'sensor_humidity_pct': round(baseline['humidity'] + random.gauss(0, 2), 1),
                    'sensor_flow_rate_pct': round(baseline['flow_rate'] + random.gauss(0, 3), 1),
                })
                
        elif event_type in ['TRANSFER_START', 'TRANSFER_COMPLETE']:
            # ì´ì†¡ ê´€ë ¨ ì´ë²¤íŠ¸
            base_data.update({
                'from_location': random.choice(list(bays.keys()) + ['STOCKER_01', 'STOCKER_02']),
                'to_location': random.choice(list(bays.keys()) + ['STOCKER_01', 'STOCKER_02']),
                'vehicle_id': f"{random.choice(transport_vehicles)}_{random.randint(100, 999)}",
                'transfer_time_sec': random.randint(30, 300) if event_type == 'TRANSFER_COMPLETE' else None,
            })
            
            # OHTì˜ ê²½ìš° ì§„ë™ ë°ì´í„° ì¶”ê°€
            if 'OHT' in base_data.get('vehicle_id', ''):
                base_data['oht_vibration_mm_s'] = round(random.uniform(0.1, 0.5) + 
                                                       (random.uniform(0.5, 1.5) if random.random() < 0.1 else 0), 3)
                
        elif event_type == 'SENSOR_UPDATE':
            # ì„¼ì„œ ë°ì´í„° ì—…ë°ì´íŠ¸ ì´ë²¤íŠ¸
            bay = random.choice(list(bays.keys()))
            equipment = random.choice(equipment_info[bay])
            baseline = equipment_sensor_baseline[equipment]
            
            # ê°€ë” ì´ìƒì¹˜ ë°œìƒ (10% í™•ë¥ )
            anomaly = random.random() < 0.1
            anomaly_factor = random.uniform(1.5, 3.0) if anomaly else 1.0
            
            base_data.update({
                'location': bay,
                'equipment_id': equipment,
                'sensor_type': random.choice(sensor_types),
                'sensor_vibration_mm_s': round(baseline['vibration'] * anomaly_factor + random.gauss(0, 0.1), 3),
                'sensor_temperature_c': round(baseline['temperature'] + 
                                            (random.uniform(5, 15) if anomaly else random.gauss(0, 1)), 1),
                'sensor_pressure_torr': round(baseline['pressure'] + random.gauss(0, 2), 1),
                'sensor_particle_count': baseline['particle'] + 
                                       (random.randint(50, 200) if anomaly else random.randint(-5, 10)),
                'sensor_humidity_pct': round(baseline['humidity'] + random.gauss(0, 2), 1),
                'sensor_flow_rate_pct': round(baseline['flow_rate'] + random.gauss(0, 3), 1),
                'sensor_status': 'ANOMALY' if anomaly else 'NORMAL'
            })
            
            # ì´ìƒì¹˜ ë°œìƒ ì‹œ ìƒíƒœ ì—…ë°ì´íŠ¸
            if anomaly:
                base_data['status'] = 'WARNING'
                
        elif event_type == 'ALARM_OCCURRED':
            # ì•ŒëŒ ë°œìƒ
            bay = random.choice(list(bays.keys()))
            equipment = random.choice(equipment_info[bay])
            
            base_data.update({
                'location': bay,
                'equipment_id': equipment,
                'alarm_code': random.choice(alarm_codes),
                'status': 'ALARM',
                'alarm_severity': random.choice(['WARNING', 'CRITICAL', 'INFO']),
            })
            
            # ì•ŒëŒ ë°œìƒ ì‹œ ì„¼ì„œ ë°ì´í„°ë„ í¬í•¨
            baseline = equipment_sensor_baseline[equipment]
            if 'VIBRATION' in base_data['alarm_code']:
                base_data['sensor_vibration_mm_s'] = round(baseline['vibration'] * random.uniform(2, 4), 3)
            elif 'TEMPERATURE' in base_data['alarm_code']:
                base_data['sensor_temperature_c'] = round(baseline['temperature'] + random.uniform(10, 20), 1)
            elif 'PARTICLE' in base_data['alarm_code']:
                base_data['sensor_particle_count'] = baseline['particle'] + random.randint(100, 500)
                
        elif event_type in ['STOCKER_IN', 'STOCKER_OUT']:
            # ìŠ¤í† ì»¤ ì…ì¶œê³ 
            base_data.update({
                'location': f"STOCKER_{random.randint(1, 5):02d}",
                'stocker_capacity_pct': random.randint(40, 95),
            })
            
        records.append(base_data)
    
    # DataFrame ìƒì„±
    df = pd.DataFrame(records)
    
    # ì‹œê°„ìˆœ ì •ë ¬
    df['timestamp'] = pd.to_datetime(df['timestamp'])
    df = df.sort_values('timestamp').reset_index(drop=True)
    
    return df


def analyze_mcs_data(df):
    """
    MCS ë°ì´í„° ë¶„ì„ ë° ìš”ì•½
    """
    print("\nğŸ“Š MCS ë°ì´í„° ë¶„ì„ ê²°ê³¼:")
    print(f"- ì´ ë ˆì½”ë“œ ìˆ˜: {len(df)}")
    print(f"- ê¸°ê°„: {df['timestamp'].min()} ~ {df['timestamp'].max()}")
    print(f"- ê³ ìœ  LOT ìˆ˜: {df['lot_id'].nunique()}")
    print(f"- ê³ ìœ  ìºë¦¬ì–´ ìˆ˜: {df['carrier_id'].nunique()}")
    
    print("\nğŸ“ˆ ì´ë²¤íŠ¸ íƒ€ì…ë³„ ë¶„í¬:")
    event_dist = df['event_type'].value_counts()
    for event, count in event_dist.items():
        print(f"  - {event}: {count} ({count/len(df)*100:.1f}%)")
    
    # ì„¼ì„œ ë°ì´í„° ë¶„ì„
    sensor_cols = [col for col in df.columns if col.startswith('sensor_')]
    if sensor_cols:
        print("\nğŸ” ì„¼ì„œ ë°ì´í„° ë¶„ì„:")
        
        # ì§„ë™ ë°ì´í„°
        if 'sensor_vibration_mm_s' in df.columns:
            vibration_data = df['sensor_vibration_mm_s'].dropna()
            if len(vibration_data) > 0:
                print(f"  ì§„ë™ ì„¼ì„œ:")
                print(f"    - í‰ê· : {vibration_data.mean():.3f} mm/s")
                print(f"    - ìµœëŒ€: {vibration_data.max():.3f} mm/s")
                print(f"    - ì´ìƒì¹˜ (>2.0): {(vibration_data > 2.0).sum()}ê±´")
        
        # ì˜¨ë„ ë°ì´í„°
        if 'sensor_temperature_c' in df.columns:
            temp_data = df['sensor_temperature_c'].dropna()
            if len(temp_data) > 0:
                print(f"  ì˜¨ë„ ì„¼ì„œ:")
                print(f"    - í‰ê· : {temp_data.mean():.1f} Â°C")
                print(f"    - ìµœëŒ€: {temp_data.max():.1f} Â°C")
                print(f"    - ì´ìƒì¹˜ (>30Â°C): {(temp_data > 30).sum()}ê±´")
        
        # íŒŒí‹°í´ ë°ì´í„°
        if 'sensor_particle_count' in df.columns:
            particle_data = df['sensor_particle_count'].dropna()
            if len(particle_data) > 0:
                print(f"  íŒŒí‹°í´ ì„¼ì„œ:")
                print(f"    - í‰ê· : {particle_data.mean():.0f} count")
                print(f"    - ìµœëŒ€: {particle_data.max()} count")
                print(f"    - ì´ìƒì¹˜ (>100): {(particle_data > 100).sum()}ê±´")
    
    # ì•ŒëŒ ë¶„ì„
    alarm_data = df[df['event_type'] == 'ALARM_OCCURRED']
    if len(alarm_data) > 0:
        print(f"\nâš ï¸ ì•ŒëŒ ë¶„ì„:")
        print(f"  - ì´ ì•ŒëŒ ìˆ˜: {len(alarm_data)}")
        print(f"  - ì•ŒëŒ íƒ€ì…ë³„:")
        for alarm, count in alarm_data['alarm_code'].value_counts().items():
            print(f"    - {alarm}: {count}ê±´")
    
    # ì¥ë¹„ë³„ ì´ë²¤íŠ¸
    if 'equipment_id' in df.columns:
        equipment_events = df[df['equipment_id'].notna()]['equipment_id'].value_counts().head(5)
        print(f"\nğŸ­ ìƒìœ„ 5ê°œ ì¥ë¹„ ì´ë²¤íŠ¸:")
        for eq, count in equipment_events.items():
            print(f"  - {eq}: {count}ê±´")
    
    return df


def save_integrated_mcs_data(df):
    """
    í†µí•© MCS ë°ì´í„° ì €ì¥
    """
    # ì¶œë ¥ ë””ë ‰í† ë¦¬ ìƒì„±
    output_dir = "integrated_mcs_data"
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    # CSV ì €ì¥
    csv_path = os.path.join(output_dir, 'integrated_mcs_data.csv')
    df.to_csv(csv_path, index=False, encoding='utf-8-sig')
    print(f"\nâœ… CSV íŒŒì¼ ì €ì¥: {csv_path}")
    
    # JSON ì €ì¥
    df_json = df.copy()
    df_json['timestamp'] = df_json['timestamp'].astype(str)
    json_path = os.path.join(output_dir, 'integrated_mcs_data.json')
    df_json.to_json(json_path, orient='records', force_ascii=False, indent=2)
    print(f"âœ… JSON íŒŒì¼ ì €ì¥: {json_path}")
    
    # Excel ì €ì¥ (ìƒì„¸ ë¶„ì„ í¬í•¨)
    excel_path = os.path.join(output_dir, 'integrated_mcs_data.xlsx')
    with pd.ExcelWriter(excel_path, engine='openpyxl') as writer:
        # ì „ì²´ ë°ì´í„°
        df.to_excel(writer, sheet_name='MCS_Data', index=False)
        
        # ì´ë²¤íŠ¸ ìš”ì•½
        event_summary = df['event_type'].value_counts().reset_index()
        event_summary.columns = ['ì´ë²¤íŠ¸_íƒ€ì…', 'ê±´ìˆ˜']
        event_summary.to_excel(writer, sheet_name='Event_Summary', index=False)
        
        # ì„¼ì„œ ë°ì´í„°ë§Œ ì¶”ì¶œ
        sensor_cols = ['timestamp', 'equipment_id', 'location'] + [col for col in df.columns if 'sensor_' in col]
        sensor_data = df[df['event_type'].isin(['SENSOR_UPDATE', 'PROCESS_START', 'PROCESS_END'])][
            [col for col in sensor_cols if col in df.columns]
        ].dropna(how='all')
        
        if len(sensor_data) > 0:
            sensor_data.to_excel(writer, sheet_name='Sensor_Data', index=False)
        
        # ì•ŒëŒ ë°ì´í„°
        alarm_data = df[df['event_type'] == 'ALARM_OCCURRED']
        if len(alarm_data) > 0:
            alarm_data.to_excel(writer, sheet_name='Alarm_Data', index=False)
        
        # í†µê³„ ìš”ì•½
        stats_data = {
            'í•­ëª©': ['ì´ ë ˆì½”ë“œ ìˆ˜', 'ê³ ìœ  LOT ìˆ˜', 'ê³ ìœ  ìºë¦¬ì–´ ìˆ˜', 'ì„¼ì„œ ì—…ë°ì´íŠ¸ ìˆ˜', 
                    'ì•ŒëŒ ë°œìƒ ìˆ˜', 'í‰ê·  ì´ì†¡ ì‹œê°„(ì´ˆ)'],
            'ê°’': [
                len(df),
                df['lot_id'].nunique(),
                df['carrier_id'].nunique(),
                len(df[df['event_type'] == 'SENSOR_UPDATE']),
                len(df[df['event_type'] == 'ALARM_OCCURRED']),
                df[df['transfer_time_sec'].notna()]['transfer_time_sec'].mean() if 'transfer_time_sec' in df.columns else 'N/A'
            ]
        }
        stats_df = pd.DataFrame(stats_data)
        stats_df.to_excel(writer, sheet_name='Statistics', index=False)
    
    print(f"âœ… Excel íŒŒì¼ ì €ì¥: {excel_path}")
    
    return output_dir


def create_sample_queries():
    """
    ë°ì´í„° í™œìš©ì„ ìœ„í•œ ìƒ˜í”Œ ì¿¼ë¦¬ ìƒì„±
    """
    queries = """
ğŸ“Œ MCS ë°ì´í„° í™œìš© ìƒ˜í”Œ ì¿¼ë¦¬:

1. íŠ¹ì • ì¥ë¹„ì˜ ì„¼ì„œ ë°ì´í„° ì¡°íšŒ:
   df[(df['equipment_id'] == 'ASML_NXT_1980') & (df['sensor_vibration_mm_s'].notna())]

2. ì§„ë™ ì´ìƒì¹˜ íƒì§€:
   df[df['sensor_vibration_mm_s'] > 2.0]

3. ì‹œê°„ëŒ€ë³„ ì•ŒëŒ ë°œìƒ íŒ¨í„´:
   df[df['event_type'] == 'ALARM_OCCURRED'].groupby(df['timestamp'].dt.hour)['alarm_code'].count()

4. LOTë³„ ì²˜ë¦¬ ì‹œê°„ ë¶„ì„:
   df.groupby('lot_id')['transfer_time_sec'].agg(['mean', 'sum', 'count'])

5. íŠ¹ì • ë² ì´ì˜ ì¥ë¹„ ê°€ë™ í˜„í™©:
   df[(df['location'] == 'PHOTO') & (df['event_type'].isin(['PROCESS_START', 'PROCESS_END']))]

6. ì„¼ì„œ ë°ì´í„° ì‹œê³„ì—´ ë¶„ì„:
   sensor_data = df[df['sensor_temperature_c'].notna()].set_index('timestamp')
   sensor_data['sensor_temperature_c'].resample('1H').mean()

7. íŒŒí‹°í´ ì¹´ìš´íŠ¸ ì´ìƒ íŒ¨í„´:
   df[(df['sensor_particle_count'] > 100) & (df['event_type'] == 'SENSOR_UPDATE')]

8. ì¥ë¹„ë³„ ì•ŒëŒ ë¹ˆë„:
   df[df['event_type'] == 'ALARM_OCCURRED'].groupby('equipment_id')['alarm_code'].count().sort_values(ascending=False)
"""
    
    # ì¿¼ë¦¬ íŒŒì¼ ì €ì¥
    with open('integrated_mcs_data/sample_queries.txt', 'w', encoding='utf-8') as f:
        f.write(queries)
    
    print("\nğŸ“„ ìƒ˜í”Œ ì¿¼ë¦¬ íŒŒì¼ ìƒì„±: integrated_mcs_data/sample_queries.txt")


def main():
    """
    ë©”ì¸ ì‹¤í–‰ í•¨ìˆ˜
    """
    print("="*60)
    print("ğŸ­ ë°˜ë„ì²´ FAB í†µí•© MCS ë°ì´í„° ìƒì„±")
    print("="*60)
    print(f"ì‹¤í–‰ ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    
    # 1. ë°ì´í„° ìƒì„±
    print("\n1ï¸âƒ£ í†µí•© MCS ë°ì´í„° ìƒì„± ì¤‘...")
    df = generate_integrated_mcs_data(100)
    print(f"   - ìƒì„±ëœ ë ˆì½”ë“œ: {len(df)}ê°œ")
    
    # 2. ë°ì´í„° ë¶„ì„
    print("\n2ï¸âƒ£ ë°ì´í„° ë¶„ì„ ì¤‘...")
    analyze_mcs_data(df)
    
    # 3. íŒŒì¼ ì €ì¥
    print("\n3ï¸âƒ£ ë°ì´í„° íŒŒì¼ ì €ì¥ ì¤‘...")
    output_dir = save_integrated_mcs_data(df)
    
    # 4. ìƒ˜í”Œ ì¿¼ë¦¬ ìƒì„±
    create_sample_queries()
    
    # 5. ê²°ê³¼ ìš”ì•½
    print("\n" + "="*60)
    print("âœ¨ í†µí•© MCS ë°ì´í„° ìƒì„± ì™„ë£Œ!")
    print("="*60)
    print(f"\nğŸ“ ìƒì„±ëœ íŒŒì¼ ìœ„ì¹˜: {os.path.abspath(output_dir)}")
    print("\nğŸ“„ ìƒì„±ëœ íŒŒì¼ ëª©ë¡:")
    print("  - integrated_mcs_data.csv : ì „ì²´ MCS ë¡œê·¸ ë°ì´í„°")
    print("  - integrated_mcs_data.json : JSON í˜•ì‹")
    print("  - integrated_mcs_data.xlsx : Excel (ì‹œíŠ¸ë³„ ë¶„ì„ í¬í•¨)")
    print("  - sample_queries.txt : ë°ì´í„° í™œìš© ìƒ˜í”Œ ì¿¼ë¦¬")
    
    print("\nğŸ’¡ ë°ì´í„° íŠ¹ì§•:")
    print("  - MCS ì´ë²¤íŠ¸ ë¡œê·¸ (ì´ì†¡, ê³µì •, ì•ŒëŒ ë“±)")
    print("  - ì¥ë¹„ ì„¼ì„œ ë°ì´í„° (ì§„ë™, ì˜¨ë„, ì••ë ¥, íŒŒí‹°í´ ë“±)")
    print("  - OHT ì§„ë™ ë°ì´í„°")
    print("  - ì‹¤ì‹œê°„ ì„¼ì„œ ì—…ë°ì´íŠ¸ ì´ë²¤íŠ¸")
    print("  - ì•ŒëŒ ë°œìƒ ì‹œ ê´€ë ¨ ì„¼ì„œ ë°ì´í„° í¬í•¨")
    
    # ìƒ˜í”Œ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°
    print("\nğŸ“Š ìƒ˜í”Œ ë°ì´í„° (ì²˜ìŒ 3ê°œ):")
    pd.set_option('display.max_columns', 10)
    pd.set_option('display.width', 120)
    print(df[['timestamp', 'event_type', 'equipment_id', 'sensor_vibration_mm_s', 'sensor_temperature_c']].head(3))
    
    return df


if __name__ == "__main__":
    # pandas ì˜µì…˜ ì„¤ì •
    pd.set_option('display.max_colwidth', 50)
    
    # ë©”ì¸ í•¨ìˆ˜ ì‹¤í–‰
    mcs_df = main()