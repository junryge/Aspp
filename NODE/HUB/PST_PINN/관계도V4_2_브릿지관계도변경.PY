# -*- coding: utf-8 -*-
"""
PatchTST & PatchTST+PINN ëª¨ë¸ êµ¬ì¶•ì„ ìœ„í•œ ì‹¤ì œ ë°ì´í„° ê²€ì¦ (ê°œì„ ëœ ë²„ì „)
- ì»¬ëŸ¼ë³„ ìƒì„¸ í‰ê°€ ë° ëª¨ë¸ë³„ ë“±ê¸‰/ì ìˆ˜ ì‹œìŠ¤í…œ ì¶”ê°€
"""

import pandas as pd
import numpy as np
import os
from datetime import datetime
import warnings
warnings.filterwarnings('ignore')

# ì»¬ëŸ¼ í‰ê°€ ê¸°ì¤€ ì •ì˜
COLUMN_DEFINITIONS = [
    # íƒ€ê²Ÿ
    {"ì»¬ëŸ¼ëª…": "CURRENT_M16A_3F_JOB_2", "ì¹´í…Œê³ ë¦¬": "íƒ€ê²Ÿ", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 100, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
    # ìœ ì…
    {"ì»¬ëŸ¼ëª…": "M16A_6F_TO_HUB_JOB", "ì¹´í…Œê³ ë¦¬": "ìœ ì…", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 70, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
    {"ì»¬ëŸ¼ëª…": "M16A_2F_TO_HUB_JOB2", "ì¹´í…Œê³ ë¦¬": "ìœ ì…", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 65, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
    {"ì»¬ëŸ¼ëª…": "M14A_3F_TO_HUB_JOB2", "ì¹´í…Œê³ ë¦¬": "ìœ ì…", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 65, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
    {"ì»¬ëŸ¼ëª…": "M14B_7F_TO_HUB_JOB2", "ì¹´í…Œê³ ë¦¬": "ìœ ì…", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 65, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
    {"ì»¬ëŸ¼ëª…": "M16B_10F_TO_HUB_JOB", "ì¹´í…Œê³ ë¦¬": "ìœ ì…", "V4í•„ìˆ˜ë„": "ì„ íƒ", "ì ìˆ˜": 25, "ë¬¼ë¦¬ë²•ì¹™": "ë³´ì¡°"},
    # ìœ ì¶œ
    {"ì»¬ëŸ¼ëª…": "M16A_3F_TO_M16A_6F_JOB", "ì¹´í…Œê³ ë¦¬": "ìœ ì¶œ", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 60, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
    {"ì»¬ëŸ¼ëª…": "M16A_3F_TO_M16A_2F_JOB", "ì¹´í…Œê³ ë¦¬": "ìœ ì¶œ", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 55, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
    {"ì»¬ëŸ¼ëª…": "M16A_3F_TO_M14A_3F_JOB", "ì¹´í…Œê³ ë¦¬": "ìœ ì¶œ", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 55, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
    {"ì»¬ëŸ¼ëª…": "M16A_3F_TO_M14B_7F_JOB", "ì¹´í…Œê³ ë¦¬": "ìœ ì¶œ", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 55, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
    {"ì»¬ëŸ¼ëª…": "M16A_3F_TO_3F_MLUD_JOB", "ì¹´í…Œê³ ë¦¬": "ìœ ì¶œ", "V4í•„ìˆ˜ë„": "ì„ íƒ", "ì ìˆ˜": 35, "ë¬¼ë¦¬ë²•ì¹™": "ë³´ì¡°"},
    # CMD
    {"ì»¬ëŸ¼ëª…": "M16A_3F_CMD", "ì¹´í…Œê³ ë¦¬": "ë‚´ë¶€CMD", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 85, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
    {"ì»¬ëŸ¼ëª…": "M16A_6F_TO_HUB_CMD", "ì¹´í…Œê³ ë¦¬": "ì™¸ë¶€CMD", "V4í•„ìˆ˜ë„": "ê¶Œì¥", "ì ìˆ˜": 55, "ë¬¼ë¦¬ë²•ì¹™": "ë³´ì¡°"},
    {"ì»¬ëŸ¼ëª…": "M16A_2F_TO_HUB_CMD", "ì¹´í…Œê³ ë¦¬": "ì™¸ë¶€CMD", "V4í•„ìˆ˜ë„": "ì„ íƒ", "ì ìˆ˜": 50, "ë¬¼ë¦¬ë²•ì¹™": "ë³´ì¡°"},
    {"ì»¬ëŸ¼ëª…": "M14A_3F_TO_HUB_CMD", "ì¹´í…Œê³ ë¦¬": "ì™¸ë¶€CMD", "V4í•„ìˆ˜ë„": "ì„ íƒ", "ì ìˆ˜": 50, "ë¬¼ë¦¬ë²•ì¹™": "ë³´ì¡°"},
    {"ì»¬ëŸ¼ëª…": "M14B_7F_TO_HUB_CMD", "ì¹´í…Œê³ ë¦¬": "ì™¸ë¶€CMD", "V4í•„ìˆ˜ë„": "ì„ íƒ", "ì ìˆ˜": 50, "ë¬¼ë¦¬ë²•ì¹™": "ë³´ì¡°"},
    # MaxCapa
    {"ì»¬ëŸ¼ëª…": "M16A_6F_LFT_MAXCAPA", "ì¹´í…Œê³ ë¦¬": "MaxCapa", "V4í•„ìˆ˜ë„": "ì„ íƒ", "ì ìˆ˜": 50, "ë¬¼ë¦¬ë²•ì¹™": "ë³´ì¡°"},
    {"ì»¬ëŸ¼ëª…": "M16A_2F_LFT_MAXCAPA", "ì¹´í…Œê³ ë¦¬": "MaxCapa", "V4í•„ìˆ˜ë„": "ì„ íƒ", "ì ìˆ˜": 45, "ë¬¼ë¦¬ë²•ì¹™": "ë³´ì¡°"},
    # ê·¹ë‹¨ê°’ì§€í‘œ
    {"ì»¬ëŸ¼ëª…": "M16A_3F_STORAGE_UTIL", "ì¹´í…Œê³ ë¦¬": "ê·¹ë‹¨ê°’ì§€í‘œ", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 95, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
    # OFS
    {"ì»¬ëŸ¼ëª…": "M14_TO_M16_OFS_CUR", "ì¹´í…Œê³ ë¦¬": "OFS", "V4í•„ìˆ˜ë„": "ì„ íƒ", "ì ìˆ˜": 40, "ë¬¼ë¦¬ë²•ì¹™": "ë³´ì¡°"},
    {"ì»¬ëŸ¼ëª…": "M16_TO_M14_OFS_CUR", "ì¹´í…Œê³ ë¦¬": "OFS", "V4í•„ìˆ˜ë„": "ì„ íƒ", "ì ìˆ˜": 40, "ë¬¼ë¦¬ë²•ì¹™": "ë³´ì¡°"},
    # ë¬¼ë¦¬ ì§€í‘œ
    {"ì»¬ëŸ¼ëª…": "BRIDGE_TIME", "ì¹´í…Œê³ ë¦¬": "ë¬¼ë¦¬ì§€í‘œ", "V4í•„ìˆ˜ë„": "í•„ìˆ˜", "ì ìˆ˜": 85, "ë¬¼ë¦¬ë²•ì¹™": "í•µì‹¬"},
]

def get_grade(score, max_score):
    """ì ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë“±ê¸‰ì„ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜"""
    if max_score == 0:
        return 'N/A', 'âš«'
    ratio = score / max_score
    if ratio >= 0.9:
        return 'A+', 'ğŸŸ¢'
    elif ratio >= 0.8:
        return 'A', 'ğŸŸ¢'
    elif ratio >= 0.7:
        return 'B+', 'ğŸŸ¡'
    elif ratio >= 0.6:
        return 'B', 'ğŸŸ¡'
    elif ratio >= 0.4:
        return 'C', 'ğŸŸ '
    else:
        return 'F', 'ğŸ”´'

def validate_real_data_upgraded():
    """
    ì»¬ëŸ¼ë³„ ìƒì„¸ í‰ê°€ ë° ëª¨ë¸ë³„ ë“±ê¸‰ ì‹œìŠ¤í…œì´ ì¶”ê°€ëœ ë°ì´í„° ê²€ì¦ í•¨ìˆ˜
    """
    print("=" * 80)
    print("ğŸ” PatchTST & PatchTST+PINN ëª¨ë¸ ë°ì´í„° ì¢…í•© ê²€ì¦")
    print(f"ğŸ“… ê²€ì¦ ì‹œê°„: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    print("=" * 80)

    # 1. ë°ì´í„° ë¡œë“œ (ê¸°ì¡´ ì½”ë“œì™€ ë™ì¼)
    data_main = 'data/HUB_0509_TO_0807_DATA.CSV'
    data_bridge = 'data/BRTIME_0509_TO_0831.CSV'

    if not (os.path.exists(data_main) and os.path.exists(data_bridge)):
        print("\nâŒ ë°ì´í„° íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê²½ë¡œë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")
        return
        
    df_main = pd.read_csv(data_main, encoding='utf-8-sig')
    df_bridge = pd.read_csv(data_bridge, encoding='utf-8-sig')
    
    # 2. ì‹œê°„ ì»¬ëŸ¼ ì²˜ë¦¬ ë° ë°ì´í„° ë³‘í•© (ê¸°ì¡´ ì½”ë“œì™€ ë™ì¼)
    df_main['time'] = pd.to_datetime(df_main['STAT_DT'].astype(str), format='%Y%m%d%H%M')
    df_bridge['time'] = pd.to_datetime(df_bridge['CRT_TM'].str[:19])
    df = pd.merge(df_main, df_bridge[['time', 'IDC_VAL']], on='time', how='left')
    df.rename(columns={'IDC_VAL': 'BRIDGE_TIME'}, inplace=True)
    df['BRIDGE_TIME'] = df['BRIDGE_TIME'].interpolate(method='linear').fillna(df['BRIDGE_TIME'].mean())
    
    print(f"\nâœ… ë°ì´í„° ë¡œë“œ ë° ë³‘í•© ì™„ë£Œ: {df.shape[0]:,}í–‰ Ã— {df.shape[1]}ì—´")
    
    # 3. ì»¬ëŸ¼ë³„ ìƒì„¸ í‰ê°€ (ì‹ ê·œ)
    print("\n" + "=" * 80)
    print("ğŸ“‹ 1. ì»¬ëŸ¼ë³„ ìƒì„¸ í‰ê°€ ë¦¬í¬íŠ¸")
    print("-" * 80)
    
    eval_df = pd.DataFrame(COLUMN_DEFINITIONS)
    eval_df['ì¡´ì¬ì—¬ë¶€'] = eval_df['ì»¬ëŸ¼ëª…'].apply(lambda x: 'âœ…' if x in df.columns else 'âŒ')
    
    # ì¹´í…Œê³ ë¦¬ë³„ë¡œ ê·¸ë£¹í™”í•˜ì—¬ ì¶œë ¥
    for category, group in eval_df.groupby('ì¹´í…Œê³ ë¦¬'):
        print(f"\n--- {category} ({len(group)}ê°œ) ---")
        for _, row in group.iterrows():
            print(f"{row['ì¡´ì¬ì—¬ë¶€']} {row['ì»¬ëŸ¼ëª…'].ljust(30)} | í•„ìˆ˜ë„: {row['V4í•„ìˆ˜ë„'].ljust(4)} | ì ìˆ˜: {row['ì ìˆ˜']}")

    # 4. ëª¨ë¸ë³„ êµ¬ì¶• ê°€ëŠ¥ì„± í‰ê°€ (ê°œì„ )
    print("\n" + "=" * 80)
    print("ğŸ¤– 2. ëª¨ë¸ë³„ ì¤€ë¹„ë„ ë° ë“±ê¸‰ í‰ê°€")
    print("-" * 80)
    
    # ëª¨ë¸ë³„ í‰ê°€ì— ì‚¬ìš©ë  ì¹´í…Œê³ ë¦¬ ì •ì˜
    pinn_categories = ['íƒ€ê²Ÿ', 'ìœ ì…', 'ìœ ì¶œ', 'ë¬¼ë¦¬ì§€í‘œ']
    patchtst_categories = ['íƒ€ê²Ÿ', 'ìœ ì…', 'ìœ ì¶œ', 'ë‚´ë¶€CMD', 'ì™¸ë¶€CMD', 'MaxCapa', 'ê·¹ë‹¨ê°’ì§€í‘œ', 'ë¬¼ë¦¬ì§€í‘œ', 'OFS']

    # --- PatchTST+PINN í‰ê°€ ---
    pinn_eval = eval_df[eval_df['ì¹´í…Œê³ ë¦¬'].isin(pinn_categories)]
    pinn_max_score = pinn_eval['ì ìˆ˜'].sum()
    pinn_current_score = pinn_eval[pinn_eval['ì¡´ì¬ì—¬ë¶€'] == 'âœ…']['ì ìˆ˜'].sum()
    pinn_grade, pinn_emoji = get_grade(pinn_current_score, pinn_max_score)
    
    print(f"\n{pinn_emoji} Model 1: PatchTST + PINN (ë¬¼ë¦¬ë²•ì¹™ ê¸°ë°˜ ëª¨ë¸)")
    print(f"   - í‰ê°€ ì ìˆ˜: {pinn_current_score} / {pinn_max_score}")
    print(f"   - ì¤€ë¹„ë„ ë“±ê¸‰: {pinn_grade}")
    
    # PINN êµ¬ì¶•ì„ ìœ„í•œ í•µì‹¬ ì¡°ê±´ í™•ì¸
    has_target = 'âœ…' in eval_df[eval_df['ì¹´í…Œê³ ë¦¬'] == 'íƒ€ê²Ÿ']['ì¡´ì¬ì—¬ë¶€'].values
    has_inflow = 'âœ…' in eval_df[eval_df['ì¹´í…Œê³ ë¦¬'] == 'ìœ ì…']['ì¡´ì¬ì—¬ë¶€'].values
    has_outflow = 'âœ…' in eval_df[eval_df['ì¹´í…Œê³ ë¦¬'] == 'ìœ ì¶œ']['ì¡´ì¬ì—¬ë¶€'].values
    
    if has_target and has_inflow and has_outflow:
        print("   - êµ¬ì¶• ì—¬ë¶€: âœ… ê°€ëŠ¥ (ë¬¼ë¦¬ë²•ì¹™ ì ìš©ì„ ìœ„í•œ í•µì‹¬ ì»¬ëŸ¼ ëª¨ë‘ ì¡´ì¬)")
    else:
        print("   - êµ¬ì¶• ì—¬ë¶€: âŒ ë¶ˆê°€ (íƒ€ê²Ÿ, ìœ ì…, ìœ ì¶œ ì¤‘ í•˜ë‚˜ ì´ìƒ ëˆ„ë½)")

    # --- PatchTST í‰ê°€ ---
    patchtst_eval = eval_df[eval_df['ì¹´í…Œê³ ë¦¬'].isin(patchtst_categories)]
    patchtst_max_score = patchtst_eval['ì ìˆ˜'].sum()
    patchtst_current_score = patchtst_eval[patchtst_eval['ì¡´ì¬ì—¬ë¶€'] == 'âœ…']['ì ìˆ˜'].sum()
    patchtst_grade, patchtst_emoji = get_grade(patchtst_current_score, patchtst_max_score)

    print(f"\n{patchtst_emoji} Model 2: PatchTST (ì¢…í•© ì˜ˆì¸¡ ëª¨ë¸)")
    print(f"   - í‰ê°€ ì ìˆ˜: {patchtst_current_score} / {patchtst_max_score}")
    print(f"   - ì¤€ë¹„ë„ ë“±ê¸‰: {patchtst_grade}")
    if has_target:
        print("   - êµ¬ì¶• ì—¬ë¶€: âœ… ê°€ëŠ¥ (íƒ€ê²Ÿ ì»¬ëŸ¼ ì¡´ì¬)")
    else:
        print("   - êµ¬ì¶• ì—¬ë¶€: âŒ ë¶ˆê°€ (íƒ€ê²Ÿ ì»¬ëŸ¼ ëˆ„ë½)")
        
    # 5. ë¬¼ë¦¬ë²•ì¹™ ë° ë°ì´í„° í’ˆì§ˆ ê²€ì¦ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
    print("\n" + "=" * 80)
    print("âš–ï¸ 3. ë¬¼ë¦¬ë²•ì¹™ ë° ë°ì´í„° í’ˆì§ˆ ê²€ì¦")
    print("-" * 80)

    # ë¬¼ë¦¬ë²•ì¹™ ê· í˜•
    inflow_cols = eval_df[(eval_df['ì¹´í…Œê³ ë¦¬'] == 'ìœ ì…') & (eval_df['ì¡´ì¬ì—¬ë¶€'] == 'âœ…')]['ì»¬ëŸ¼ëª…'].tolist()
    outflow_cols = eval_df[(eval_df['ì¹´í…Œê³ ë¦¬'] == 'ìœ ì¶œ') & (eval_df['ì¡´ì¬ì—¬ë¶€'] == 'âœ…')]['ì»¬ëŸ¼ëª…'].tolist()
    
    if has_target and inflow_cols and outflow_cols:
        stock_change = df['CURRENT_M16A_3F_JOB_2'].diff()
        balance_error = (df[inflow_cols].sum(axis=1) - df[outflow_cols].sum(axis=1) - stock_change).abs().mean()
        print(f"ğŸ“Š ë¬¼ë¦¬ë²•ì¹™ ê· í˜• ì˜¤ì°¨: {balance_error:.2f} (ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ)")
        if balance_error < 10: print("   - í‰ê°€: âœ… ìš°ìˆ˜ (ë¬¼ë¦¬ì  ê´€ê³„ê°€ ë°ì´í„°ì— ì˜ ë°˜ì˜ë¨)")
        else: print("   - í‰ê°€: âš ï¸ ì–‘í˜¸ (ì•½ê°„ì˜ ë¶ˆê· í˜• ì¡´ì¬, ëª¨ë¸ì´ ë³´ì • ê°€ëŠ¥)")
    else:
        print("ğŸ“Š ë¬¼ë¦¬ë²•ì¹™ ê· í˜•: âŒ ê²€ì¦ ë¶ˆê°€ (í•µì‹¬ ì»¬ëŸ¼ ëˆ„ë½)")

    # ë¸Œë¦¬ì§€íƒ€ì„ ìƒê´€ê´€ê³„
    if 'BRIDGE_TIME' in df.columns and has_target:
        corr = df[['CURRENT_M16A_3F_JOB_2', 'BRIDGE_TIME']].corr().iloc[0, 1]
        print(f"ğŸ”— ë¸Œë¦¬ì§€íƒ€ì„-íƒ€ê²Ÿ ìƒê´€ê´€ê³„: {corr:.3f}")

    # ì‹œê³„ì—´ í’ˆì§ˆ
    time_diff = df['time'].diff().dt.total_seconds().mode()[0] / 60
    print(f"ğŸ“ˆ ë°ì´í„° ê°„ê²©: {time_diff:.0f}ë¶„")
    print(f"   - ì´ ê¸°ê°„: {(df['time'].max() - df['time'].min()).days}ì¼")
    print(f"   - í•™ìŠµ ìƒ˜í”Œ ìˆ˜: {len(df) - 30:,}ê°œ (20ë¶„ ì…ë ¥, 10ë¶„ ì˜ˆì¸¡ ê¸°ì¤€)")

    # 6. ìµœì¢… ê¶Œê³ ì‚¬í•­ (ê°œì„ )
    print("\n" + "=" * 80)
    print("ğŸ’¡ 4. ìµœì¢… ìš”ì•½ ë° ê¶Œê³ ì‚¬í•­")
    print("-" * 80)
    
    print(f"í˜„ì¬ ë°ì´í„°ì…‹ì€ **PatchTST+PINN ëª¨ë¸ ê¸°ì¤€ {pinn_grade} ë“±ê¸‰**, **PatchTST ëª¨ë¸ ê¸°ì¤€ {patchtst_grade} ë“±ê¸‰**ì˜ ì¤€ë¹„ë„ë¥¼ ë³´ì…ë‹ˆë‹¤.\n")

    if pinn_grade in ['A+', 'A'] and (has_target and has_inflow and has_outflow):
        print("ğŸ¥‡ **ìµœìš°ì„  ê¶Œì¥: PatchTST+PINN ëª¨ë¸ êµ¬ì¶•**")
        print("   - ë¬¼ë¦¬ë²•ì¹™ì„ ì ìš©í•˜ê¸° ìœ„í•œ í•µì‹¬ ë°ì´í„°ê°€ ëª¨ë‘ í™•ë³´ë˜ì–´ ëª¨ë¸ì˜ ì•ˆì •ì„±ê³¼ ì •í™•ë„ë¥¼ í¬ê²Œ ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
        print("   - ì¬ê³ ëŸ‰ ì˜ˆì¸¡ì˜ ì‹ ë¢°ë„ë¥¼ ê·¹ëŒ€í™”í•  ìˆ˜ ìˆëŠ” ìµœì ì˜ ì¡°ê±´ì…ë‹ˆë‹¤.")
    elif patchtst_grade in ['A+', 'A', 'B+']:
        print("ğŸ¥ˆ **ì°¨ì„  ê¶Œì¥: PatchTST ëª¨ë¸ ìš°ì„  êµ¬ì¶•**")
        print("   - ì¢…í•©ì ì¸ ì˜ˆì¸¡ ì„±ëŠ¥ì„ ë‚´ê¸°ì— ì¶©ë¶„í•œ ë°ì´í„°ê°€ í™•ë³´ë˜ì—ˆìŠµë‹ˆë‹¤.")
        print(f"   - {'ë¬¼ë¦¬ë²•ì¹™ ê´€ë ¨ ë°ì´í„°(ìœ ì…/ìœ ì¶œ) ë³´ê°• ì‹œ PINN ëª¨ë¸ë¡œ í™•ì¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.' if not (has_inflow and has_outflow) else 'PINN ëª¨ë¸ë„ ë³‘í–‰í•˜ì—¬ ì„±ëŠ¥ì„ ë¹„êµí•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤.'}")
    else:
        print("ğŸ”´ **ì£¼ì˜: ë°ì´í„° ë³´ê°• í•„ìš”**")
        print("   - í˜„ì¬ ë°ì´í„°ë¡œëŠ” ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ë³´ì¥í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤.")
        print("   - ì•„ë˜ 'âŒ'ë¡œ í‘œì‹œëœ, ì ìˆ˜ê°€ ë†’ì€ í•„ìˆ˜ ì»¬ëŸ¼ë“¤ì„ ìš°ì„ ì ìœ¼ë¡œ í™•ë³´í•´ì•¼ í•©ë‹ˆë‹¤.")
        missing_critical = eval_df[(eval_df['ì¡´ì¬ì—¬ë¶€'] == 'âŒ') & (eval_df['V4í•„ìˆ˜ë„'].isin(['í•„ìˆ˜', 'ê¶Œì¥']))]
        if not missing_critical.empty:
            print("   - **[ì‹œê¸‰í•œ ë°ì´í„°]** " + ", ".join(missing_critical['ì»¬ëŸ¼ëª…'].tolist()))

    print("\n" + "="*80)
    print("ğŸ ê²€ì¦ ì™„ë£Œ!")
    print("="*80)

# ì‹¤í–‰
if __name__ == "__main__":
    validate_real_data_upgraded()
