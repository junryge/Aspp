SET COLSEP ','
SET PAGESIZE 0
SET TRIMSPOOL ON
SET LINESIZE 32767
SET FEEDBACK OFF
SET HEADING OFF

SPOOL D:\data\AWS_IDC_DATA_HIS_PNT4_TSV_20260101_20260131.csv

-- 헤더 출력
SELECT 'CRT_TM,PNT4_TSV_ETC_ALERT_N2FOUPMISMATCHDEST,PNT4_TSV_ETC_ALERT_CARRIERDUPLICATE,PNT4_TSV_ETC_ALERT_TRANSACTIONTIMEISOVER,PNT4_TSV_ETC_ALERT_DESTUNITNULL,PNT4_TSV_ETC_ALERT_FIOCONNECTION,PNT4_TSV_QUE_LOAD_AVGLOADTIME,PNT4_TSV_QUE_LOAD_CURRENTLOADQCNT,PNT4_TSV_QUE_LOAD_AVGLOADTIME1MIN,PNT4_TSV_QUE_ALL_CURRENTQCREATED,PNT4_TSV_QUE_ALL_CURRENTQCOMPLETED,PNT4_TSV_QUE_ALL_CURRENTQCNT,PNT4_TSV_INPOS_ALERT_104,PNT4_TSV_INPOS_ALERT_90003,PNT4_TSV_INPOS_ALERT_101,PNT4_TSV_INPOS_ALERT_103,PNT4_TSV_INPOS_ALERT_112,PNT4_TSV_INPOS_ALERT_113,PNT4_TSV_INPOS_ALERT_114,PNT4_TSV_OHT_ALERT_OHTMCPALARMCNT,PNT4_TSV_OHT_ALERT_PIOCOMMERROR,PNT4_TSV_OHT_ALERT_OHTSTATUSERROR,PNT4_TSV_OHT_ALERT_OHTLOADFAIL,PNT4_TSV_OHT_ALERT_OHTDISCONNECTION,PNT4_TSV_OHT_ALERT_OHTMCPALARM,PNT4_TSV_OHT_ALERT_OHTCONNECTION,PNT4_TSV_OHT_ALERT_OHTAUTO,PNT4_TSV_OHT_ALERT_OHTPAUSED,PNT4_TSV_OHT_ALERT_OHTHIDALARM,PNT4_TSV_OHT_ALERT_OHTCANNOTEXECUTE,PNT4_TSV_MCS_ALERT_DBQUERYHANG,PNT4_TSV_MCS_ALERT_PROCESSDOWN,PNT4_TSV_MCS_ALERT_PROCESSSHUTDOWNFAIL,PNT4_TSV_MCS_ALERT_PROCESSUPFAIL,PNT4_TSV_MCS_ALERT_PROCESSUPSTART,PNT4_TSV_MCS_ALERT_PROCESSHANG,PNT4_TSV_FIO_ALERT_FIOMCPALARM,PNT4_TSV_FIO_ALERT_FIODISCONNECTION,PNT4_TSV_STRATE_FOUP_STORAGESERVICECAPA,PNT4_TSV_STRATE_FOUP_STORAGERATIO,PNT4_TSV_STRATE_FOUP_STORAGECAPACITY,PNT4_TSV_STRATE_FOUP_STORAGECOUNT,PNT4_TSV_STRATE_MAGAZINE_STORAGESERVICECAPA,PNT4_TSV_STRATE_MAGAZINE_STORAGERATIO,PNT4_TSV_STRATE_MAGAZINE_STORAGECAPACITY,PNT4_TSV_STRATE_MAGAZINE_STORAGECOUNT,PNT4_TSV_STRATE_RINGCST_STORAGERATIO,PNT4_TSV_STRATE_RINGCST_STORAGECAPACITY,PNT4_TSV_STRATE_RINGCST_STORAGECOUNT,PNT4_TSV_STRATE_RINGCST_STORAGESERVICECAPA,PNT4_TSV_MCS_TSVMCSDB01_DISK_APP1,PNT4_TSV_MCS_TSVMCSDB02_DISK_APP1,PNT4_TSV_INV_ALERT_INVDISCONNECTION,PNT4_TSV_INV_ALERT_INVMCPALARM,PNT4_TSV_INV_ALERT_INVAUTO,PNT4_TSV_INV_ALERT_INVCONNECTION,PNT4_TSV_INV_ALERT_INVPAUSED,PNT4_TSV_AZFS_ALERT_DOUBLESTORAGE,PNT4_TSV_AZFS_ALERT_SOURCEEMPTY,PNT4_TSV_STRATE_N2_N2STORAGERATIO,PNT4_TSV_STRATE_N2_N2STORAGECAPACITY,PNT4_TSV_STRATE_N2_N2STORAGECOUNT,PNT4_TSV_STRATE_ALL_FABSTORAGERATIO,PNT4_TSV_STRATE_ALL_FABSTORAGESERVICECAPA,PNT4_TSV_STRATE_ALL_FABSTORAGECAPACITY,PNT4_TSV_STRATE_ALL_FABSTORAGECOUNT,PNT4_TSV_QUE_OHT_OHTUTIL,PNT4_TSV_QUE_OHT_CURRENTOHTQCNT,PNT4_TSV_OHT_ALL_CLUSTER,PNT4_TSV_QUE_ABN_N2STOCKERDELAY,PNT4_TSV_QUE_ABN_AOTRANSDELAYDET,PNT4_TSV_QUE_ABN_AOTRANSDELAY,PNT4_TSV_QUE_ABN_QUETIMEDELAY,PNT4_TSV_QUE_ALERT_BRIDGESTKDISCONNECTED,PNT4_TSV_QUE_ALERT_BRIDGECNVAUTO,PNT4_TSV_QUE_ALERT_FABTRANSJOBDELAY,PNT4_TSV_QUE_ALERT_BRIDGESTKCONNECTED,PNT4_TSV_QUE_ALERT_BRIDGESTKAUTO,PNT4_TSV_QUE_ALERT_BRIDGESTKPAUSED,PNT4_TSV_QUE_ALERT_BRIDGECNVPAUSED,PNT4_TSV_QUE_ALERT_BRIDGEAOPORTTRANSDELAY,PNT4_TSV_QUE_ALERT_NOCLASSDEFFOUNDERROR,PNT4_TSV_QUE_ALERT_BRIDGECNVDISCONNECTED,PNT4_TSV_QUE_ALERT_BRIDGECNVCONNECTED,PNT4_TSV_OHT_ALARM_CLUSTERSTATE,PNT4_TSV_OHT_SERVER_P_STATE,PNT4_TSV_OHT_SERVER_S_STATE,PNT4_TSV_LFT_SENDFAB_TO_PNT4_WT_CURRENTQCNT,PNT4_TSV_LFT_SENDFAB_TO_ICPKG_PNT4_1F_CURRENTQCNT,PNT4_TSV_LFT_SENDFAB_TO_ICPKG_PNT4_5F_CURRENTQCNT,PNT4_TSV_STRATE_NONN2_NONN2STORAGERATIO,PNT4_TSV_STRATE_NONN2_NONN2STORAGECAPACITY,PNT4_TSV_STRATE_NONN2_NONN2STORAGECOUNT,PNT4_TSV_OHT_OHT_P_PROS_STATUS,PNT4_TSV_OHT_OHT_P_ASSIGNEDWAITTOTAL,PNT4_TSV_OHT_OHT_P_CLUSTER,PNT4_TSV_OHT_OHT_P_DISK_USED,PNT4_TSV_OHT_OHT_P_SERVICE_STATUS,PNT4_TSV_OHT_OHT_S_PROS_STATUS,PNT4_TSV_OHT_OHT_S_ASSIGNEDWAITTOTAL,PNT4_TSV_OHT_OHT_S_SERVICE_STATUS,PNT4_TSV_OHT_OHT_S_CLUSTER,PNT4_TSV_OHT_OHT_S_DISK_USED,PNT4_TSV_INV_PC_PROS_STATUS,PNT4_TSV_INV_PC_DISK_USED,PNT4_TSV_STK_ALERT_STKDISCONNECTION,PNT4_TSV_STK_ALERT_STKMCPALARM,PNT4_TSV_STK_ALERT_STKPAUSED,PNT4_TSV_STK_ALERT_STKCONNECTION,PNT4_TSV_STK_ALERT_STKAUTO,PNT4_TSV_RTC_ALERT_RTCDISCONNECTION,PNT4_TSV_STRATE_STK_NONN2FOUPSTORAGERATIO,PNT4_TSV_STRATE_STK_NONN2FOUPSTORAGECOUNT,PNT4_TSV_STRATE_STK_MAGAZINESTORAGERATIO,PNT4_TSV_STRATE_STK_MAGAZINESTORAGECOUNT,PNT4_TSV_STRATE_STK_MAGAZINESTORAGESERVICECAPA,PNT4_TSV_STRATE_STK_MAGAZINESTORAGECAPACITY,PNT4_TSV_STRATE_STK_NONN2FOUPSTORAGESERVICECAPA,PNT4_TSV_STRATE_STK_NONN2FOUPSTORAGECAPACITY,PNT4_TSV_STRATE_STB_NONN2FOUPSTORAGERATIO,PNT4_TSV_STRATE_STB_NONN2FOUPSTORAGECOUNT,PNT4_TSV_STRATE_STB_NONN2FOUPSTORAGESERVICECAPA,PNT4_TSV_STRATE_STB_NONN2FOUPSTORAGECAPACITY,PNT4_TSV_STRATE_STB_N2FOUPSTORAGERATIO,PNT4_TSV_STRATE_STB_N2FOUPSTORAGECOUNT,PNT4_TSV_STRATE_STB_N2FOUPSTORAGESERVICECAPA,PNT4_TSV_STRATE_STB_N2FOUPSTORAGECAPACITY,PNT4_TSV_STRATE_STB_MAGAZINESTORAGERATIO,PNT4_TSV_STRATE_STB_MAGAZINESTORAGECOUNT,PNT4_TSV_STRATE_STB_MAGAZINESTORAGESERVICECAPA,PNT4_TSV_STRATE_STB_MAGAZINESTORAGECAPACITY,PNT4_TSV_STRATE_STB_RINGCSTSTORAGERATIO,PNT4_TSV_STRATE_STB_RINGCSTSTORAGECOUNT,PNT4_TSV_STRATE_STB_RINGCSTSTORAGESERVICECAPA,PNT4_TSV_STRATE_STB_RINGCSTSTORAGECAPACITY' FROM DUAL;

-- 데이터 출력
SELECT
  TO_CHAR(CRT_TM, 'YYYY-MM-DD HH24:MI:SS') || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.ETC.ALERT.N2FOUPMISMATCHDEST' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.ETC.ALERT.CARRIERDUPLICATE' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.ETC.ALERT.TRANSACTIONTIMEISOVER' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.ETC.ALERT.DESTUNITNULL' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.ETC.ALERT.FIOCONNECTION' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.LOAD.AVGLOADTIME' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.LOAD.CURRENTLOADQCNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.LOAD.AVGLOADTIME1MIN' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALL.CURRENTQCREATED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALL.CURRENTQCOMPLETED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALL.CURRENTQCNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INPOS.ALERT.104' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INPOS.ALERT.90003' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INPOS.ALERT.101' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INPOS.ALERT.103' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INPOS.ALERT.112' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INPOS.ALERT.113' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INPOS.ALERT.114' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALERT.OHTMCPALARMCNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALERT.PIOCOMMERROR' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALERT.OHTSTATUSERROR' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALERT.OHTLOADFAIL' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALERT.OHTDISCONNECTION' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALERT.OHTMCPALARM' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALERT.OHTCONNECTION' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALERT.OHTAUTO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALERT.OHTPAUSED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALERT.OHTHIDALARM' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALERT.OHTCANNOTEXECUTE' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.MCS.ALERT.DBQUERYHANG' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.MCS.ALERT.PROCESSDOWN' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.MCS.ALERT.PROCESSSHUTDOWNFAIL' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.MCS.ALERT.PROCESSUPFAIL' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.MCS.ALERT.PROCESSUPSTART' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.MCS.ALERT.PROCESSHANG' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.FIO.ALERT.FIOMCPALARM' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.FIO.ALERT.FIODISCONNECTION' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.FOUP.STORAGESERVICECAPA' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.FOUP.STORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.FOUP.STORAGECAPACITY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.FOUP.STORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.MAGAZINE.STORAGESERVICECAPA' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.MAGAZINE.STORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.MAGAZINE.STORAGECAPACITY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.MAGAZINE.STORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.RINGCST.STORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.RINGCST.STORAGECAPACITY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.RINGCST.STORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.RINGCST.STORAGESERVICECAPA' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.MCS.TSVMCSDB01.DISK_APP1' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.MCS.TSVMCSDB02.DISK_APP1' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INV.ALERT.INVDISCONNECTION' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INV.ALERT.INVMCPALARM' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INV.ALERT.INVAUTO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INV.ALERT.INVCONNECTION' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INV.ALERT.INVPAUSED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.AZFS.ALERT.DOUBLESTORAGE' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.AZFS.ALERT.SOURCEEMPTY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.N2.N2STORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.N2.N2STORAGECAPACITY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.N2.N2STORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.ALL.FABSTORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.ALL.FABSTORAGESERVICECAPA' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.ALL.FABSTORAGECAPACITY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.ALL.FABSTORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.OHT.OHTUTIL' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.OHT.CURRENTOHTQCNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALL.CLUSTER' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ABN.N2STOCKERDELAY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ABN.AOTRANSDELAYDET' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ABN.AOTRANSDELAY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ABN.QUETIMEDELAY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALERT.BRIDGESTKDISCONNECTED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALERT.BRIDGECNVAUTO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALERT.FABTRANSJOBDELAY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALERT.BRIDGESTKCONNECTED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALERT.BRIDGESTKAUTO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALERT.BRIDGESTKPAUSED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALERT.BRIDGECNVPAUSED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALERT.BRIDGEAOPORTTRANSDELAY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALERT.NOCLASSDEFFOUNDERROR' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALERT.BRIDGECNVDISCONNECTED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.QUE.ALERT.BRIDGECNVCONNECTED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.ALARM.CLUSTERSTATE' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.SERVER_P.STATE' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.SERVER_S.STATE' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.LFT.SENDFAB.TO_PNT4_WT_CURRENTQCNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.LFT.SENDFAB.TO_ICPKG_PNT4_1F_CURRENTQCNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.LFT.SENDFAB.TO_ICPKG_PNT4_5F_CURRENTQCNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.NONN2.NONN2STORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.NONN2.NONN2STORAGECAPACITY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.NONN2.NONN2STORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.OHT_P.PROS_STATUS' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.OHT_P.ASSIGNEDWAITTOTAL' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.OHT_P.CLUSTER' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.OHT_P.DISK_USED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.OHT_P.SERVICE_STATUS' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.OHT_S.PROS_STATUS' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.OHT_S.ASSIGNEDWAITTOTAL' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.OHT_S.SERVICE_STATUS' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.OHT_S.CLUSTER' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.OHT.OHT_S.DISK_USED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INV.PC.PROS_STATUS' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.INV.PC.DISK_USED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STK.ALERT.STKDISCONNECTION' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STK.ALERT.STKMCPALARM' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STK.ALERT.STKPAUSED' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STK.ALERT.STKCONNECTION' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STK.ALERT.STKAUTO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.RTC.ALERT.RTCDISCONNECTION' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STK.NONN2FOUPSTORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STK.NONN2FOUPSTORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STK.MAGAZINESTORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STK.MAGAZINESTORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STK.MAGAZINESTORAGESERVICECAPA' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STK.MAGAZINESTORAGECAPACITY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STK.NONN2FOUPSTORAGESERVICECAPA' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STK.NONN2FOUPSTORAGECAPACITY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.NONN2FOUPSTORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.NONN2FOUPSTORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.NONN2FOUPSTORAGESERVICECAPA' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.NONN2FOUPSTORAGECAPACITY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.N2FOUPSTORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.N2FOUPSTORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.N2FOUPSTORAGESERVICECAPA' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.N2FOUPSTORAGECAPACITY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.MAGAZINESTORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.MAGAZINESTORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.MAGAZINESTORAGESERVICECAPA' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.MAGAZINESTORAGECAPACITY' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.RINGCSTSTORAGERATIO' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.RINGCSTSTORAGECOUNT' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.RINGCSTSTORAGESERVICECAPA' THEN IDC_VAL END) || ',' ||
  MAX(CASE WHEN IDC_NM = 'PNT4_TSV.STRATE.STB.RINGCSTSTORAGECAPACITY' THEN IDC_VAL END)
FROM AWS_IDC_DATA_HIS
WHERE CRT_TM BETWEEN TO_DATE('2026-01-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
                 AND TO_DATE('2026-01-31 23:59:00', 'YYYY-MM-DD HH24:MI:SS')
  AND IDC_NM IN (
    'PNT4_TSV.ETC.ALERT.N2FOUPMISMATCHDEST',
    'PNT4_TSV.ETC.ALERT.CARRIERDUPLICATE',
    'PNT4_TSV.ETC.ALERT.TRANSACTIONTIMEISOVER',
    'PNT4_TSV.ETC.ALERT.DESTUNITNULL',
    'PNT4_TSV.ETC.ALERT.FIOCONNECTION',
    'PNT4_TSV.QUE.LOAD.AVGLOADTIME',
    'PNT4_TSV.QUE.LOAD.CURRENTLOADQCNT',
    'PNT4_TSV.QUE.LOAD.AVGLOADTIME1MIN',
    'PNT4_TSV.QUE.ALL.CURRENTQCREATED',
    'PNT4_TSV.QUE.ALL.CURRENTQCOMPLETED',
    'PNT4_TSV.QUE.ALL.CURRENTQCNT',
    'PNT4_TSV.INPOS.ALERT.104',
    'PNT4_TSV.INPOS.ALERT.90003',
    'PNT4_TSV.INPOS.ALERT.101',
    'PNT4_TSV.INPOS.ALERT.103',
    'PNT4_TSV.INPOS.ALERT.112',
    'PNT4_TSV.INPOS.ALERT.113',
    'PNT4_TSV.INPOS.ALERT.114',
    'PNT4_TSV.OHT.ALERT.OHTMCPALARMCNT',
    'PNT4_TSV.OHT.ALERT.PIOCOMMERROR',
    'PNT4_TSV.OHT.ALERT.OHTSTATUSERROR',
    'PNT4_TSV.OHT.ALERT.OHTLOADFAIL',
    'PNT4_TSV.OHT.ALERT.OHTDISCONNECTION',
    'PNT4_TSV.OHT.ALERT.OHTMCPALARM',
    'PNT4_TSV.OHT.ALERT.OHTCONNECTION',
    'PNT4_TSV.OHT.ALERT.OHTAUTO',
    'PNT4_TSV.OHT.ALERT.OHTPAUSED',
    'PNT4_TSV.OHT.ALERT.OHTHIDALARM',
    'PNT4_TSV.OHT.ALERT.OHTCANNOTEXECUTE',
    'PNT4_TSV.MCS.ALERT.DBQUERYHANG',
    'PNT4_TSV.MCS.ALERT.PROCESSDOWN',
    'PNT4_TSV.MCS.ALERT.PROCESSSHUTDOWNFAIL',
    'PNT4_TSV.MCS.ALERT.PROCESSUPFAIL',
    'PNT4_TSV.MCS.ALERT.PROCESSUPSTART',
    'PNT4_TSV.MCS.ALERT.PROCESSHANG',
    'PNT4_TSV.FIO.ALERT.FIOMCPALARM',
    'PNT4_TSV.FIO.ALERT.FIODISCONNECTION',
    'PNT4_TSV.STRATE.FOUP.STORAGESERVICECAPA',
    'PNT4_TSV.STRATE.FOUP.STORAGERATIO',
    'PNT4_TSV.STRATE.FOUP.STORAGECAPACITY',
    'PNT4_TSV.STRATE.FOUP.STORAGECOUNT',
    'PNT4_TSV.STRATE.MAGAZINE.STORAGESERVICECAPA',
    'PNT4_TSV.STRATE.MAGAZINE.STORAGERATIO',
    'PNT4_TSV.STRATE.MAGAZINE.STORAGECAPACITY',
    'PNT4_TSV.STRATE.MAGAZINE.STORAGECOUNT',
    'PNT4_TSV.STRATE.RINGCST.STORAGERATIO',
    'PNT4_TSV.STRATE.RINGCST.STORAGECAPACITY',
    'PNT4_TSV.STRATE.RINGCST.STORAGECOUNT',
    'PNT4_TSV.STRATE.RINGCST.STORAGESERVICECAPA',
    'PNT4_TSV.MCS.TSVMCSDB01.DISK_APP1',
    'PNT4_TSV.MCS.TSVMCSDB02.DISK_APP1',
    'PNT4_TSV.INV.ALERT.INVDISCONNECTION',
    'PNT4_TSV.INV.ALERT.INVMCPALARM',
    'PNT4_TSV.INV.ALERT.INVAUTO',
    'PNT4_TSV.INV.ALERT.INVCONNECTION',
    'PNT4_TSV.INV.ALERT.INVPAUSED',
    'PNT4_TSV.AZFS.ALERT.DOUBLESTORAGE',
    'PNT4_TSV.AZFS.ALERT.SOURCEEMPTY',
    'PNT4_TSV.STRATE.N2.N2STORAGERATIO',
    'PNT4_TSV.STRATE.N2.N2STORAGECAPACITY',
    'PNT4_TSV.STRATE.N2.N2STORAGECOUNT',
    'PNT4_TSV.STRATE.ALL.FABSTORAGERATIO',
    'PNT4_TSV.STRATE.ALL.FABSTORAGESERVICECAPA',
    'PNT4_TSV.STRATE.ALL.FABSTORAGECAPACITY',
    'PNT4_TSV.STRATE.ALL.FABSTORAGECOUNT',
    'PNT4_TSV.QUE.OHT.OHTUTIL',
    'PNT4_TSV.QUE.OHT.CURRENTOHTQCNT',
    'PNT4_TSV.OHT.ALL.CLUSTER',
    'PNT4_TSV.QUE.ABN.N2STOCKERDELAY',
    'PNT4_TSV.QUE.ABN.AOTRANSDELAYDET',
    'PNT4_TSV.QUE.ABN.AOTRANSDELAY',
    'PNT4_TSV.QUE.ABN.QUETIMEDELAY',
    'PNT4_TSV.QUE.ALERT.BRIDGESTKDISCONNECTED',
    'PNT4_TSV.QUE.ALERT.BRIDGECNVAUTO',
    'PNT4_TSV.QUE.ALERT.FABTRANSJOBDELAY',
    'PNT4_TSV.QUE.ALERT.BRIDGESTKCONNECTED',
    'PNT4_TSV.QUE.ALERT.BRIDGESTKAUTO',
    'PNT4_TSV.QUE.ALERT.BRIDGESTKPAUSED',
    'PNT4_TSV.QUE.ALERT.BRIDGECNVPAUSED',
    'PNT4_TSV.QUE.ALERT.BRIDGEAOPORTTRANSDELAY',
    'PNT4_TSV.QUE.ALERT.NOCLASSDEFFOUNDERROR',
    'PNT4_TSV.QUE.ALERT.BRIDGECNVDISCONNECTED',
    'PNT4_TSV.QUE.ALERT.BRIDGECNVCONNECTED',
    'PNT4_TSV.OHT.ALARM.CLUSTERSTATE',
    'PNT4_TSV.OHT.SERVER_P.STATE',
    'PNT4_TSV.OHT.SERVER_S.STATE',
    'PNT4_TSV.LFT.SENDFAB.TO_PNT4_WT_CURRENTQCNT',
    'PNT4_TSV.LFT.SENDFAB.TO_ICPKG_PNT4_1F_CURRENTQCNT',
    'PNT4_TSV.LFT.SENDFAB.TO_ICPKG_PNT4_5F_CURRENTQCNT',
    'PNT4_TSV.STRATE.NONN2.NONN2STORAGERATIO',
    'PNT4_TSV.STRATE.NONN2.NONN2STORAGECAPACITY',
    'PNT4_TSV.STRATE.NONN2.NONN2STORAGECOUNT',
    'PNT4_TSV.OHT.OHT_P.PROS_STATUS',
    'PNT4_TSV.OHT.OHT_P.ASSIGNEDWAITTOTAL',
    'PNT4_TSV.OHT.OHT_P.CLUSTER',
    'PNT4_TSV.OHT.OHT_P.DISK_USED',
    'PNT4_TSV.OHT.OHT_P.SERVICE_STATUS',
    'PNT4_TSV.OHT.OHT_S.PROS_STATUS',
    'PNT4_TSV.OHT.OHT_S.ASSIGNEDWAITTOTAL',
    'PNT4_TSV.OHT.OHT_S.SERVICE_STATUS',
    'PNT4_TSV.OHT.OHT_S.CLUSTER',
    'PNT4_TSV.OHT.OHT_S.DISK_USED',
    'PNT4_TSV.INV.PC.PROS_STATUS',
    'PNT4_TSV.INV.PC.DISK_USED',
    'PNT4_TSV.STK.ALERT.STKDISCONNECTION',
    'PNT4_TSV.STK.ALERT.STKMCPALARM',
    'PNT4_TSV.STK.ALERT.STKPAUSED',
    'PNT4_TSV.STK.ALERT.STKCONNECTION',
    'PNT4_TSV.STK.ALERT.STKAUTO',
    'PNT4_TSV.RTC.ALERT.RTCDISCONNECTION',
    'PNT4_TSV.STRATE.STK.NONN2FOUPSTORAGERATIO',
    'PNT4_TSV.STRATE.STK.NONN2FOUPSTORAGECOUNT',
    'PNT4_TSV.STRATE.STK.MAGAZINESTORAGERATIO',
    'PNT4_TSV.STRATE.STK.MAGAZINESTORAGECOUNT',
    'PNT4_TSV.STRATE.STK.MAGAZINESTORAGESERVICECAPA',
    'PNT4_TSV.STRATE.STK.MAGAZINESTORAGECAPACITY',
    'PNT4_TSV.STRATE.STK.NONN2FOUPSTORAGESERVICECAPA',
    'PNT4_TSV.STRATE.STK.NONN2FOUPSTORAGECAPACITY',
    'PNT4_TSV.STRATE.STB.NONN2FOUPSTORAGERATIO',
    'PNT4_TSV.STRATE.STB.NONN2FOUPSTORAGECOUNT',
    'PNT4_TSV.STRATE.STB.NONN2FOUPSTORAGESERVICECAPA',
    'PNT4_TSV.STRATE.STB.NONN2FOUPSTORAGECAPACITY',
    'PNT4_TSV.STRATE.STB.N2FOUPSTORAGERATIO',
    'PNT4_TSV.STRATE.STB.N2FOUPSTORAGECOUNT',
    'PNT4_TSV.STRATE.STB.N2FOUPSTORAGESERVICECAPA',
    'PNT4_TSV.STRATE.STB.N2FOUPSTORAGECAPACITY',
    'PNT4_TSV.STRATE.STB.MAGAZINESTORAGERATIO',
    'PNT4_TSV.STRATE.STB.MAGAZINESTORAGECOUNT',
    'PNT4_TSV.STRATE.STB.MAGAZINESTORAGESERVICECAPA',
    'PNT4_TSV.STRATE.STB.MAGAZINESTORAGECAPACITY',
    'PNT4_TSV.STRATE.STB.RINGCSTSTORAGERATIO',
    'PNT4_TSV.STRATE.STB.RINGCSTSTORAGECOUNT',
    'PNT4_TSV.STRATE.STB.RINGCSTSTORAGESERVICECAPA',
    'PNT4_TSV.STRATE.STB.RINGCSTSTORAGECAPACITY'
  )
GROUP BY CRT_TM
ORDER BY CRT_TM;

SPOOL OFF